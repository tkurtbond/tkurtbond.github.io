<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Random musings on books, code, and tabletop games.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Lacking Natural Simplicity | Lacking Natural Simplicity</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="alternate" type="application/atom+xml" title="Atom" href="feed.atom">
<link rel="canonical" href="https://tkurtbond.github.io/">
<link rel="next" href="index-91.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/2021/07/26/making-an-newer-version-of-groff-work-with-man-and-emacs-on-macos/" type="text/html">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<div class="blog-masthead">
    <div class="container">
<!-- This keeps the margins nice -->
        <nav class="blog-nav" role="navigation"><a href="#" class="blog-nav-item">Home</a>
            <a href="archive.html" class="blog-nav-item">Archives</a>
            <a href="categories/index.html" class="blog-nav-item">Tags &amp; Categories</a>
            <a href="rss.xml" class="blog-nav-item">RSS feed</a>
            <a href="feed.atom" class="blog-nav-item">Atom feed</a>

            

                
            
        </nav>
</div>
<!-- /.container -->
</div>
<!-- End of Menubar -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <div class="blog-header">
            <h1 class="blog-title">
                <a href="https://tkurtbond.github.io/">

                    <span id="blog-title">Lacking Natural Simplicity</span>
                </a>
            </h1>
            <p class="lead blog-description">Random musings on books, code, and tabletop games.</p>
            
        </div>
        <!--Body content-->
        <div class="row">
            <div class="col-sm-8 blog-main">
<div class="postindex">
    <article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/26/making-an-newer-version-of-groff-work-with-man-and-emacs-on-macos/" class="u-url">Making an newer version of groff work with man and emacs on macOS</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/26/making-an-newer-version-of-groff-work-with-man-and-emacs-on-macos/" rel="bookmark"><time class="published dt-published" datetime="2021-07-26T17:30:19-04:00" title="2021-07-26 17:30">2021-07-26 17:30</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/26/making-an-newer-version-of-groff-work-with-man-and-emacs-on-macos/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/26/making-an-newer-version-of-groff-work-with-man-and-emacs-on-macos.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>I'm posting this mostly to remind myself if I ever have to fiddle with
this again.</p>
<p>I use a version of <span class="app">groff</span> installed from <span class="app">git</span> because some
of my documents depend on fixes that are coming out in the next
release, 1.23.0.  I install it on my macOS machine in
<span class="file">/usr/local/sw/versions/groff/git</span>.  (The directory hierarchy
under <span class="file">/usr/local/sw/versions</span> is where I put programs that I
compile from scratch, to keep them separated from the programs that
come from the operating system and/or package managers.  I often have
more than one version of a program installed, therefore the
<span class="file">versions</span> component of the name.)</p>
<p>Because the <span class="command">groff</span> that is first in my path is the new one I
installed, and because <span class="app">man</span> on macOS knows to look for man pages
according to what your <code class="docutils literal">PATH</code> is, when I as <code class="docutils literal">man groff_ms</code> I get
the new man page for <code class="docutils literal">groff_ms</code>.  Yay!  Unfortunately, it gets
rendered with the old <span class="app">groff</span> that macOS supplies, version
1.19.2, which doesn't include the <code class="docutils literal">.SY</code> macro that current versions
of <span class="app">groff</span> supply in their <span class="app">man</span> macros, and which they
<em>use</em> in their man pages, so it renders wrong.  A typical example is
that when it renders <span class="man">groff_ms(7)</span> the <code class="docutils literal">groff <span class="pre">-ms</span></code> and
<code class="docutils literal">groff <span class="pre">-m</span> ms</code> are missing from the lines in the SYNOPSIS section.
Boo!</p>
<p>Luckily, <span class="app">man</span> takes a <code class="docutils literal"><span class="pre">-C</span></code> option that lets you specify an
alternate configuration file (on macOS the default one is in
<span class="file">/private/etc/man.conf</span>), so you can supply one that specifies
the absolute path to the newer <span class="app">groff</span> you are using.  So I added</p>
<pre class="code bash"><a name="rest_code_fcb14de0681f4f9b8cf423a143c4d9a2-1"></a><span class="nb">alias</span> <span class="nv">man</span><span class="o">=</span><span class="s1">'man -C ~/local/etc/man.conf'</span>
</pre>
<p>to the appropriate shell startup file.  And I can add</p>
<pre class="code emacs-lisp"><a name="rest_code_c5b076f511754ce3ba5f6b6b8f0538ef-1"></a><span class="p">(</span><span class="k">setq</span> <span class="nv">Man-switches</span> <span class="s">"-C ~/local/etc/man.conf"</span><span class="p">)</span>
</pre>
<p>to my <span class="app">emacs</span> configuration so it uses the right version of
<span class="app">groff</span> too.</p>
<p>But a modern <span class="app">groff</span> produces ANSI escapes for bold and
underline, rather than the older convention of over-striking via the
backspace character with the same character for bold or with the
underscore character for underlining.  My pager, <span class="app">less</span>, can deal
with that, but something in <span class="app">emacs</span> doesn't like that, leaving
the buffer with <span class="man">groff_ms(7)</span> with underlining on every line.<a class="footnote-reference brackets" href="posts/2021/07/26/making-an-newer-version-of-groff-work-with-man-and-emacs-on-macos/#manual" id="id1">1</a></p>
<p>Eventually I figured out that the old style over-striking via
backspaces worked just fine with emacs, so I added the <code class="docutils literal"><span class="pre">-P-c</span></code> option
to the invocation of <span class="app">groff</span> in the NROFF definition in my
modified <span class="file">man.conf</span> file.  That tells <span class="command">groff</span> to pass
the <code class="docutils literal"><span class="pre">-c</span></code> option to the <span class="command">grotty</span> output driver, which tells
it to use old-style backspace over-striking.</p>
<p>This seems overly complicated.</p>
<p>I suspect I'll need to do something different on the Linux boxes I
use.</p>
<dl class="footnote brackets">
<dt class="label" id="manual"><span class="brackets"><a class="fn-backref" href="posts/2021/07/26/making-an-newer-version-of-groff-work-with-man-and-emacs-on-macos/#id1">1</a></span></dt>
<dd>
<p>Oddly, if I direct <span class="app">man</span>'s output to a file, visit that file in
<span class="app">emacs</span>, and manually invoke the <code class="docutils literal"><span class="pre">Man-fontify-manpage</span></code> function
<span class="app">emacs</span> uses to fontify the man page, it <em>doesn't</em> end up
erroneously underlined.</p>
</dd>
</dl>
</div>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/groff/" rel="tag">groff</a></li>
            <li><a class="tag p-category" href="categories/macos/" rel="tag">macos</a></li>
            <li><a class="tag p-category" href="categories/troff/" rel="tag">troff</a></li>
        </ul></nav>
</div>
    </article><article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/25/bx-options-class-builder/" class="u-url">BX Options: Class Builder</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/25/bx-options-class-builder/" rel="bookmark"><time class="published dt-published" datetime="2021-07-25T15:17:09-04:00" title="2021-07-25 15:17">2021-07-25 15:17</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/25/bx-options-class-builder/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/25/bx-options-class-builder.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <span><a href="https://www.goodreads.com/book/show/58611940-bx-options" style="float: left; padding-right: 20px"><img border="0" alt="BX Options: Class Builder" src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1627016897l/58611940._SX98_.jpg"></a><a href="https://www.goodreads.com/book/show/58611940-bx-options">BX Options: Class Builder</a> by <a href="https://www.goodreads.com/author/show/21678093.Erin_D_Smale">Erin D. Smale</a><br>
My rating: <a href="https://www.goodreads.com/review/show/4130207047">5 of 5 stars</a><br><br>
If you are looking for a way to customize existing classes or create new classes for B/X D&amp;D style games, especially Old-School Essentials, this book is a wonderful resource. It breaks the original classes down into their fundamental parts and provides a simple system for building those parts into new or customized classes. It presents the breakdown for each of the original classes, then provides a list of class variants, customized versions of the original class, as well as sub-classes, heavily redesigned classes. For instance, for the Cleric, the class variants are: Cleric (Dead God), Cleric (God of Death), Cleric (God of Knowledge), Cleric (God of Life), Cleric (God of Nature), and Cleric (God of War); and the sub-classes are Crusader and Shaman. Class variants and sub-classes are presented for Cleric, Dwarf, Elf, Fighter, Halfling, Magic-User, and Thief. It also provides a version of Thief skills using the d6, other d6 skills that can be used in creating classes, some additional armour, weapons, and ammunition, an optional table for spell failure in appropriate circumstances (for example, when non-casters read a spell scroll), a table of special abilities gained by classes that have animal companions, differing depending on the animal in question, and options for characters to gain at high levels, beyond the limits of their level progression tables.<br><br>I'll definitely be using this in my next B/X-style game!
<br><br><a href="https://www.goodreads.com/review/list/13454227-t-kurt">View all my reviews at Goodreads</a></span>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/bx/" rel="tag">b/x</a></li>
            <li><a class="tag p-category" href="categories/bx-dd/" rel="tag">b/x d&amp;d</a></li>
            <li><a class="tag p-category" href="categories/old-school-essentials/" rel="tag">old school essentials</a></li>
            <li><a class="tag p-category" href="categories/ose/" rel="tag">ose</a></li>
            <li><a class="tag p-category" href="categories/rpg/" rel="tag">rpg</a></li>
        </ul></nav>
</div>
    </article><article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/23/i-wish-the-bx-and-odd-retro-clones-had-added-a-saving-throw-entry-for-spells/" class="u-url">I wish the B/X and OD&amp;D retro-clones had added a "Saving Throw" entry for spells</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/23/i-wish-the-bx-and-odd-retro-clones-had-added-a-saving-throw-entry-for-spells/" rel="bookmark"><time class="published dt-published" datetime="2021-07-23T04:08:53-04:00" title="2021-07-23 04:08">2021-07-23 04:08</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/23/i-wish-the-bx-and-odd-retro-clones-had-added-a-saving-throw-entry-for-spells/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/23/i-wish-the-bx-and-odd-retro-clones-had-added-a-saving-throw-entry-for-spells.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>One simple improvement on B/X D&amp;D and OD&amp;D that wouldn't have been a
change in the rules, just a change in presentation, that I've wished
that the B/X and OD&amp;D retro-clones had made was adding a “Saving
Throw” entry to their spell descriptions, like that of AD&amp;D.  As it
is, you have to read the spell description to figure out if a saving
throw is allowed and what it means.</p>
<p><cite>Basic Fantasy</cite>; <cite>Labyrinth Lord</cite> and <cite>Advanced Edition Companion</cite>;
<cite>Old-School Essentials</cite> <cite>Classic Fantasy</cite> and <cite>Advanced Fantasy</cite>;
<cite>Sword &amp; Wizardry Complete</cite>, <cite>Core</cite>, and <cite>Whitebox</cite>; and <cite>Delving
Deeper</cite>, all fail to do this.</p>
<p>I'm <strong>really</strong> surprised that <cite>Old-School Essentials</cite> didn't do this,
with all its other improvements to the presentation of B/X style
games.</p>
<p>Oh well.  Maybe OSE will add it in a later edition.</p>
<p><em>Last edited: 2021-07-25 13:23:05 EDT</em></p>
<!-- Local Variables:
time-stamp-format: "%Y-%02m-%02d %02H:%02M:%02S %Z"
time-stamp-start: "\\*Last edited:[ \t]+\\\\?"
time-stamp-end: "\\*\\\\?\n"
time-stamp-line-limit: -20
End: -->
</div>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/advanced-edition-companion/" rel="tag">advanced edition companion</a></li>
            <li><a class="tag p-category" href="categories/aec/" rel="tag">aec</a></li>
            <li><a class="tag p-category" href="categories/bx/" rel="tag">b/x</a></li>
            <li><a class="tag p-category" href="categories/bx-dd/" rel="tag">b/x d&amp;d</a></li>
            <li><a class="tag p-category" href="categories/basicexpert/" rel="tag">basic/expert</a></li>
            <li><a class="tag p-category" href="categories/dd/" rel="tag">d&amp;d</a></li>
            <li><a class="tag p-category" href="categories/delving-deeper/" rel="tag">delving deeper</a></li>
            <li><a class="tag p-category" href="categories/labyrinth-lord/" rel="tag">labyrinth lord</a></li>
            <li><a class="tag p-category" href="categories/ll/" rel="tag">ll</a></li>
            <li><a class="tag p-category" href="categories/ose/" rel="tag">ose</a></li>
            <li><a class="tag p-category" href="categories/ose-advanced/" rel="tag">ose advanced</a></li>
            <li><a class="tag p-category" href="categories/ose-classic/" rel="tag">ose classic</a></li>
            <li><a class="tag p-category" href="categories/retro-clone/" rel="tag">retro-clone</a></li>
            <li><a class="tag p-category" href="categories/rpg/" rel="tag">rpg</a></li>
            <li><a class="tag p-category" href="categories/swords-wizardry/" rel="tag">swords &amp; wizardry</a></li>
        </ul></nav>
</div>
    </article><article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/23/echoes-of-valor-ii-ed-by-karl-edward-wagner/" class="u-url">Echoes of Valor II, ed. by Karl Edward Wagner</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/23/echoes-of-valor-ii-ed-by-karl-edward-wagner/" rel="bookmark"><time class="published dt-published" datetime="2021-07-23T02:02:35-04:00" title="2021-07-23 02:02">2021-07-23 02:02</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/23/echoes-of-valor-ii-ed-by-karl-edward-wagner/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/23/echoes-of-valor-ii-ed-by-karl-edward-wagner.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<a href="https://www.goodreads.com/book/show/443775.Echoes_of_Valor_II" style="float: left; padding-right: 20px"><img border="0" alt="Echoes of Valor II" src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1360037886l/443775._SX98_.jpg"></a><a href="https://www.goodreads.com/book/show/443775.Echoes_of_Valor_II">Echoes of Valor II</a> by <a href="https://www.goodreads.com/author/show/88014.Karl_Edward_Wagner">Karl Edward Wagner</a><br>
My rating: <a href="https://www.goodreads.com/review/show/4130247877">5 of 5 stars</a><br><br>
Another excellent collection of heroic fantasy edited by Karl Edward Wagner. I <i>think</i> I had read all the fiction before, by Robert E. Howard, C. L. Moore, (with Henry Kuttner and Forest J. Ackerman as coauthors on different stories), Leigh Brackett with Ray Bradbury as coauthor, and Manly Wade Wellman, but I was glad to read them again. KEW's introductions are worth reading, as were the nonfiction giving the stories context.<br><br>Anyway, I greatly enjoyed this collection.
<br><br><a href="https://www.goodreads.com/review/list/13454227-t-kurt">View all my reviews at Goodreads</a><hr class="docutils">
<p>I had <em>not</em> known about C.L. Moore's disappearance from the science
fiction scene and her struggle with Alzheimer's disease and her
eventual coma and finally death on April 4th, 1987.  I don't remember
having read C.L. Moore at that time; I came to it much later, when I
was reading swords and sorcery and sword and planet fiction in the
2000s, rereading old favorites and reading stories I'd not read
before.  That's also when I read the Leigh Brackett and Ray Bradbury
story in this collection, though I'd read her John Eric Stark stories
and novels sometime before.  And the 2000s is also probably when I
first read Manly Wade Wellman's stories of Hok the Mighty.</p>
</div>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/fiction/" rel="tag">fiction</a></li>
            <li><a class="tag p-category" href="categories/goodreads/" rel="tag">goodreads</a></li>
        </ul></nav>
</div>
    </article><article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/23/echoes-of-valor-ed-by-karl-edward-wagner/" class="u-url">Echoes of Valor, ed. by Karl Edward Wagner</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/23/echoes-of-valor-ed-by-karl-edward-wagner/" rel="bookmark"><time class="published dt-published" datetime="2021-07-23T01:43:35-04:00" title="2021-07-23 01:43">2021-07-23 01:43</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/23/echoes-of-valor-ed-by-karl-edward-wagner/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/23/echoes-of-valor-ed-by-karl-edward-wagner.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <span><a href="https://www.goodreads.com/book/show/3285441-echoes-of-valor" style="float: left; padding-right: 20px"><img border="0" alt="Echoes of Valor" src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1360037638l/3285441._SX98_.jpg"></a><a href="https://www.goodreads.com/book/show/3285441-echoes-of-valor">Echoes of Valor</a> by <a href="https://www.goodreads.com/author/show/88014.Karl_Edward_Wagner">Karl Edward Wagner</a><br>
My rating: <a href="https://www.goodreads.com/review/show/4130228600">4 of 5 stars</a><br><br>
Excellent collection of what I've read Wagner prefered to call heroic fantasy, but which is often called sword &amp; sorcery. I had already read Howard's "The Black Stranger", first in its rewritten version ad a pirate story, "Swords of the Red Brotherhood", with Conan replaced with Howard's swashbuckling hero Black Vulmea, and later in its original form in the Del Rey trade paperback collection <i>The Conquering Sword of Conan</i>, but it was good to read it again. I was also familiar with Leiber's "Adept's Gambit", and enjoyed rereading it as well. Kuttner's "Wet Magic" was new to me, and I liked it, though not as well as the Howard and Leiber stories.
<br><br><a href="https://www.goodreads.com/review/list/13454227-t-kurt">View all my reviews at Goodreads</a></span>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/fiction/" rel="tag">fiction</a></li>
            <li><a class="tag p-category" href="categories/goodreads/" rel="tag">goodreads</a></li>
        </ul></nav>
</div>
    </article><article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/19/updated-my-post-on-slings-for-advanced-fighting-fantasy/" class="u-url">Updated my post on slings for Advanced Fighting Fantasy</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/19/updated-my-post-on-slings-for-advanced-fighting-fantasy/" rel="bookmark"><time class="published dt-published" datetime="2021-07-19T23:11:14-04:00" title="2021-07-19 23:11">2021-07-19 23:11</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/19/updated-my-post-on-slings-for-advanced-fighting-fantasy/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/19/updated-my-post-on-slings-for-advanced-fighting-fantasy.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>I updated my post on <a class="reference external" href="posts/2020/02/07/slings-in-rpgs-often-nerfed/#aff">slings</a> with information about Advanced Fighting
Fantasy.</p>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/advanced-fighting-fantasy/" rel="tag">advanced fighting fantasy</a></li>
            <li><a class="tag p-category" href="categories/aff-1e/" rel="tag">aff 1e</a></li>
            <li><a class="tag p-category" href="categories/aff-2e/" rel="tag">aff 2e</a></li>
            <li><a class="tag p-category" href="categories/nerfed/" rel="tag">nerfed</a></li>
            <li><a class="tag p-category" href="categories/rpg/" rel="tag">rpg</a></li>
            <li><a class="tag p-category" href="categories/slings/" rel="tag">slings</a></li>
        </ul></nav>
</div>
    </article><article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/17/simons-thoughts-on-running-a-mini-six-campaign-in-primeval-thule/" class="u-url">Simon's thoughts on running a Mini Six campaign in Primeval Thule</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/17/simons-thoughts-on-running-a-mini-six-campaign-in-primeval-thule/" rel="bookmark"><time class="published dt-published" datetime="2021-07-17T21:18:43-04:00" title="2021-07-17 21:18">2021-07-17 21:18</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/17/simons-thoughts-on-running-a-mini-six-campaign-in-primeval-thule/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/17/simons-thoughts-on-running-a-mini-six-campaign-in-primeval-thule.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>I just noticed that <a class="reference external" href="https://www.therpgsite.com/profile/?u=4020">S'mon</a> <a class="reference external" href="http://simonyrpgs.blogspot.com/2021/07/mini-six-primeval-thule.html">responded</a> on his <a class="reference external" href="http://simonyrpgs.blogspot.com/">blog</a> to my question as
to if he had ever written an retrospective on his Mini Six Primeval
Thule campaign.  Neat!  He played a 28 session campaign with 3–5
Character Points per session and he was happy with the results.  I
thought he had some interesting thoughts on the game.  Go read <a class="reference external" href="http://simonyrpgs.blogspot.com/2021/07/mini-six-primeval-thule.html">it</a>!</p>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/campaign/" rel="tag">campaign</a></li>
            <li><a class="tag p-category" href="categories/mini-six/" rel="tag">mini six</a></li>
            <li><a class="tag p-category" href="categories/primeval-thule/" rel="tag">primeval thule</a></li>
            <li><a class="tag p-category" href="categories/rpg/" rel="tag">rpg</a></li>
        </ul></nav>
</div>
    </article><article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/17/install-fontsh-the-simple-approach/" class="u-url">install-font.sh - The simple approach</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/17/install-fontsh-the-simple-approach/" rel="bookmark"><time class="published dt-published" datetime="2021-07-17T15:36:43-04:00" title="2021-07-17 15:36">2021-07-17 15:36</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/17/install-fontsh-the-simple-approach/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/17/install-fontsh-the-simple-approach.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>The simple approach to using <a class="reference external" href="https://www.schaffter.ca/mom/mom-05.html#install-font">install-font.sh</a> to install fonts for
<span class="app">groff</span> probably works for almost everybody.</p>
<p>First, make sure that <a class="reference external" href="https://fontforge.org/">FontForge</a> is installed; it is free and open
source and available for installation in most distributions.  Second,
call the <span class="command">install-font.sh</span> command with one argument, the
font file, and answer the prompts.</p>
<p>This will install the fonts for <span class="app">groff</span>'s use in the appropriate
directories under <span class="file">/usr/local/share/groff</span>, creating the
directories if necessary.  If you need to install into
<span class="file">/usr/share/groff</span> you should specify the <code class="docutils literal"><span class="pre">-s</span></code> option to the
script.  For instance:</p>
<pre class="code text"><a name="rest_code_fcd20ada2a444b6b9ef8a78217b4c9dc-1"></a>$ install-font.sh Lora-Regular.ttf
</pre>
<p>will install the Regular variant of the font, leading you through four
prompts, for three of which you just need to take the default.</p>
<p>The only prompt where you need to do something other than accept the
default is the prompt for the style.  For <span class="file">Lora-Regular</span> you'd
specify <code class="docutils literal">+R</code>.  For italic, bold, and bold italic, the other
traditional <span class="app">troff</span> font styles, you'd specify <code class="docutils literal">+I</code>, <code class="docutils literal">+B</code>,
and <code class="docutils literal">+BI</code>.  The prompt lists them all for you to choose from.</p>
<p>Here's a walk-through of installing the <a class="reference external" href="https://fonts.google.com/specimen/Lora">Lora</a> font, assuming that
<span class="command">install-font.sh</span> is in your path.  (If your
<span class="file">/usr/local/share/groff</span> directory isn't writable for your
normal user, you should prefix the command with <code class="docutils literal">sudo</code>.)</p>
<p><span class="command">install-font.sh</span> does produce a lot of output, but the
colorizing helps pick out the important things.  I've put the
responses the user types in bold and red, and added “&lt;RETURN&gt;”
where the user presses the RETURN key to accept defaults.</p>
<pre>
$ <span style="color:red;"><b>install-font.sh Lora-Regular.ttf</b></span>
/usr/local/share/groff/site-font not found; creating.
/usr/local/share/groff/site-font/devps not found; creating.
/usr/local/share/groff/site-font/devpdf not found; creating.
Processing <span style="color:teal;">Lora-Regular.ttf</span>...
Running fontforge...
Copyright (c) 2000-2020. See AUTHORS for Contributors.
 License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
 with many parts BSD &lt;http://fontforge.org/license.html&gt;. Please read LICENSE.
 Version: 20201107
 Based on sources from 2020-11-16 19:11 UTC-D.
The following table(s) in the font have been ignored by FontForge
  Ignoring 'STAT' style attributes table
Done.
Family name (default = Lora): <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
  =&gt;<span style="color:teal;">Lora-Regular</span> (Lora-Regular.ttf) assigned to family '<span style="color:olive;">Lora</span>'.
Enter +STYLE (eg +R, +I, +B, +BI), or a unique groff name for <span style="color:teal;">Lora-Regular</span>.
Leave blank to set name to '<span style="color:teal;">Lora-Regular</span>': <span style="color:red;"><b>+R</b></span>
  =&gt;<span style="color:teal;">Lora-Regular</span> assigned groff fontname '<span style="color:olive;">LoraR</span>'.
Creating <span style="color:olive;">LoraR</span>...
afmtodit: both uni00B5 and uni03BC map to mc at /Users/tkb/sw/versions/groff/git/bin/afmtodit line 6441.
Done.
Installing <span style="color:olive;">LoraR</span> in /usr/local/share/groff/site-font/devps/... Done.
Make <span style="color:olive;">LoraR</span> available to gropdf? (y/n; default = y) <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
Checking for gropdf executable and devpdf directory... gropdf found.
Installing <span style="color:olive;">LoraR</span> in /usr/local/share/groff/site-font/devpdf/... Done.
Copy <span style="color:teal;">Lora-Regular.ttf</span> to /usr/local/share/fonts/truetype/Lora/
  (y/n; default = n) <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
Install <span style="color:teal;">Lora-Regular.ttf</span> manually to make it available system-wide.
$ <span style="color:red;"><b>install-font.sh Lora-Italic.ttf</b></span>
Processing <span style="color:teal;">Lora-Italic.ttf</span>...
Running fontforge...
Copyright (c) 2000-2020. See AUTHORS for Contributors.
 License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
 with many parts BSD &lt;http://fontforge.org/license.html&gt;. Please read LICENSE.
 Version: 20201107
 Based on sources from 2020-11-16 19:11 UTC-D.
The following table(s) in the font have been ignored by FontForge
  Ignoring 'STAT' style attributes table
Done.
Family name (default = Lora): <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
  =&gt;<span style="color:teal;">Lora-Italic</span> (Lora-Italic.ttf) assigned to family '<span style="color:olive;">Lora</span>'.
Enter +STYLE (eg +R, +I, +B, +BI), or a unique groff name for <span style="color:teal;">Lora-Italic</span>.
Leave blank to set name to '<span style="color:teal;">Lora-Italic</span>': <span style="color:red;"><b>+I</b></span>
  =&gt;<span style="color:teal;">Lora-Italic</span> assigned groff fontname '<span style="color:olive;">LoraI</span>'.
Creating <span style="color:olive;">LoraI</span>...
afmtodit: both uni00B5 and uni03BC map to mc at /Users/tkb/sw/versions/groff/git/bin/afmtodit line 6441.
Done.
Installing <span style="color:olive;">LoraI</span> in /usr/local/share/groff/site-font/devps/... Done.
Make <span style="color:olive;">LoraI</span> available to gropdf? (y/n; default = y) <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
Checking for gropdf executable and devpdf directory... gropdf found.
Installing <span style="color:olive;">LoraI</span> in /usr/local/share/groff/site-font/devpdf/... Done.
Copy <span style="color:teal;">Lora-Italic.ttf</span> to /usr/local/share/fonts/truetype/Lora/
  (y/n; default = n) <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
Install <span style="color:teal;">Lora-Italic.ttf</span> manually to make it available system-wide.
$ <span style="color:red;"><b>install-font.sh Lora-Bold.ttf</b></span>
Processing <span style="color:teal;">Lora-Bold.ttf</span>...
Running fontforge...
Copyright (c) 2000-2020. See AUTHORS for Contributors.
 License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
 with many parts BSD &lt;http://fontforge.org/license.html&gt;. Please read LICENSE.
 Version: 20201107
 Based on sources from 2020-11-16 19:11 UTC-D.
The following table(s) in the font have been ignored by FontForge
  Ignoring 'STAT' style attributes table
Glyph bounding box data exceeds font bounding box data for GID 4
  Subsequent errors will not be reported.
In GID 769 the advance width (1316) is greater than the stated maximum (1291)
  Subsequent errors will not be reported.
Done.
Family name (default = Lora): <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
  =&gt;<span style="color:teal;">Lora-Bold</span> (Lora-Bold.ttf) assigned to family '<span style="color:olive;">Lora</span>'.
Enter +STYLE (eg +R, +I, +B, +BI), or a unique groff name for <span style="color:teal;">Lora-Bold</span>.
Leave blank to set name to '<span style="color:teal;">Lora-Bold</span>': <span style="color:red;"><b>+B</b></span>
  =&gt;<span style="color:teal;">Lora-Bold</span> assigned groff fontname '<span style="color:olive;">LoraB</span>'.
Creating <span style="color:olive;">LoraB</span>...
afmtodit: both uni00B5 and uni03BC map to mc at /Users/tkb/sw/versions/groff/git/bin/afmtodit line 6441.
Done.
Installing <span style="color:olive;">LoraB</span> in /usr/local/share/groff/site-font/devps/... Done.
Make <span style="color:olive;">LoraB</span> available to gropdf? (y/n; default = y) <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
Checking for gropdf executable and devpdf directory... gropdf found.
Installing <span style="color:olive;">LoraB</span> in /usr/local/share/groff/site-font/devpdf/... Done.
Copy <span style="color:teal;">Lora-Bold.ttf</span> to /usr/local/share/fonts/truetype/Lora/
  (y/n; default = n) <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
Install <span style="color:teal;">Lora-Bold.ttf</span> manually to make it available system-wide.
$ install-font.sh Lora-BoldItalic.ttf
Processing <span style="color:teal;">Lora-BoldItalic.ttf</span>...
Running fontforge...
Copyright (c) 2000-2020. See AUTHORS for Contributors.
 License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
 with many parts BSD &lt;http://fontforge.org/license.html&gt;. Please read LICENSE.
 Version: 20201107
 Based on sources from 2020-11-16 19:11 UTC-D.
The following table(s) in the font have been ignored by FontForge
  Ignoring 'STAT' style attributes table
Glyph bounding box data exceeds font bounding box data for GID 4
  Subsequent errors will not be reported.
In GID 776 the advance width (1297) is greater than the stated maximum (1273)
  Subsequent errors will not be reported.
Done.
Family name (default = Lora): <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
  =&gt;<span style="color:teal;">Lora-BoldItalic</span> (Lora-BoldItalic.ttf) assigned to family '<span style="color:olive;">Lora</span>'.
Enter +STYLE (eg +R, +I, +B, +BI), or a unique groff name for <span style="color:teal;">Lora-BoldItalic</span>.
Leave blank to set name to '<span style="color:teal;">Lora-BoldItalic</span>': <span style="color:red;"><b>+BI</b></span>
  =&gt;<span style="color:teal;">Lora-BoldItalic</span> assigned groff fontname '<span style="color:olive;">LoraBI</span>'.
Creating <span style="color:olive;">LoraBI</span>...
afmtodit: both uni00B5 and uni03BC map to mc at /Users/tkb/sw/versions/groff/git/bin/afmtodit line 6441.
Done.
Installing <span style="color:olive;">LoraBI</span> in /usr/local/share/groff/site-font/devps/... Done.
Make <span style="color:olive;">LoraBI</span> available to gropdf? (y/n; default = y) <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
Checking for gropdf executable and devpdf directory... gropdf found.
Installing <span style="color:olive;">LoraBI</span> in /usr/local/share/groff/site-font/devpdf/... Done.
Copy <span style="color:teal;">Lora-BoldItalic.ttf</span> to /usr/local/share/fonts/truetype/Lora/
  (y/n; default = n) <span style="color:red;"><b>&lt;RETURN&gt;</b></span>
Install <span style="color:teal;">Lora-BoldItalic.ttf</span> manually to make it available system-wide.
</pre>
<p><em>Last edited: 2021-07-20 12:40:30 EDT</em></p>
<!-- Local Variables:
time-stamp-format: "%Y-%02m-%02d %02H:%02M:%02S %Z"
time-stamp-start: "\\*Last edited:[ \t]+\\\\?"
time-stamp-end: "\\*\\\\?\n"
time-stamp-line-limit: -20
End: -->
</div>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/fonts/" rel="tag">fonts</a></li>
            <li><a class="tag p-category" href="categories/groff/" rel="tag">groff</a></li>
            <li><a class="tag p-category" href="categories/install-fontsh/" rel="tag">install-font.sh</a></li>
            <li><a class="tag p-category" href="categories/troff/" rel="tag">troff</a></li>
        </ul></nav>
</div>
    </article><article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/17/groff-and-install-fontsh-and-installing-fonts-for-use-in-groff/" class="u-url">groff and install-font.sh and installing fonts for use in groff</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/17/groff-and-install-fontsh-and-installing-fonts-for-use-in-groff/" rel="bookmark"><time class="published dt-published" datetime="2021-07-17T00:16:49-04:00" title="2021-07-17 00:16">2021-07-17 00:16</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/17/groff-and-install-fontsh-and-installing-fonts-for-use-in-groff/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/17/groff-and-install-fontsh-and-installing-fonts-for-use-in-groff.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This was originally a <a class="reference external" href="https://lists.gnu.org/archive/html/groff/2021-07/msg00089.html">post</a> to the <a class="reference external" href="https://www.gnu.org/software/groff/">groff</a> <a class="reference external" href="https://lists.gnu.org/mailman/listinfo/groff/">mailing list</a>.  It has
been slightly modified.</p>
</div>
<p>Currently <span class="command">install-font.sh</span> is not part of <span class="app">groff</span>.
We've had some discussion on the list <a class="reference external" href="https://lists.gnu.org/archive/html/groff/2021-07/msg00061.html">recently</a> and in the past about
integrating it into the <span class="app">groff</span> distribution, and in response to
recent <a class="reference external" href="https://lists.gnu.org/archive/html/groff/2021-07/msg00054.html">discussion</a> there is a new bug, <a class="reference external" href="https://savannah.gnu.org/bugs/index.php?60930">#60930</a>, requesting
integrating it, including documentation, etc.</p>
<p>In the meantime, if you want to install fonts in OpenType or TrueType
formats for use with <code class="docutils literal">devps</code> and <code class="docutils literal">devpdf</code>,
<span class="command">install-font.sh</span> greatly simplifies the process.</p>
<p>The <span class="command">install-font.sh</span> script was written by Peter Schaffter, the author
of the <a class="reference external" href="https://www.schaffter.ca/mom/mom-01.html">mom macros</a> for
<span class="app">groff</span>, and is distributed on mom's <a class="reference external" href="https://www.schaffter.ca/mom/mom-05.html#install-font">download page</a> and can be
downloaded <a class="reference external" href="https://www.schaffter.ca/mom/bin/install-font.sh">directly</a>.  It has a <code class="docutils literal"><span class="pre">-H</span></code>
option that prints the documentation for it.</p>
<p><a class="reference external" href="https://fontforge.org/">Fontforge</a> is a free and open source font
editor.  It can run scripts to manipulate fonts and convert between
font formats.  (I only use <span class="app">fontforge</span> to install fonts with
<span class="command">install-font.sh</span>, so I use a version that is command line
only, but the normal build has a GUI for interactively building
fonts.)  The <span class="command">install-font.sh</span> script uses <span class="app">Fontforge</span> to convert
OpenType and TrueType fonts to PostScript Type42 (<span class="file">.t42</span>) and Type1
(<span class="file">.pfa</span>), from which a <span class="app">groff</span> font is generated by the
<span class="app">groff</span> utility <span class="command">afmtodit</span>.  Then the necessary files are moved to
<span class="file">site-font/devps</span> and registered in its download file for use by <span class="command">grops</span>.
Optionally the same can be done for <span class="file">site-font/devpdf</span> for the use of
<span class="file">gropdf</span>.  Then the fonts are available for use by <code class="docutils literal">groff
<span class="pre">-Tps</span></code> and <code class="docutils literal">groff <span class="pre">-Tpdf</span></code>.</p>
<p>So, suppose you wanted to use <a class="reference external" href="https://fonts.google.com/specimen/Cormorant+Garamond">Cormorant Garamond</a>, a free
font.  You could download the Regular, Italic, Bold, and Bold Italic
variants of the font, since <span class="app">groff</span> tends to expect there to be
R, I, B, and BI variants of the fonts it uses, though that is not
mandatory.  This would give you the files
<span class="file">CormorantGaramond-Regular.ttf</span>,
<span class="file">CormorantGaramond-Italic.ttf</span>,
<span class="file">CormorantGaramond-Bold.ttf</span>, and
<span class="file">CormorantGaramond-BoldItalic.ttf</span>.  You would then use
<span class="command">install-font.sh</span> to convert them and install the resulting
files into proper places under <span class="app">groff</span>'s site-font directory.</p>
<p>So, for instance, you'd cd to the directory that holds the <span class="file">.ttf</span> files
you downloaded.  Then, to install the Regular variant of Cormorant
Garamond you'd run the command</p>
<pre class="code bash"><a name="rest_code_2fd3a75bdcdc439eb9f8ee4929a83a00-1"></a><span class="k">$(</span>IFDIR<span class="k">)</span>/install-font.sh -n -P <span class="s2">"</span><span class="nv">$DEST</span><span class="s2">"</span> -d -F CormorantGaramond -f +R CormorantGaramond-Regular.ttf
</pre>
<p>where <code class="docutils literal">IFDIR</code> is an environment variable indicating the directory
where <span class="command">install-font.sh</span> is located and <code class="docutils literal">DEST</code> is an
environment variable indicating the directory that contains
<span class="app">groff</span>'s <span class="file">site-font</span> directory (not the actual
<span class="file">site-font</span> directory itself).  The <code class="docutils literal"><span class="pre">-n</span></code> option means don't
try to copy the TrueType file to where the system font files are
located.  The <code class="docutils literal"><span class="pre">-P</span></code> option takes as its argument the directory that
contains the <span class="app">groff</span>'s site-font directory.  Usually this is some
place like <span class="file">/usr/share/groff</span> or <span class="file">/usr/local/share/groff</span>,
but not all distributions create the <span class="file">site-font</span> directory.  If
you don't specify <code class="docutils literal"><span class="pre">-P</span></code> <span class="command">install-font.sh</span> will guess the
location.  (If the <span class="file">site-font</span> directory doesn't exist, or you
don't have write access to it I think you can use the environment
variable <code class="docutils literal">GROFF_FONT_PATH</code> to tell <span class="app">groff</span> where to find it,
but I've never used that and don't know the specifics.  I often build
<span class="app">groff</span> from git and install it someplace my normal user has
write access to, so I haven't had to worry about it.)  The <code class="docutils literal"><span class="pre">-d</span></code>
option says to make the font available to <span class="command">gropdf</span>.  The
<code class="docutils literal"><span class="pre">-F</span></code> option takes an argument that specifies the font family name to
use.  This is the name that you would use with the <code class="docutils literal">.fam</code> request or
the <code class="docutils literal"><span class="pre">-f</span></code> option to <span class="command">groff</span> to let it know you want to use
this font family.  The <code class="docutils literal"><span class="pre">-f</span></code> option takes an argument that specifies
the font style to use, <code class="docutils literal">+R</code>, <code class="docutils literal">+I</code>, <code class="docutils literal">+B</code>, or <code class="docutils literal">+BI</code>.  (The
<code class="docutils literal"><span class="pre">-f</span></code> option can instead take a name, but I don't use that form and
can't explain the distinctions.)  The style (<code class="docutils literal">R</code>, <code class="docutils literal">I</code>, <code class="docutils literal">B</code>, or
<code class="docutils literal">BI</code>) is appended to the font family name specified with <code class="docutils literal"><span class="pre">-F</span></code> to
produce the name of the <span class="app">groff</span> font, and consequently the name
of the <span class="app">groff</span> font file that is written to the <code class="docutils literal">devps</code> and
<code class="docutils literal">devpdf</code> directories under <code class="docutils literal"><span class="pre">site-font</span></code>.  So, in this example, the
name of the <span class="app">groff</span> font and the <span class="app">groff</span> font file would be
<span class="file">CormorantGaramondR</span>.  The last argument to the script is the
name of the Truetype or OpenType file you are converting.</p>
<p>To complete the example, here are the commands to install the Italic,
Bold, and Bold Italic variants of Cormorant Garamond:</p>
<pre class="code bash"><a name="rest_code_19c244ff68784702b43727a817f61e6f-1"></a><span class="k">$(</span>IFDIR<span class="k">)</span>/install-font.sh -n -P <span class="s2">"</span><span class="nv">$DEST</span><span class="s2">"</span> -d -F CormorantGaramond -f +I CormorantGaramond-Italic.ttf
<a name="rest_code_19c244ff68784702b43727a817f61e6f-2"></a><span class="k">$(</span>IFDIR<span class="k">)</span>/install-font.sh -n -P <span class="s2">"</span><span class="nv">$DEST</span><span class="s2">"</span> -d -F CormorantGaramond -f +B CormorantGaramond-Bold.ttf
<a name="rest_code_19c244ff68784702b43727a817f61e6f-3"></a><span class="k">$(</span>IFDIR<span class="k">)</span>/install-font.sh -n -P <span class="s2">"</span><span class="nv">$DEST</span><span class="s2">"</span> -d -F CormorantGaramond -f +BI CormorantGaramond-BoldItalic.
</pre>
<p>As I said in an earlier email to the list, I tend to put all four
commands into a script so I can run them again if something goes wrong
or when I need to install them on a new machine or in a new
installation of <span class="app">groff</span>.  In the case of Cormorant Garamond I named the
file <span class="file">install-cormorant-garamond.sh</span>.</p>
<p><strong>Later:</strong> Peter Schaffter <a class="reference external" href="https://lists.gnu.org/archive/html/groff/2021-07/msg00090.html">pointed out</a> that the <em>simple</em> use of
<span class="command">install-font.sh</span> is:</p>
<pre class="code bash"><a name="rest_code_26555d406f4042ad874f33fe54da22b9-1"></a>sudo install-font.sh fontfile
</pre>
<p>and then answer the questions the script asks.  He also pointed out
that it creates the <span class="file">site-font</span> directory and necessary
subdirectories if needed in, and here I quote: “the only two locations
it's ever likely to be”.  Looking at <span class="command">install-font.sh</span> reveal
those locations are <span class="file">/usr/local/share/groff</span> and
<span class="file">/usr/share/groff</span>, defaulting to
<span class="file">/usr/local/share/groff</span>; to get it to use
<span class="file">/usr/share/groff</span> you specify the <code class="docutils literal"><span class="pre">-s</span></code> option.</p>
<p>For a walk-through of the simple use see the <a class="reference external" href="posts/2021/07/17/install-fontsh-the-simple-approach/">follow-up</a>.</p>
<p><em>Last edited: 2021-07-15 17:46:40 EDT</em></p>
<!-- Local Variables:
time-stamp-format: "%Y-%02m-%02d %02H:%02M:%02S %Z"
time-stamp-start: "\\*Last edited:[ \t]+\\\\?"
time-stamp-end: "\\*\\\\?\n"
time-stamp-line-limit: -20
End: -->
</div>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/fonts/" rel="tag">fonts</a></li>
            <li><a class="tag p-category" href="categories/groff/" rel="tag">groff</a></li>
            <li><a class="tag p-category" href="categories/install-fontsh/" rel="tag">install-font.sh</a></li>
            <li><a class="tag p-category" href="categories/mom/" rel="tag">mom</a></li>
            <li><a class="tag p-category" href="categories/troff/" rel="tag">troff</a></li>
        </ul></nav>
</div>
    </article><article class="blog-post h-entry post-text"><header><h2 class="p-name entry-title blog-post-title"><a href="posts/2021/07/16/sorting-words-separated-by-commas/" class="u-url">Sorting words separated by commas</a></h2>
        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="posts/2021/07/16/sorting-words-separated-by-commas/" rel="bookmark"><time class="published dt-published" datetime="2021-07-16T13:05:09-04:00" title="2021-07-16 13:05">2021-07-16 13:05</time></a></p>
                <p class="commentline">            <a href="posts/2021/07/16/sorting-words-separated-by-commas/#disqus_thread" data-disqus-identifier="cache/posts/2021/07/16/sorting-words-separated-by-commas.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>I often have lists of "words", separated by commas, possibly on
multiple lines, like this example from a <span class="file">Makefile</span>:</p>
<pre class="code makefile"><a name="rest_code_e64e051df37d48cb8b4c48d2ef9b5117-1"></a><span class="c">#    bookman, schoolbook, palatino, times,</span>
<a name="rest_code_e64e051df37d48cb8b4c48d2ef9b5117-2"></a><span class="c">#    helvetica, helvetica-narrow, optima, cormorant-garamond,</span>
<a name="rest_code_e64e051df37d48cb8b4c48d2ef9b5117-3"></a><span class="c">#    or ebgaramond.</span>
</pre>
<p>I find these lists are always getting out of order, or they end up
with some short lines and some long lines.  I want to be able to
reformat them automatically, like this:</p>
<pre class="code makefile"><a name="rest_code_8c1788b67e8e4629af1455006ee71da3-1"></a><span class="c">#    bookman, cormorant-garamond, ebgaramond, helvetica, helvetica-narrow,</span>
<a name="rest_code_8c1788b67e8e4629af1455006ee71da3-2"></a><span class="c">#    optima, palatino, schoolbook, or times.</span>
</pre>
<p>So, I wrote three scripts to deal with them,
<span class="command">sort-with-commas</span>, <span class="command">strip-leading-hash</span> to get rid
of the leading hashes and spaces, and <span class="command">prefix</span> to put the
leading hashes and spaces back.</p>
<p>Now, above I said "words", because really it's anything separated by
commas, so the "words" can contain space, etc.</p>
<p>Also, notice that the period after "ebgaramond" and the "or" before
"ebgaramond"` in the original list disappear, and an "or " appears
before the new end of the list, "times", and a period follows it.  And
you can have have the same situation with "and".  So, the <code class="docutils literal"><span class="pre">-p</span></code>
option to <span class="command">sort-with-commas</span> adds a period after the last
word, the <code class="docutils literal"><span class="pre">-a</span></code> option adds and "and " before the last word, and the
<code class="docutils literal"><span class="pre">-o</span></code> option adds an "or " before the last word.  If you are sorting
only part of a list, you want to have a comma after the last "word",
so there is the option <code class="docutils literal"><span class="pre">-f</span></code> for that.  And to remove the the period
from the original list, so it doesn't end up in the middle of the new
list, or to remove "and " or "or ", there is the <code class="docutils literal"><span class="pre">-r</span></code> option.</p>
<p>The default is to return the sorted list as one long line, but you can
easily reformat it to multiple lines by running it through the Unix
command <span class="command">fmt</span>.</p>
<p>Although in this case the list is prefixed with a "#" and some spaces
because it comes from a comment in a Makefile, you have to remove
those to sort the list.  I wrote the script
<span class="command">strip-leading-hash</span> to do that, too, rather than having to
remember the <span class="command">sed</span> command to so that all the time.</p>
<p>So, to sort the original list I'd run the command</p>
<pre class="code bash"><a name="rest_code_5c4723a023cd4b6aa4262ff162dcc5bd-1"></a>strip-leading-hash <span class="p">|</span> sort-with-commas -r -p -o <span class="p">|</span> fmt <span class="p">|</span> prefix <span class="s2">"#    "</span>
</pre>
<p>which means “strip the leading hashes and spaces, remove the trailing
period and the "and " or "or ", add a final period after the last word,
add an "or " before the final word, reformat as a paragraph, and
prefix the lines with the hash and spaces.”</p>
<p>When I use this I'm usually in <span class="app">emacs</span> and using <span class="key">M-|</span> to
run it on the region (the currently selected text), often with the
<span class="key">C-u</span> to replace the region with results.</p>
<p>Here's the main script, <span class="file">sort-with-commas</span>:</p>
<p><a class="reference external" href="listings/sort-with-commas.html">sort-with-commas</a>  <a class="reference external" href="listings/sort-with-commas">(Source)</a></p>
<pre class="code bash"><a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-1"></a><span class="ch">#! /usr/bin/env bash</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-2"></a><span class="c1">###############################################################################</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-3"></a><span class="c1"># Sort a list of words that are seperated by commas, optionally followed by</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-4"></a><span class="c1"># a newline into a single line seperated by commas followed by spaces.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-5"></a><span class="c1">#</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-6"></a><span class="c1"># For example: it translates (ignore the "# +" at the beginning of lines)</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-7"></a><span class="c1">#    bookman, schoolbook,palatino,</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-8"></a><span class="c1">#    times, helvetica, helvetica-narrow,</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-9"></a><span class="c1"># to</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-10"></a><span class="c1">#    bookman, helvetica, helvetica-narrow, palatino, schoolbook, times</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-11"></a><span class="c1">###############################################################################</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-12"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-13"></a><span class="nv">AND_OPT</span><span class="o">=</span>off                     <span class="c1"># Insert "and " before last word.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-14"></a><span class="nv">FINAL_OPT</span><span class="o">=</span>off                   <span class="c1"># Leave "," after last word.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-15"></a><span class="nv">OR_OPT</span><span class="o">=</span>off                      <span class="c1"># Insert "or " before last word.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-16"></a><span class="nv">PERIOD_OPT</span><span class="o">=</span>off                  <span class="c1"># Insert a final period after last word.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-17"></a><span class="nv">REMOVE_AND_OR_PERIOD_OPT</span><span class="o">=</span>off
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-18"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-19"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-20"></a><span class="nb">let</span> <span class="nv">errors</span><span class="o">=</span><span class="m">0</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-21"></a><span class="k">while</span> <span class="nb">getopts</span> <span class="s2">"?afhopr"</span> opt
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-22"></a><span class="k">do</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-23"></a>    <span class="k">case</span> <span class="s2">"</span><span class="nv">$opt</span><span class="s2">"</span> in
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-24"></a>        <span class="o">(</span><span class="se">\?</span><span class="p">|</span>h<span class="o">)</span> <span class="nb">let</span> errors++ <span class="p">;;</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-25"></a>        <span class="o">(</span>a<span class="o">)</span> <span class="nv">AND_OPT</span><span class="o">=</span>on <span class="p">;;</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-26"></a>        <span class="o">(</span>f<span class="o">)</span> <span class="nv">FINAL_OPT</span><span class="o">=</span>on <span class="p">;;</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-27"></a>        <span class="o">(</span>o<span class="o">)</span> <span class="nv">OR_OPT</span><span class="o">=</span>on <span class="p">;;</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-28"></a>        <span class="o">(</span>p<span class="o">)</span> <span class="nv">PERIOD_OPT</span><span class="o">=</span>on <span class="p">;;</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-29"></a>        <span class="o">(</span>r<span class="o">)</span> <span class="nv">REMOVE_AND_OR_PERIOD_OPT</span><span class="o">=</span>on <span class="p">;;</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-30"></a>    <span class="k">esac</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-31"></a><span class="k">done</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-32"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-33"></a><span class="nb">shift</span> <span class="k">$((</span>OPTIND-1<span class="k">))</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-34"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-35"></a><span class="o">[[</span> <span class="nv">$#</span> &gt; <span class="m">0</span> <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="nv">$errors</span> &gt; <span class="m">0</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-36"></a>    cat <span class="s">&lt;&lt;EOF</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-37"></a><span class="s">usage: sort-with-commas [OPTION]</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-38"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-39"></a><span class="s">This reads its standard input and sorts a line or multiple lines with</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-40"></a><span class="s">"words" separated by commas, then reassembles the line, words</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-41"></a><span class="s">separated by a comma and s space, optionally leaving a final comma</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-42"></a><span class="s">after the last word, or a period, and optionally putting "and " or "or</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-43"></a><span class="s">" before the last word.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-44"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-45"></a><span class="s">Options</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-46"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-47"></a><span class="s">-? -h   This message.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-48"></a><span class="s">-a      Insert "and " before last word.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-49"></a><span class="s">-f      Leave final comma after last word.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-50"></a><span class="s">-o      Insert "or " before last word.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-51"></a><span class="s">-p      Insert a period after the last word.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-52"></a><span class="s">-r      Remove "and " or "or " that occur at the beginning of a "word" in the</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-53"></a><span class="s">        original list.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-54"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-55"></a><span class="s">Note that combining -a and -o, or -f and -p do what you say, but the results</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-56"></a><span class="s">are silly.</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-57"></a><span class="s">EOF</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-58"></a>    <span class="nb">exit</span> <span class="m">1</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-59"></a><span class="o">}</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-60"></a>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-61"></a>tr <span class="s1">','</span> <span class="s1">'\n'</span> <span class="p">|</span> sed -E -e <span class="s1">'s/^[ \t]+//'</span> -e <span class="s1">'/^$/d'</span> <span class="p">|</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-62"></a>    <span class="o">([[</span> <span class="s2">"</span><span class="nv">$REMOVE_AND_OR_PERIOD_OPT</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"on"</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-63"></a>         sed -E -e <span class="s1">'s/^(and|or)[ \t]+//'</span> -e <span class="s1">'s/\.[ \t]*$//'</span> <span class="o">||</span> cat<span class="o">)</span> <span class="p">|</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-64"></a>    sort -u <span class="p">|</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-65"></a>    sed -E -e <span class="s1">'s/$/,/'</span> <span class="p">|</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-66"></a>    <span class="o">(</span><span class="k">if</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$AND_OPT</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"on"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> sed -e <span class="s1">'$s/^/and /'</span><span class="p">;</span> <span class="k">else</span> cat<span class="p">;</span> <span class="k">fi</span><span class="o">)</span> <span class="p">|</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-67"></a>    <span class="o">(</span><span class="k">if</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$FINAL_OPT</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"on"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> cat<span class="p">;</span> <span class="k">else</span> sed -e <span class="s1">'$s/,//'</span><span class="p">;</span> <span class="k">fi</span><span class="o">)</span> <span class="p">|</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-68"></a>    <span class="o">(</span><span class="k">if</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$OR_OPT</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"on"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> sed -e <span class="s1">'$s/^/or /'</span><span class="p">;</span> <span class="k">else</span> cat<span class="p">;</span> <span class="k">fi</span><span class="o">)</span> <span class="p">|</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-69"></a>    <span class="o">(</span><span class="k">if</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$PERIOD_OPT</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"on"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> sed -e <span class="s1">'$s/$/./'</span><span class="p">;</span> <span class="k">else</span> cat<span class="p">;</span> <span class="k">fi</span><span class="o">)</span> <span class="p">|</span>
<a name="rest_code_3f549bedc0ea4e27b816ad2974aafb39-70"></a>    tr <span class="s1">'\n'</span> <span class="s1">' '</span> <span class="p">|</span> sed -E -e <span class="s1">'s/[ ]$//'</span>
</pre>
<p>Here's <span class="file">strip-leading-hash</span>:</p>
<p><a class="reference external" href="listings/strip-leading-hash.html">strip-leading-hash</a>  <a class="reference external" href="listings/strip-leading-hash">(Source)</a></p>
<pre class="code bash"><a name="rest_code_0c0c34ba8d874575a14bacec94596314-1"></a><span class="ch">#! /usr/bin/env bash</span>
<a name="rest_code_0c0c34ba8d874575a14bacec94596314-2"></a>
<a name="rest_code_0c0c34ba8d874575a14bacec94596314-3"></a>sed -E -e <span class="s1">'s/^#[ \t]*//'</span>
</pre>
<p>And here's <span class="file">prefix</span>:</p>
<p><a class="reference external" href="listings/prefix.html">prefix</a>  <a class="reference external" href="listings/prefix">(Source)</a></p>
<pre class="code bash"><a name="rest_code_43c6d092c63947afaa0aa33f8258e215-1"></a><span class="ch">#! /usr/bin/env bash</span>
<a name="rest_code_43c6d092c63947afaa0aa33f8258e215-2"></a>
<a name="rest_code_43c6d092c63947afaa0aa33f8258e215-3"></a>sed <span class="s2">"s/^/</span><span class="nv">$1</span><span class="s2">/"</span>
</pre>
</div>
    <nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="categories/bash/" rel="tag">bash</a></li>
            <li><a class="tag p-category" href="categories/emacs/" rel="tag">emacs</a></li>
            <li><a class="tag p-category" href="categories/script/" rel="tag">script</a></li>
            <li><a class="tag p-category" href="categories/shell/" rel="tag">shell</a></li>
        </ul></nav>
</div>
    </article>
</div>
        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-91.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="lacking-natural-simplicity";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
            <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
                    <div class="sidebar-module sidebar-module-inset">
      <h4>About</h4>
      <p>Lacking Natural Simplicity is one, not particularly flattering, 
         definition of sophisticated.  
         This blog chronicles my journey through our at times too complicated 
         and sophisticated world. </p>
    </div>
    <div class="sidebar-module">
      <h4>Links</h4>
      <ol class="list-unstyled">
<li><a href="pages/about-the-blog/index.html">About the Blog</a></li>
        <li><a href="pages/colophon/index.html">Colophon</a></li>
        <li><a href="pages/typographical-conventions/index.html">Typographical Conventions</a></li>
        <li><a href="pages/static-pages-index/index.html">Pages</a></li>
        <li>
<a href="http://tkb.tx0.org/">My other web page</a>
            <p>    Mostly empty</p>
        </li>
      </ol>
</div>
    
            </div>
        <!--End of body content-->
        </div>
    </div>
</div>

<footer class="blog-footer" id="footer">
    Contents © 2021         <a href="mailto:tkurtbond@gmail.com">T. Kurt Bond</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
    
</footer><script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
