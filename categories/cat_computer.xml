<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Lacking Natural Simplicity (Posts about computer)</title><link>https://tkurtbond.github.io/</link><description></description><atom:link href="https://tkurtbond.github.io/categories/cat_computer.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:tkurtbond@gmail.com"&gt;T. Kurt Bond&lt;/a&gt; </copyright><lastBuildDate>Wed, 15 Jun 2022 00:57:13 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Lisp-style trampolines in Common Lisp, C, Ada, Oberon-2, and Revised Oberon</title><link>https://tkurtbond.github.io/posts/2022/06/14/lisp-style-trampolines-in-common-lisp-c-ada-oberon-2-and-revised-oberon/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;Are you familiar with &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Trampoline_(computing)#High-level_programming"&gt;lisp-style trampolines&lt;/a&gt;?  A trampoline is a
loop that iteratively invokes functions that return functions.  The
previous link will lead you through &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Trampoline_(computing)#cite_note-Baker_1995-1"&gt;CONS Should Not CONS Its
Arguments, Part II: Cheney on the M.T.A.&lt;/a&gt; (&lt;a class="reference external" href="https://dl.acm.org/doi/10.1145/214448.214454"&gt;PDF version&lt;/a&gt;; see p. 17
in the original publication, but that is the first page of the PDF
that link eventually leads to), which, while saying you should just go
ahead and convert to &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Continuation-passing_style"&gt;Continuation-passing style&lt;/a&gt; form (CPS),
mentions in passing &lt;a class="reference external" href="https://dl.acm.org/doi/10.1145/151333.151343"&gt;No assembly required: compiling standard ML to C&lt;/a&gt;,
(see p. 168 in the original publication, which is the page 8 of the
PDF that link eventually leads to) which leads you to &lt;a class="reference external" href="https://dspace.mit.edu/handle/1721.1/6913"&gt;RABBIT: A
Compiler for SCHEME&lt;/a&gt;, where the concept is discussed under the name
the "SCHEME UUO handler" (see p. 23–24).&lt;/p&gt;
&lt;p&gt;Why is this useful?  It allows you to compile a language that requires
proper &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Tail_call"&gt;tail call&lt;/a&gt; optimization to one that does not provide that.
For instance, if you wanted to compile Scheme, which requires proper
tail call optimization, to Common Lisp, which does not require proper
tail call optimization, you can't just translate Scheme functions
directly into Common Lisp functions, because tail calls allocate stack
space, and eventually the stack will run out of space.&lt;/p&gt;
&lt;p&gt;Here's an example that will run forever in any standard confirming
Scheme, &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/forever.scm"&gt;forever.scm&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="code scheme"&gt;&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;;;; Recurse forever, because with tail call optimization, the stack&lt;/span&gt;
&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;;;; never runs out!&lt;/span&gt;
&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-3"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;define &lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-5"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;define &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-6"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;set! &lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;+ &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-7"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;display &lt;/span&gt;&lt;span class="s"&gt;"call #"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;display &lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;newline&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-8"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-9"&gt;&lt;/a&gt;
&lt;a name="rest_code_e731a77a9cf14ac1b1b705d00e35dedb-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/common-lisp/not_forever.lisp"&gt;not_forever.lisp&lt;/a&gt;, the same thing in Common Lisp:&lt;/p&gt;
&lt;pre class="code common-lisp"&gt;&lt;a name="rest_code_957c0c76b6234810aa60bd311eba3b72-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;;;; Recurse until the stack space runs out.&lt;/span&gt;
&lt;a name="rest_code_957c0c76b6234810aa60bd311eba3b72-2"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defparameter&lt;/span&gt; &lt;span class="nv"&gt;i&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_957c0c76b6234810aa60bd311eba3b72-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_957c0c76b6234810aa60bd311eba3b72-4"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_957c0c76b6234810aa60bd311eba3b72-5"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;incf&lt;/span&gt; &lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_957c0c76b6234810aa60bd311eba3b72-6"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;format&lt;/span&gt; &lt;span class="no"&gt;t&lt;/span&gt; &lt;span class="s"&gt;"call #~d~%"&lt;/span&gt; &lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_957c0c76b6234810aa60bd311eba3b72-7"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_957c0c76b6234810aa60bd311eba3b72-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_957c0c76b6234810aa60bd311eba3b72-9"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Now, some Common Lisp implementations don't do tail call
optimization, and some &lt;strong&gt;do&lt;/strong&gt;.  Some don't do tail call optimization
unless you compile the functions in question.&lt;/p&gt;
&lt;p&gt;So, for instance, if I load that file into GNU CLISP 2.49.92, the
function executes about 4668 times and then &lt;span class="app"&gt;CLISP&lt;/span&gt; dies with the
error message:&lt;/p&gt;
&lt;pre class="literal-block"&gt;*** - Lisp stack overflow. RESET&lt;/pre&gt;
&lt;p&gt;However if I compile that file in &lt;span class="app"&gt;CLISP&lt;/span&gt; with the Common Lisp function
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;compile-file&lt;/span&gt;&lt;/code&gt; and then load the resulting &lt;span class="file"&gt;.fas&lt;/span&gt; file into
&lt;span class="app"&gt;CLISP&lt;/span&gt;, it will run forever, because &lt;span class="app"&gt;CLISP&lt;/span&gt; does tail call
optimization when it compiles code.&lt;/p&gt;
&lt;p&gt;Furthermore, if I load that file into &lt;span class="app"&gt;SBCL&lt;/span&gt; it will run forever,
because &lt;span class="app"&gt;SBCL&lt;/span&gt; does tail call optimization by default.&lt;/p&gt;
&lt;p&gt;&lt;span class="app"&gt;ECL&lt;/span&gt; is another Common Lisp system where if you load that file
into  an interactive session it will die with stack overflow, but if
you compile that file into an executable it will run forever.&lt;/p&gt;
&lt;p&gt;So, suppose you wanted to translate the Scheme code into Common Lisp.
You'd use a trampoline to make sure the stack doesn't overflow.&lt;/p&gt;
&lt;p&gt;Here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/common-lisp/trampoline.lisp"&gt;trampoline.lisp&lt;/a&gt;, a trampoline in Common Lisp that runs
through three functions and then stops, for simplicity:&lt;/p&gt;
&lt;pre class="code common-lisp"&gt;&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;;;; Demonstrate lisp-style trampolines.&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-2"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt; &lt;span class="nv"&gt;baz&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-3"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;format&lt;/span&gt; &lt;span class="no"&gt;t&lt;/span&gt; &lt;span class="s"&gt;"baz~%"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-4"&gt;&lt;/a&gt;  &lt;span class="no"&gt;nil&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-6"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt; &lt;span class="nv"&gt;bar&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-7"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;format&lt;/span&gt; &lt;span class="no"&gt;t&lt;/span&gt; &lt;span class="s"&gt;"bar~%"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-8"&gt;&lt;/a&gt;  &lt;span class="nf"&gt;#'&lt;/span&gt;&lt;span class="nv"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-9"&gt;&lt;/a&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt; &lt;span class="nv"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-11"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;format&lt;/span&gt; &lt;span class="no"&gt;t&lt;/span&gt; &lt;span class="s"&gt;"foo~%"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-12"&gt;&lt;/a&gt;  &lt;span class="nf"&gt;#'&lt;/span&gt;&lt;span class="nv"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-14"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="nf"&gt;#'&lt;/span&gt;&lt;span class="nv"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-15"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;loop&lt;/span&gt; &lt;span class="nv"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;i&lt;/span&gt; &lt;span class="nv"&gt;from&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="nv"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;not&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;null&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_ea2f34d5f9b647eaa394f5d2ff7a5333-16"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;do&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;setf&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;funcall&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/common-lisp/trampoline_forever.lisp"&gt;trampoline_forever.lisp&lt;/a&gt;, a trampoline in Common Lisp that
runs forever:&lt;/p&gt;
&lt;pre class="code common-lisp"&gt;&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;;;; Recurse forever without running out of stack space.&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-2"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt; &lt;span class="nv"&gt;baz&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-3"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;format&lt;/span&gt; &lt;span class="no"&gt;t&lt;/span&gt; &lt;span class="s"&gt;"baz~%"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-4"&gt;&lt;/a&gt;  &lt;span class="nf"&gt;#'&lt;/span&gt;&lt;span class="nv"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-6"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt; &lt;span class="nv"&gt;bar&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-7"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;format&lt;/span&gt; &lt;span class="no"&gt;t&lt;/span&gt; &lt;span class="s"&gt;"bar~%"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-8"&gt;&lt;/a&gt;  &lt;span class="nf"&gt;#'&lt;/span&gt;&lt;span class="nv"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-9"&gt;&lt;/a&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt; &lt;span class="nv"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-11"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;format&lt;/span&gt; &lt;span class="no"&gt;t&lt;/span&gt; &lt;span class="s"&gt;"foo~%"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-12"&gt;&lt;/a&gt;  &lt;span class="nf"&gt;#'&lt;/span&gt;&lt;span class="nv"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-14"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="nf"&gt;#'&lt;/span&gt;&lt;span class="nv"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-15"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;loop&lt;/span&gt; &lt;span class="nv"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;i&lt;/span&gt; &lt;span class="nv"&gt;from&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="nv"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;not&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;null&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-16"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;do&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;progn&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-17"&gt;&lt;/a&gt;             &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;format&lt;/span&gt; &lt;span class="no"&gt;t&lt;/span&gt; &lt;span class="s"&gt;"trampoline call #~s~%"&lt;/span&gt; &lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_77b5e71e2f3e4330b57ebb5e558cdde7-18"&gt;&lt;/a&gt;             &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;setf&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;funcall&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)))))&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Of course, you can do the same things in C.  First, here's
&lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/c/not_forever.c"&gt;not_forever.c&lt;/a&gt;, a program in C that will (usually) die with a stack
overflow:&lt;/p&gt;
&lt;pre class="code c"&gt;&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-1"&gt;&lt;/a&gt;&lt;span class="cm"&gt;/* Recurse until stack space runs out.&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-2"&gt;&lt;/a&gt;&lt;span class="cm"&gt;   Unless the compiler does tail-call optimization. */&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-3"&gt;&lt;/a&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;                 &lt;span class="cm"&gt;/* Number of times f has been called. */&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-7"&gt;&lt;/a&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-8"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-9"&gt;&lt;/a&gt;  &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-10"&gt;&lt;/a&gt;  &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"call #%d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-11"&gt;&lt;/a&gt;  &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-12"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-14"&gt;&lt;/a&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-15"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-16"&gt;&lt;/a&gt;  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-17"&gt;&lt;/a&gt;  &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_9aebe3427947487ab841f6d2913ff547-18"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;I say usually, because tail call optimization is not required by the
standard, and many C compilers do not do it.  For instance, &lt;span class="app"&gt;gcc&lt;/span&gt;
doesn't do tail call optimization &lt;strong&gt;unless&lt;/strong&gt; you specify
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-foptimize-sibling-calls&lt;/span&gt;&lt;/code&gt; or &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-O2&lt;/span&gt;&lt;/code&gt;, &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-O3&lt;/span&gt;&lt;/code&gt;, or &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-Os&lt;/span&gt;&lt;/code&gt;.  If I
don't specify any of those options, on my system that program dies
with the error &lt;code class="docutils literal"&gt;Segmentation fault: 11&lt;/code&gt; after call #523932.&lt;/p&gt;
&lt;p&gt;Here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/c/trampoline.c"&gt;trampoline.c&lt;/a&gt;, the limited trampoline in C:&lt;/p&gt;
&lt;pre class="code c"&gt;&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-1"&gt;&lt;/a&gt;&lt;span class="cm"&gt;/* Demonstrate lisp-style trampolines. */&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-2"&gt;&lt;/a&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;trampoline&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-6"&gt;&lt;/a&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-7"&gt;&lt;/a&gt;&lt;span class="nf"&gt;baz&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-8"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-9"&gt;&lt;/a&gt;  &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"baz&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-10"&gt;&lt;/a&gt;  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-11"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-13"&gt;&lt;/a&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-14"&gt;&lt;/a&gt;&lt;span class="nf"&gt;bar&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-15"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-16"&gt;&lt;/a&gt;  &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"bar&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-17"&gt;&lt;/a&gt;  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-18"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-20"&gt;&lt;/a&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-21"&gt;&lt;/a&gt;&lt;span class="nf"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-22"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-23"&gt;&lt;/a&gt;  &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"foo&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-24"&gt;&lt;/a&gt;  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-25"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-26"&gt;&lt;/a&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-27"&gt;&lt;/a&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-28"&gt;&lt;/a&gt;&lt;span class="kt"&gt;int&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-29"&gt;&lt;/a&gt;&lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-30"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-31"&gt;&lt;/a&gt;  &lt;span class="n"&gt;trampoline&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-32"&gt;&lt;/a&gt;  &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-33"&gt;&lt;/a&gt;    &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-34"&gt;&lt;/a&gt;  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_089bd9efabad45c3b7a184bdd4710237-35"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Notice this works by converting pointers to functions to pointers to void
— it doesn't even require any explicit casting!&lt;/p&gt;
&lt;p&gt;And here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/c/trampoline_forever.c"&gt;trampoline_forever.c&lt;/a&gt;, the trampoline that runs forever:&lt;/p&gt;
&lt;pre class="code c"&gt;&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-1"&gt;&lt;/a&gt;&lt;span class="cm"&gt;/* Recurse forever without running out of stack spacc. */&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-2"&gt;&lt;/a&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;trampoline&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-6"&gt;&lt;/a&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;               &lt;span class="cm"&gt;/* Forward declaration. */&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-8"&gt;&lt;/a&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-9"&gt;&lt;/a&gt;&lt;span class="nf"&gt;baz&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-11"&gt;&lt;/a&gt;  &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"baz&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-12"&gt;&lt;/a&gt;  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-13"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-14"&gt;&lt;/a&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-15"&gt;&lt;/a&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-16"&gt;&lt;/a&gt;&lt;span class="nf"&gt;bar&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-17"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-18"&gt;&lt;/a&gt;  &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"bar&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-19"&gt;&lt;/a&gt;  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-20"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-21"&gt;&lt;/a&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-22"&gt;&lt;/a&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-23"&gt;&lt;/a&gt;&lt;span class="nf"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-24"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-25"&gt;&lt;/a&gt;  &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"foo&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-26"&gt;&lt;/a&gt;  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-27"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-28"&gt;&lt;/a&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-29"&gt;&lt;/a&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-30"&gt;&lt;/a&gt;&lt;span class="kt"&gt;int&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-31"&gt;&lt;/a&gt;&lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-32"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-33"&gt;&lt;/a&gt;  &lt;span class="n"&gt;trampoline&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-34"&gt;&lt;/a&gt;  &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-35"&gt;&lt;/a&gt;    &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-36"&gt;&lt;/a&gt;  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2a12b804769e4b949fe09459299fe81e-37"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;So, here's where C's weak typing lets it get away with things that
more strongly typed languages don't.  Notice the declaration of the
trampoline type:&lt;/p&gt;
&lt;pre class="code c"&gt;&lt;a name="rest_code_310131c7e8df4d92ae69da9574897362-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="n"&gt;def&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;trampoline&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;p id="mentioning-recursive-types"&gt;Notice how it returns a &lt;code class="docutils literal"&gt;void *&lt;/code&gt;, instead of something more
specific?  That's because if it tried to return something more
specific, it would have to a &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Recursive_data_type"&gt;recursive type&lt;/a&gt;: that is to say, while
defining the type &lt;code class="docutils literal"&gt;trampoline&lt;/code&gt;, you would use a reference to the
type while defining the type.  It would look something like this:&lt;/p&gt;
&lt;pre class="code c"&gt;&lt;a name="rest_code_fa8423a6945c4f2b89c8e6f74445d527-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="n"&gt;trampoline&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;trampoline&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;and that results in the &lt;span class="app"&gt;gcc&lt;/span&gt; issuing the following error:&lt;/p&gt;
&lt;pre class="literal-block"&gt;error: unknown type name 'trampoline'&lt;/pre&gt;
&lt;p&gt;Very few traditional programming languages allow this.  It isn't a
problem in Scheme or Common Lisp because those languages use strong
dynamic typing, where the types are checked at runtime.&lt;/p&gt;
&lt;p&gt;So how do you do this in languages with strong static typing?&lt;/p&gt;
&lt;p&gt;Well, let's try this in some of the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon_(programming_language)"&gt;Oberon&lt;/a&gt; programming language
dialects.  &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon_(programming_language)"&gt;Oberon&lt;/a&gt; was designed and implemented by Niklaus Wirth
(&lt;a class="reference external" href="https://people.inf.ethz.ch/wirth/"&gt;NW1&lt;/a&gt;, &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Niklaus_Wirth"&gt;NW2&lt;/a&gt;) as a simplification and generalization of his earlier
languages &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Pascal_(programming_language)"&gt;Pascal&lt;/a&gt;, &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Modula"&gt;Modula&lt;/a&gt;, and &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Modula-2"&gt;Modula-2&lt;/a&gt;.  I find the original Oberon
admirable for its simplicity, strong typing, understandable syntax,
and its introduction of &lt;a class="reference external" href="https://dl.acm.org/doi/abs/10.1145/42190.46167"&gt;Type Extensions&lt;/a&gt; (which organizes &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Record_(computer_science)"&gt;record
types&lt;/a&gt; in a inheritance hierarchy, which with the use of procedure
variables enables object oriented programming in a particularly
straightforward and flexible way) but struggle with its minimalism and
how its standard libraries differ in paradigm from the standard Unix
libraries, since Oberon was used to implement a new operating system,
the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon_(operating_system)"&gt;Oberon System&lt;/a&gt; with its own completely unique &lt;a class="reference external" href="https://en.wikipedia.org/wiki/API"&gt;API&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon_(programming_language)"&gt;Oberon&lt;/a&gt; has a number of dialects. I'm most fond of &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon-2"&gt;Oberon-2&lt;/a&gt;, which
was the second language in the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon_(programming_language)"&gt;Oberon&lt;/a&gt; family, developed by &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Hanspeter_M%C3%B6ssenb%C3%B6ck"&gt;Hanspeter
Mössenböck&lt;/a&gt; and Niklaus Wirth.  It is a little less minimalist than
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon_(programming_language)"&gt;Oberon&lt;/a&gt;, and among a few other things adds type-bound procedures to
the record hierarchy provided by &lt;a class="reference external" href="https://dl.acm.org/doi/abs/10.1145/42190.46167"&gt;Type Extensions&lt;/a&gt;, providing a
appealingly simple and direct design for object-oriented programming
that was later adopted by the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ada_(programming_language)"&gt;Ada&lt;/a&gt; programming language (in a more
complicated and confusing manner, as might be expected by &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ada_(programming_language)"&gt;Ada&lt;/a&gt;'s
plethora of design goals and constraints).  Here's a copy of the
Oberon-2 language report in PDF (&lt;a class="reference external" href="https://tkurtbond.github.io/Oberon-2/Oberon2.pdf"&gt;O2PDF&lt;/a&gt;) and HTML (&lt;a class="reference external" href="https://web.archive.org/web/20151104101932/https://cseweb.ucsd.edu/~wgg/CSE131B/oberon2.htm"&gt;O2HTML&lt;/a&gt;), for
reference.&lt;/p&gt;
&lt;p&gt;Anyway, &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon-2"&gt;Oberon-2&lt;/a&gt; has procedure types and procedure variables, so one
would think it would be simple to implement trampolines in &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon-2"&gt;Oberon-2&lt;/a&gt;,
without messing about with pointers.  It turns out to be more
complicated than one would think.&lt;/p&gt;
&lt;p&gt;I'm using &lt;a class="reference external" href="https://github.com/vishaps/voc"&gt;Vishap Oberon&lt;/a&gt;, a free and open source Oberon-2 compiler,
by the way.&lt;/p&gt;
&lt;p&gt;First, here's &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2022/06/14/lisp-style-trampolines-in-common-lisp-c-ada-oberon-2-and-revised-oberon/trampolines/oberon-2/NotForever.Mod"&gt;NotForever.Mod&lt;/a&gt;, the standard program with a recursive
function procedure that will overflow the stack.&lt;/p&gt;
&lt;pre class="code modula2"&gt;&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-1"&gt;&lt;/a&gt;&lt;span class="kr"&gt;MODULE&lt;/span&gt; &lt;span class="n"&gt;NotForever&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;              &lt;span class="cm"&gt;(* Recurse until stack space runs out. *)&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-2"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;IMPORT&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-3"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;VAR&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;LONGINT&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;               &lt;span class="cm"&gt;(* Number of times f has been called. *)&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-5"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-6"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-7"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;INC&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"call #"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Int&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-10"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-12"&gt;&lt;/a&gt;&lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-13"&gt;&lt;/a&gt;  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-14"&gt;&lt;/a&gt;  &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_5182d2b31d8c4963abc6ebd5876c1826-15"&gt;&lt;/a&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;NotForever&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;On my system, this program dies with with the error &lt;code class="docutils literal"&gt;Segmentation
fault: 11&lt;/code&gt; after call #524008.&lt;/p&gt;
&lt;p&gt;Now on to trampolines.  In theory we should be able to declare a type
that is a function procedure that returns other function procedures.
Here's the first attempt at the limited trampoline,
&lt;a class="reference external" href="https://tkurtbond.github.io/posts/2022/06/14/lisp-style-trampolines-in-common-lisp-c-ada-oberon-2-and-revised-oberon/trampolines/oberon-2/TrampolineBroken.Mod"&gt;TrampolineBroken.Mod&lt;/a&gt;.&lt;/p&gt;
&lt;pre class="code modula2"&gt;&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-1"&gt;&lt;/a&gt;&lt;span class="kr"&gt;MODULE&lt;/span&gt; &lt;span class="n"&gt;TrampolineBroken&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;              &lt;span class="cm"&gt;(* Fail to demonstrate lisp-style trampolines. *)&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-2"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;IMPORT&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-4"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;TYPE&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="p"&gt;():&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="cm"&gt;(* This is an error. *)&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-6"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;VAR&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-8"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt; &lt;span class="p"&gt;():&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-9"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"baz"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="nb"&gt;NIL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-12"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-14"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt; &lt;span class="p"&gt;():&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-15"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"bar"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-17"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-18"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-20"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;():&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-21"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"foo"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-24"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-25"&gt;&lt;/a&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-26"&gt;&lt;/a&gt;&lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-27"&gt;&lt;/a&gt;  &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-28"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;WHILE&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;NIL&lt;/span&gt; &lt;span class="kr"&gt;DO&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-29"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-30"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_a5f4fda7132e4d62b6355ba7f5f35f3a-31"&gt;&lt;/a&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;TrampolineBroken&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Unfortunately, trying to compile this dies with the following error
message:&lt;/p&gt;
&lt;pre class="literal-block"&gt;TrampolineBroken.Mod  Compiling TrampolineBroken.

   4:   TYPE Thunk = PROCEDURE (): Thunk;
                             ^
    pos   126  err 244  cyclic type definition not allowed

Module compilation failed.&lt;/pre&gt;
&lt;p&gt;As mentioned &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2022/06/14/lisp-style-trampolines-in-common-lisp-c-ada-oberon-2-and-revised-oberon/#mentioning-recursive-types"&gt;above&lt;/a&gt;, this is a case of a &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Recursive_data_type"&gt;recursive type&lt;/a&gt;.  Well, drat.&lt;/p&gt;
&lt;p&gt;At this point the immediate reaction is to look at the C version and
try to hack up something analogous using functionality from
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon-2"&gt;Oberon-2&lt;/a&gt;'s &lt;code class="docutils literal"&gt;SYSTEM&lt;/code&gt; module, but that way lies madness, difficulty,
and type errors.  Instead, you have to step back and think about
things from another viewpoint.  The problem is that we can't declare a
type for a function procedure that returns another function procedure
of its type, because that is recursive.  Instead of trying for a
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Recursive_data_type"&gt;recursive type&lt;/a&gt;, what if we switched to storing the next procedure
to be run in a global variable, &lt;code class="docutils literal"&gt;next&lt;/code&gt;, and having each procedure in
the chain set that to the procedure that should run next?  That should
work!&lt;/p&gt;
&lt;p&gt;Here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/oberon-2/Trampoline.Mod"&gt;Trampoline.Mod&lt;/a&gt;, a version that works!&lt;/p&gt;
&lt;pre class="code modula2"&gt;&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-1"&gt;&lt;/a&gt;&lt;span class="kr"&gt;MODULE&lt;/span&gt; &lt;span class="n"&gt;Trampoline&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;              &lt;span class="cm"&gt;(* Demonstrate lisp-style trampolines. *)&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-2"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;IMPORT&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-4"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;TYPE&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-6"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;VAR&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;              &lt;span class="cm"&gt;(* Next procedure to be called. *)&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-8"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-9"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"baz"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="nb"&gt;NIL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-12"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-14"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-15"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"bar"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-17"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-18"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-20"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-21"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"foo"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-24"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-25"&gt;&lt;/a&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-26"&gt;&lt;/a&gt;&lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-27"&gt;&lt;/a&gt;  &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-28"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;WHILE&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;NIL&lt;/span&gt; &lt;span class="kr"&gt;DO&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-29"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-30"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_96a8925a56b8496185cf2215ca1dc29a-31"&gt;&lt;/a&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;Trampoline&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;And here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/oberon-2/TrampolineForever.Mod"&gt;TrampolineForever.Mod&lt;/a&gt;, which also works!&lt;/p&gt;
&lt;pre class="code modula2"&gt;&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-1"&gt;&lt;/a&gt;&lt;span class="kr"&gt;MODULE&lt;/span&gt; &lt;span class="n"&gt;TrampolineForever&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-2"&gt;&lt;/a&gt;  &lt;span class="cm"&gt;(* Recurse forever without running out of stack space.  *)&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-3"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;IMPORT&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-5"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;TYPE&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-7"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;VAR&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;         &lt;span class="cm"&gt;(* Next procedure to be called. *)&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;INTEGER&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;          &lt;span class="cm"&gt;(* Number of times through the trampoline. *)&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-10"&gt;&lt;/a&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-11"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;        &lt;span class="cm"&gt;(* Forward declaration. *)&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-13"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-14"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"baz"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-17"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-18"&gt;&lt;/a&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-19"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-20"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"bar"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-23"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-24"&gt;&lt;/a&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-25"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-26"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-27"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"foo"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-29"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-30"&gt;&lt;/a&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-31"&gt;&lt;/a&gt;&lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-32"&gt;&lt;/a&gt;  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-33"&gt;&lt;/a&gt;  &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-34"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;WHILE&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;NIL&lt;/span&gt; &lt;span class="kr"&gt;DO&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-35"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;INC&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-36"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"call #"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Int&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-37"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-38"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_c80ad2b3f59e48629bb5362b0349b2e0-39"&gt;&lt;/a&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;TrampolineForever&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Wirth has continued to work on Oberon, producing an even more
minimalist revision, often know as Oberon-07, or &lt;a class="reference external" href="https://people.inf.ethz.ch/wirth/Oberon/index.html"&gt;Revised Oberon&lt;/a&gt;.
Unfortunately, he removed forward declarations and the &lt;code class="docutils literal"&gt;LONGINT&lt;/code&gt;
type, which means we have to make some minor changes.&lt;/p&gt;
&lt;p&gt;I'm using OBNC (&lt;a class="reference external" href="https://miasap.se/obnc/"&gt;OBNC1&lt;/a&gt;, &lt;a class="reference external" href="https://github.com/GunterMueller/OBNC"&gt;OBNC2&lt;/a&gt;) for &lt;a class="reference external" href="https://people.inf.ethz.ch/wirth/Oberon/index.html"&gt;Revised Oberon&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here's the &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/revised-oberon/NotForever.Mod"&gt;Revised Oberon NotForever.Mod&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="code modula2"&gt;&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-1"&gt;&lt;/a&gt;&lt;span class="kr"&gt;MODULE&lt;/span&gt; &lt;span class="n"&gt;NotForever&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;           &lt;span class="cm"&gt;(* Recurse until stack space runs out. *)&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-2"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;IMPORT&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-3"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;VAR&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;INTEGER&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;            &lt;span class="cm"&gt;(* Number of times f has been called. *)&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-4"&gt;&lt;/a&gt;    &lt;span class="cm"&gt;(* Alas, no more LONGINT. *)&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-6"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-7"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-8"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;INC&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"call #"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Int&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-11"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-13"&gt;&lt;/a&gt;&lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-14"&gt;&lt;/a&gt;  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-15"&gt;&lt;/a&gt;  &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_8ac7888cc4a74ac0a8c673c79f1d2c00-16"&gt;&lt;/a&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;NotForever&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Here's the &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/revised-oberon/Trampoline.Mod"&gt;Revised Oberon Trampoline.Mod&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="code modula2"&gt;&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-1"&gt;&lt;/a&gt;&lt;span class="kr"&gt;MODULE&lt;/span&gt; &lt;span class="n"&gt;Trampoline&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;              &lt;span class="cm"&gt;(* Demonstrate lisp-style trampolines. *)&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-2"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;IMPORT&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-4"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;TYPE&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-6"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;VAR&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;              &lt;span class="cm"&gt;(* Next procedure to be called. *)&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-8"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-9"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"baz"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="nb"&gt;NIL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-12"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-14"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-15"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"bar"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-17"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-18"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-20"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-21"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"foo"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-24"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-25"&gt;&lt;/a&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-26"&gt;&lt;/a&gt;&lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-27"&gt;&lt;/a&gt;  &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-28"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;WHILE&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;NIL&lt;/span&gt; &lt;span class="kr"&gt;DO&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-29"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-30"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_2063e684b3a2452bac72adca8d497633-31"&gt;&lt;/a&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;Trampoline&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Note that with forward declarations removed, we just declare a
procedure type and procedure variable, initialize it before starting
the trampoline, and refer to it instead of &lt;code class="docutils literal"&gt;foo&lt;/code&gt; in procedure
&lt;code class="docutils literal"&gt;baz&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Here's the &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/revised-oberon/TrampolineForever.Mod"&gt;Revised Oberon TrampolineForever.Mod&lt;/a&gt;&lt;/p&gt;
&lt;pre class="code modula2"&gt;&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-1"&gt;&lt;/a&gt;&lt;span class="kr"&gt;MODULE&lt;/span&gt; &lt;span class="n"&gt;TrampolineForever&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-2"&gt;&lt;/a&gt;  &lt;span class="cm"&gt;(* Recurse forever without running out of stack space.  *)&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-3"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;IMPORT&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-5"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;TYPE&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-7"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;VAR&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;      &lt;span class="cm"&gt;(* Forward declaration. *)&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;         &lt;span class="cm"&gt;(* Next procedure to be called. *)&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;INTEGER&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;          &lt;span class="cm"&gt;(* Number of times through the trampoline. *)&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-12"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-13"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"baz"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-16"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-17"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-18"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-19"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"bar"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-22"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-23"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-24"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;PROCEDURE&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-25"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-26"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"foo"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-27"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-28"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-29"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-30"&gt;&lt;/a&gt;&lt;span class="kr"&gt;BEGIN&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-31"&gt;&lt;/a&gt;  &lt;span class="n"&gt;forward&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-32"&gt;&lt;/a&gt;  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-33"&gt;&lt;/a&gt;  &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-34"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;WHILE&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;NIL&lt;/span&gt; &lt;span class="kr"&gt;DO&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-35"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;INC&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-36"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"call #"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Int&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Ln&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-37"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-38"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;END&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffae2b54a1434404846656e3fff8d144-39"&gt;&lt;/a&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;TrampolineForever&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;And of course, since we mentioned &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ada_(programming_language)"&gt;Ada&lt;/a&gt; above, we should do a version
in that.  I'm using &lt;a class="reference external" href="https://en.wikipedia.org/wiki/GNAT"&gt;GNAT&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/ada/not_forever.adb"&gt;not_forever.adb&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="code ada"&gt;&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;with&lt;/span&gt; &lt;span class="nn"&gt;Ada.Text_IO&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="kn"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;Ada.Text_IO&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-2"&gt;&lt;/a&gt;&lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;not_forever&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;        &lt;span class="c1"&gt;-- recurse until stack space runs out.&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-3"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;type&lt;/span&gt; &lt;span class="kt"&gt;Unsigned&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;mod&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;   &lt;span class="c1"&gt;-- wrap to 0 when maximum value is execeeded.&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-4"&gt;&lt;/a&gt;  &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Unsigned&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;             &lt;span class="c1"&gt;-- Number of times f has been called.&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-6"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-7"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-10"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-12"&gt;&lt;/a&gt;&lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-13"&gt;&lt;/a&gt;  &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-14"&gt;&lt;/a&gt;&lt;span class="kr"&gt;exception&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-15"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;when&lt;/span&gt; &lt;span class="n"&gt;STORAGE_ERROR&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-16"&gt;&lt;/a&gt;  &lt;span class="n"&gt;Put&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"STORAGE_ERROR raised with i = "&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Put&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;Image&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;New_Line&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_0637b1874a0e493b95cb7aae437a4fc5-17"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;not_forever&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Again, &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ada_(programming_language)"&gt;Ada&lt;/a&gt; would have the same problem with &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Recursive_data_type"&gt;recursive type&lt;/a&gt;s as
the Oberon dialects.  Don't look at the C version and wander off into
forest of &lt;code class="docutils literal"&gt;Ada.Unchecked_Conversion&lt;/code&gt; because that's unsafe, or the
thicket of &lt;code class="docutils literal"&gt;System.Address_To_Access_Conversions&lt;/code&gt;, because that
one's really unsafe (and didn't work, when I tried it).  Instead, do
the same thing as we did in the Oberon dialects, and move to a global
variable instead of returning the values from the functions.&lt;/p&gt;
&lt;p&gt;Here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/ada/trampoline.adb"&gt;trampoline.adb&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="code ada"&gt;&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;with&lt;/span&gt; &lt;span class="nn"&gt;Ada.Text_IO&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="kn"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;Ada.Text_IO&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-2"&gt;&lt;/a&gt;&lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;trampoline&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;         &lt;span class="c1"&gt;-- Demonstrate lisp-style trampolines.&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-3"&gt;&lt;/a&gt;    &lt;span class="kd"&gt;type&lt;/span&gt; &lt;span class="kt"&gt;Thunk&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt; &lt;span class="kr"&gt;access&lt;/span&gt; &lt;span class="kd"&gt;procedure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Next&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;        &lt;span class="c1"&gt;-- Next procedure to be called.&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-7"&gt;&lt;/a&gt;    &lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;baz&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-8"&gt;&lt;/a&gt;    &lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-9"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Put_Line&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"baz"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Next&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-11"&gt;&lt;/a&gt;    &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-13"&gt;&lt;/a&gt;    &lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;bar&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-14"&gt;&lt;/a&gt;    &lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-15"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Put_Line&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"bar"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-16"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Next&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;Access&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-17"&gt;&lt;/a&gt;    &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-18"&gt;&lt;/a&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-19"&gt;&lt;/a&gt;    &lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;foo&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-20"&gt;&lt;/a&gt;    &lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-21"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Put_Line&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"foo"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-22"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Next&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;Access&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-23"&gt;&lt;/a&gt;    &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-24"&gt;&lt;/a&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-25"&gt;&lt;/a&gt;&lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-26"&gt;&lt;/a&gt;    &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;Access&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-27"&gt;&lt;/a&gt;    &lt;span class="kr"&gt;while&lt;/span&gt; &lt;span class="n"&gt;Next&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt; &lt;span class="kr"&gt;loop&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Next&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="kr"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-29"&gt;&lt;/a&gt;    &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="kr"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_e90348b069f8437cba875391cce19fc9-30"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;trampoline&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;And here's &lt;a class="reference external" href="https://tkurtbond.github.io/trampolines/ada/trampoline_forever.adb"&gt;trampoline_forever.adb&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="code ada"&gt;&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;with&lt;/span&gt; &lt;span class="nn"&gt;Ada.Text_IO&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="kn"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;Ada.Text_IO&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-2"&gt;&lt;/a&gt;&lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;trampoline_forever&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-3"&gt;&lt;/a&gt;  &lt;span class="c1"&gt;-- Recurse forever without running out of stack space.&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-4"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;type&lt;/span&gt; &lt;span class="kt"&gt;Unsigned&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;mod&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;   &lt;span class="c1"&gt;-- wrap to 0 when maximum value is execeeded.&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-5"&gt;&lt;/a&gt;  &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Unsigned&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;             &lt;span class="c1"&gt;-- Number of times through the trampoline.&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-7"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;type&lt;/span&gt; &lt;span class="kt"&gt;Thunk&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt; &lt;span class="kr"&gt;access&lt;/span&gt; &lt;span class="kd"&gt;procedure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-9"&gt;&lt;/a&gt;  &lt;span class="n"&gt;Next&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Thunk&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;          &lt;span class="c1"&gt;-- Next procedure to be called.&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-10"&gt;&lt;/a&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-11"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;        &lt;span class="c1"&gt;-- forward declaration.&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-13"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;baz&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-14"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Put_Line&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"baz"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Next&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;access&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-17"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-18"&gt;&lt;/a&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-19"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;bar&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-20"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Put_Line&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"bar"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Next&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;Access&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-23"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-24"&gt;&lt;/a&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-25"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;procedure&lt;/span&gt; &lt;span class="nf"&gt;foo&lt;/span&gt; &lt;span class="kr"&gt;is&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-26"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-27"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Put_Line&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"foo"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Next&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;Access&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-29"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-30"&gt;&lt;/a&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-31"&gt;&lt;/a&gt;&lt;span class="kr"&gt;begin&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-32"&gt;&lt;/a&gt;  &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;Access&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-33"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;while&lt;/span&gt; &lt;span class="n"&gt;Next&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt; &lt;span class="kr"&gt;loop&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-34"&gt;&lt;/a&gt;    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="p"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-35"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Put&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"call #"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Put&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;Image&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;New_Line&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-36"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Next&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="kr"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-37"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="kr"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-38"&gt;&lt;/a&gt;&lt;span class="kr"&gt;exception&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-39"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;when&lt;/span&gt; &lt;span class="n"&gt;STORAGE_ERROR&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-40"&gt;&lt;/a&gt;  &lt;span class="n"&gt;Put&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"STORAGE_ERROR raised with i = "&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Put&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;'&lt;/span&gt;&lt;span class="na"&gt;Image&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;New_Line&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_555276aa2e264440b943b97dcc060db4-41"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="nf"&gt;trampoline_forever&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;hr class="docutils"&gt;
&lt;p&gt;If you want to play around with this, the code is in a
&lt;a class="reference external" href="https://github.com/tkurtbond/trampolines"&gt;repository&lt;/a&gt; at &lt;a class="reference external" href="https://github.com/"&gt;Github&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;</description><category>ada</category><category>c</category><category>cheney on the m.t.a.</category><category>clisp</category><category>common lisp</category><category>continuation-passing style</category><category>cps</category><category>ecl</category><category>gcc</category><category>github</category><category>gnat</category><category>hanspeter mössenböck</category><category>lisp-style trampolines</category><category>modula</category><category>modula-2</category><category>niklaus wirth</category><category>no assembly required</category><category>oberon system</category><category>oberon-2</category><category>oberon-07</category><category>obnc</category><category>pascal</category><category>rabbit</category><category>record types</category><category>revised oberon</category><category>sbcl</category><category>scheme</category><category>tail call</category><category>tail call optimization</category><category>trampolines</category><category>type extensions</category><category>uuo handler</category><category>vishap oberon</category><guid>https://tkurtbond.github.io/posts/2022/06/14/lisp-style-trampolines-in-common-lisp-c-ada-oberon-2-and-revised-oberon/</guid><pubDate>Tue, 14 Jun 2022 19:49:55 GMT</pubDate></item><item><title>Installing a recent version of the A2 operatinng system on UNIX</title><link>https://tkurtbond.github.io/posts/2022/06/10/installing-a-recent-version-of-the-a2-operatinng-system-on-unix/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;I recently ran across a &lt;a class="reference external" href="https://svn.inf.ethz.ch/svn/lecturers/a2/trunk/UnixAos/DarwinA2%20Installer/ReadMeFirst!.txt"&gt;document&lt;/a&gt; that explains how to install the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/A2_(operating_system)"&gt;A2&lt;/a&gt;
operating system (formerly Bluebottle, formerly Aos) in the form of
UnixAos hosted on &lt;a class="reference external" href="https://en.wikipedia.org/wiki/MacOS"&gt;macOS&lt;/a&gt;, in the process of explaining how to make a
installer for macOS.  I think the same process will work for any
supported Unix.  [&lt;strong&gt;Later:&lt;/strong&gt; indeed, I used the &lt;a class="reference external" href="http://www.informatik.uni-bremen.de/~fld/UnixAos/rev.9799/LinuxA2-64bit.tgz"&gt;LinuxA2-64bit.tgz&lt;/a&gt; file
and the same process worked fine on my &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Fedora_Linux"&gt;Fedora&lt;/a&gt; box.]&lt;/p&gt;
&lt;p&gt;I'll summarize what I did.&lt;/p&gt;
&lt;p&gt;I went to &lt;a class="reference external" href="http://www.informatik.uni-bremen.de/~fld/UnixAos/"&gt;http://www.informatik.uni-bremen.de/~fld/UnixAos/&lt;/a&gt; and
selected the most recent revision, &lt;a class="reference external" href="http://www.informatik.uni-bremen.de/~fld/UnixAos/rev.9799/"&gt;rev.9799&lt;/a&gt; at the time of this
writing.  There I downloaded the install script, &lt;a class="reference external" href="http://www.informatik.uni-bremen.de/~fld/UnixAos/rev.9799/install.UnixA2"&gt;install.UnixA2&lt;/a&gt; and
the version for 64 bit macOS, &lt;a class="reference external" href="http://www.informatik.uni-bremen.de/~fld/UnixAos/rev.9799/DarwinA2-64bit.tgz"&gt;DarwinA2-64bit.tgz&lt;/a&gt;.  (There were also
Linux and Solaris versions for 32 and 64 bit systems.)&lt;/p&gt;
&lt;p&gt;Then I executed &lt;code class="docutils literal"&gt;chmod +x&lt;/code&gt;'ed the install script and ran it, passing
the &lt;span class="file"&gt;.tgz&lt;/span&gt; file to it.&lt;/p&gt;
&lt;p&gt;First, it asks for the installation directory, which should already
exist.  It has a default, but I installed to the directory
&lt;span class="file"&gt;/usr/local/sw/versions/aos/rev.9799&lt;/span&gt;.  Again, I had to create
that directory first.  (I don't like to write into &lt;span class="file"&gt;/usr&lt;/span&gt; or
&lt;span class="file"&gt;/usr/local&lt;/span&gt;, because those directory hierarchies are often
under the systems control.  Nobody uses &lt;span class="file"&gt;/usr/local/sw&lt;/span&gt; for
anything except me.)&lt;/p&gt;
&lt;p&gt;Second, it asks for the file name to copy the &lt;span class="file"&gt;aos&lt;/span&gt; script to.
I installed the &lt;span class="command"&gt;aos&lt;/span&gt; command to
&lt;span class="file"&gt;/Users/tkb/local/rndbin&lt;/span&gt;, (&lt;span class="file"&gt;/home/tkb/local/rndbin&lt;/span&gt; on
non-macOS systems) which is in my path.&lt;/p&gt;
&lt;p&gt;The install script assumes you are running as root, but I ran it first
as my normal user, and since the directory I was installing it to was
owned by me it seems to have worked ok, even though it complained
about &lt;span class="command"&gt;chgrp&lt;/span&gt; not being able to change the group of a &lt;em&gt;bunch&lt;/em&gt;
of files.&lt;/p&gt;
&lt;p&gt;Then when I issued the command &lt;code class="docutils literal"&gt;aos&lt;/code&gt; it started up and displayed a
window with A2 running in it.  (This requires X Windows, so you'll need
to install &lt;a class="reference external" href="https://www.xquartz.org/"&gt;XQuartz&lt;/a&gt; on macOS.)&lt;/p&gt;
&lt;p&gt;Here's a screen shot from macOS:&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Screenshot of A2 running under macOS" src="https://tkurtbond.github.io/a2-screenshot.png"&gt;
&lt;p class="caption"&gt;Screenshot of A2 running under macOS&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;It seems to work ok, both on macOS and Fedora, though I haven't
investigated very much.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Last edited: 2022-06-12 15:39:49 EDT&lt;/em&gt;&lt;/p&gt;
&lt;!-- Local Variables:
time-stamp-format: "%Y-%02m-%02d %02H:%02M:%02S %Z"
time-stamp-start: "\\*Last edited:[ \t]+\\\\?"
time-stamp-end: "\\*\\\\?\n"
time-stamp-line-limit: -20
End: --&gt;&lt;/div&gt;</description><category>a2</category><category>aos</category><category>bluebottle</category><category>fedora</category><category>macos</category><category>oberon</category><category>unix</category><guid>https://tkurtbond.github.io/posts/2022/06/10/installing-a-recent-version-of-the-a2-operatinng-system-on-unix/</guid><pubDate>Fri, 10 Jun 2022 15:28:40 GMT</pubDate></item><item><title>The criticisms of Pascal in “Why Pascal is Not My Favorite Programming Language” applied to Oberon</title><link>https://tkurtbond.github.io/posts/2022/06/05/the-criticisms-of-pascal-in-why-pascal-is-not-my-favorite-programming-language-applied-to-oberon/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;I reread Brian W. Kernighan’s famous paper “Why Pascal is Not My
Favorite Programming Language”
(&lt;a class="reference external" href="https://www.cs.virginia.edu/~evans/cs655/readings/bwk-on-pascal.html"&gt;HTML&lt;/a&gt;,
&lt;a class="reference external" href="http://doc.cat-v.org/bell_labs/why_pascal/"&gt;PDF&lt;/a&gt;) to see if those or
similar criticisms can still be applied to the Oberon family of
languages,
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon_(programming_language)"&gt;Oberon&lt;/a&gt;,
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon-2"&gt;Oberon-2&lt;/a&gt;, and &lt;a class="reference external" href="https://people.inf.ethz.ch/wirth/Oberon/index.html"&gt;Revised
Oberon&lt;/a&gt;. I found
Oberon-2 to be particularly inspiring, but feel that both Oberon and
Oberon-2 lack some of the practical aspects that made C such a
revelation to me back in the 1980s when I first encountered it, after
having programmed mostly in various BASICs, 6502 machine code, VAX
MACRO, and Pascal.&lt;/p&gt;
&lt;p&gt;So, here are Kernighan’s summary, nine criticisms, along with my
comments.&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;Since the size of an array is part of its type, it is not possible to
write general-purpose routines, that is, to deal with arrays of
different sizes. In particular, string handling is very difficult.&lt;/p&gt;
&lt;p&gt;This is still a problem in the original Oberon, but Oberon-2
introduced open arrays, which allows any size of array to be passed
to a procedure. While you can’t return arrays of arbitrary sizes from
a procedure, you can dynamically allocate any size array using
&lt;code class="docutils literal"&gt;POINTER TO ARRAY&lt;/code&gt; and &lt;code class="docutils literal"&gt;NEW&lt;/code&gt;, and return the pointer. Revised
Oberon adopted open arrays.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The lack of static variables, initialization and a way to communicate
non-hierarchically combine to destroy the “locality” of a program -
variables require much more scope than they ought to.&lt;/p&gt;
&lt;p&gt;This criticism still applies. None of the Oberon languages include
static variables or initialization.&lt;/p&gt;
&lt;p&gt;The lack of static variables is somewhat mitigated by the ability to
divide things up using modules, since the tendency is to create a
module for the shared variable and the procedures that depend on it,
but is still clumsy if the only thing you need is a static variable
in one procedure.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The one-pass nature of the language forces procedures and functions
to be presented in an unnatural order; the enforced separation of
various declarations scatters program components that logically
belong together.&lt;/p&gt;
&lt;p&gt;Oberon and Oberon-2 allow mixing &lt;code class="docutils literal"&gt;CONST&lt;/code&gt;, &lt;code class="docutils literal"&gt;TYPE&lt;/code&gt; and &lt;code class="docutils literal"&gt;VAR&lt;/code&gt;
declarations in any order and to appear multiple times, but still
requires procedure and forward procedure declarations to come after
all other declarations. In Revised Oberon &lt;code class="docutils literal"&gt;CONST&lt;/code&gt;, &lt;code class="docutils literal"&gt;TYPE&lt;/code&gt;, and
&lt;code class="docutils literal"&gt;VAR&lt;/code&gt; declarations must occur and in that order, followed by
procedure declarations, so the original criticism applies entirely
again.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The lack of separate compilation impedes the development of large
programs and makes the use of libraries impossible.&lt;/p&gt;
&lt;p&gt;Not a problem any more. All the Oberon languages use modules,
introduced in Modula. Arguably, this is much superior to C’s model of
separate compilation and using header files to ensure consistent
function declarations are consistent across files.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The order of logical expression evaluation cannot be controlled,
which leads to convoluted code and extraneous variables.&lt;/p&gt;
&lt;p&gt;This appears to not apply to the Oberon languages.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The ‘case’ statement is emasculated because there is no default
clause.&lt;/p&gt;
&lt;p&gt;Original Oberon and Oberon-2 both have &lt;code class="docutils literal"&gt;ELSE&lt;/code&gt; clauses for &lt;code class="docutils literal"&gt;CASE&lt;/code&gt;
statements. Revised Oberon does not.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The standard I/O is defective. There is no sensible provision for
dealing with files or program arguments as part of the standard
language, and no extension mechanism.&lt;/p&gt;
&lt;p&gt;IO in the Oberon family of languages is mostly defined by the
procedures provided in the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Oberon_(operating_system)"&gt;Oberon
System&lt;/a&gt;,
the operating system written in Oberon (and later in Oberon-2). It
has good facilities for dealing with files, considered by some to be
a better API than the familiar Unix/C API, for the functionality it
provides.&lt;/p&gt;
&lt;p&gt;None of the Oberon languages provide a standard method for access
to program arguments in the Unix/C style, as the Oberon System used
entirely different mechanisms.  Those Oberon[-2] implementations
I've used outside of the Oberon System all provided some access to
the program arguments, usually as a procedure returns the number of
program arguments and another that returns a specific argument, but
none of them used the same API.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The language lacks most of the tools needed for assembling large
programs, most notably file inclusion.&lt;/p&gt;
&lt;p&gt;The addition of separately compiled modules that provide a defined
interface mostly obviates this criticism and is superior to the
kludge of separate complication and include files provided by C.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There is no escape.&lt;/p&gt;
&lt;p&gt;All the Oberon languages include the module &lt;code class="docutils literal"&gt;SYSTEM&lt;/code&gt;, which
provides low level access to addresses of variables and to individual
bits of memory, along with bit manipulation of integers. Revised
Oberon adds access to sizes of types. Oberon and Oberon-2 provide a
&lt;code class="docutils literal"&gt;VAL&lt;/code&gt; function that allows interpreting a variable of one type as a
variable of another type. Revised Oberon does not.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;All the Oberon languages still have semicolon as separator instead of
semicolon as terminator.   I much prefer semicolon as terminator.&lt;/p&gt;
&lt;p&gt;All-in-all, I'm disappointed in Revised Oberon.  While I approve of a
few of its changes, most of them seem to be a definite step backward.
I think Wirth's minimalism does him a disservice here.&lt;/p&gt;&lt;/div&gt;</description><category>c</category><category>oberon</category><category>oberon system</category><category>oberon-2</category><category>pascal</category><category>revised oberon</category><category>unix</category><guid>https://tkurtbond.github.io/posts/2022/06/05/the-criticisms-of-pascal-in-why-pascal-is-not-my-favorite-programming-language-applied-to-oberon/</guid><pubDate>Sun, 05 Jun 2022 16:29:05 GMT</pubDate></item><item><title>Recording the books I read with org-mode and org-capture</title><link>https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;I used to record the books that I read on this &lt;a class="reference external" href="https://tkurtbond.github.io/categories/recent-reading/"&gt;blog&lt;/a&gt;, but that took
too much &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2010/07/21/reading-but-not-recording/"&gt;effort&lt;/a&gt;.  However, if I don't record the books I read, I
sometimes can't remember whether I read a particular book or not,
especially with Kindle Unlimited books.  (Was it the seventh book of
the series that I read last, or the eighth?)&lt;/p&gt;
&lt;p&gt;I record the books that I read in &lt;a class="reference external" href="https://www.gnu.org/software/emacs/"&gt;emacs&lt;/a&gt; using &lt;a class="reference external" href="https://orgmode.org/"&gt;org-mode&lt;/a&gt; and —
since today — &lt;a class="reference external" href="ttps://orgmode.org/manual/Capture.html"&gt;org-capture&lt;/a&gt;.  Here's what the org file looks like:&lt;/p&gt;
&lt;pre class="code text"&gt;&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-1"&gt;&lt;/a&gt;* 2022
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-2"&gt;&lt;/a&gt;** Read
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-3"&gt;&lt;/a&gt;*** : Title of Book I Haven't Finished Reading -- https://www.amazon.com/amazon-book-link-if-it-exists
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-4"&gt;&lt;/a&gt;...
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-5"&gt;&lt;/a&gt;*** 2022-05-21: Title of Book I **Have** Finished Reading -- https://www.amazon.com/amazon-book-link-if-it-exists
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-6"&gt;&lt;/a&gt;...
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-7"&gt;&lt;/a&gt;** Did not finish
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-8"&gt;&lt;/a&gt;*** : Title of Book I Won't Finish Reading -- https://www.amazon.com/amazon-book-link-if-it-exists
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-9"&gt;&lt;/a&gt;...
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-10"&gt;&lt;/a&gt;* 2021
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-11"&gt;&lt;/a&gt;* Previously read, sometime
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-12"&gt;&lt;/a&gt;** Title of Book I Finished Reading at some indeterminate date in the past -- https://www.amazon.com/amazon-book-link-if-it-exists
&lt;a name="rest_code_75886b99847c47fbbb0e8c4d5c0e8488-13"&gt;&lt;/a&gt;...
&lt;/pre&gt;&lt;p&gt;I keep the org file in a &lt;span class="app"&gt;git&lt;/span&gt; repository hosted online so I can
edit it on whatever computer is close at hand, or on my cell phone.
(Having a &lt;span class="app"&gt;git&lt;/span&gt; client with a simple editor on my phone is
wonderful!)&lt;/p&gt;
&lt;p&gt;When I start reading a book I create a new entry by selecting the
title and author of the book on its Amazon page, use the Chrome
extension Create Link to create a plain text link, which I then insert
into the org file at the right heading level and with a &lt;code class="docutils literal"&gt;:␢&lt;/code&gt; (a
colon followed by a blank space) after the asterisks of the heading
and before the link.  When I'm done with reading the book I put the
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/ISO_8601"&gt;ISO 8601&lt;/a&gt; date (&lt;em&gt;YYYY-MM-DD&lt;/em&gt;) before the colon.&lt;/p&gt;
&lt;p&gt;I wrote a script today to count how many books I've read so far this
year:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;#! /usr/bin/env bash&lt;/span&gt;
&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-3"&gt;&lt;/a&gt;&lt;span class="nv"&gt;YEAR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;date &lt;span class="s1"&gt;'+%Y'&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-4"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LAST_YEAR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$((&lt;/span&gt;YEAR &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="k"&gt;))&lt;/span&gt;
&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-6"&gt;&lt;/a&gt;sed -E -n &lt;span class="s2"&gt;"/^\* &lt;/span&gt;&lt;span class="nv"&gt;$YEAR&lt;/span&gt;&lt;span class="s2"&gt;/,/^(\*\* Did not finish|\* &lt;/span&gt;&lt;span class="nv"&gt;$LAST_YEAR&lt;/span&gt;&lt;span class="s2"&gt;)/p"&lt;/span&gt; &lt;span class="nv"&gt;$READ_FILE&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-7"&gt;&lt;/a&gt;    sed -e &lt;span class="s2"&gt;"/^* &lt;/span&gt;&lt;span class="nv"&gt;$YEAR&lt;/span&gt;&lt;span class="s2"&gt;/d"&lt;/span&gt; -e &lt;span class="s2"&gt;"/^** Read/d"&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-8"&gt;&lt;/a&gt;        -e &lt;span class="s2"&gt;"/^(\*\* Did not finish|\* &lt;/span&gt;&lt;span class="nv"&gt;$LAST_YEAR&lt;/span&gt;&lt;span class="s2"&gt;)/d"&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-9"&gt;&lt;/a&gt;    sed -E -n &lt;span class="s2"&gt;"/^\*\*\*[ \t]+[0-9]/p"&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_fcd9b35f8d504902875003ed5999fe64-10"&gt;&lt;/a&gt;    wc -l
&lt;/pre&gt;&lt;p&gt;This gets all the lines for this year, or just up to the ones that I did not finish, if there are any yet, then gets read of the leading&lt;/p&gt;
&lt;p&gt;This works pretty well.&lt;/p&gt;
&lt;p&gt;And so far I've read 227 books this year.&lt;/p&gt;
&lt;p&gt;And then I got to thinking: I could probably use &lt;a class="reference external" href="ttps://orgmode.org/manual/Capture.html"&gt;org-capture&lt;/a&gt; to
automate finding the file, finding the right place to insert the
information, and then copying the link from the clipboard and
inserting it along with the heading formation!&lt;/p&gt;
&lt;p&gt;Here's the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;org-capture-templates&lt;/span&gt;&lt;/code&gt; value I use for this:&lt;/p&gt;
&lt;pre class="code emacs-lisp"&gt;&lt;a name="rest_code_154927ed2efd43a687a92f23c37686bb-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;setq&lt;/span&gt; &lt;span class="nv"&gt;org-capture-templates&lt;/span&gt;
&lt;a name="rest_code_154927ed2efd43a687a92f23c37686bb-2"&gt;&lt;/a&gt;      &lt;span class="o"&gt;`&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s"&gt;"b"&lt;/span&gt; &lt;span class="s"&gt;"Add book about to read"&lt;/span&gt; &lt;span class="nv"&gt;entry&lt;/span&gt;
&lt;a name="rest_code_154927ed2efd43a687a92f23c37686bb-3"&gt;&lt;/a&gt;         &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;file+olp&lt;/span&gt; &lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;expand-file-name&lt;/span&gt; &lt;span class="s"&gt;"~/Repos/tkb-org/Books/read.org"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_154927ed2efd43a687a92f23c37686bb-4"&gt;&lt;/a&gt;                   &lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;format-time-string&lt;/span&gt; &lt;span class="s"&gt;"%Y"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="s"&gt;"Read"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_154927ed2efd43a687a92f23c37686bb-5"&gt;&lt;/a&gt;         &lt;span class="s"&gt;"*** : %c"&lt;/span&gt; &lt;span class="nb"&gt;:prepend&lt;/span&gt; &lt;span class="no"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;You'll want to read &lt;a class="reference external" href="https://orgmode.org/manual/Capture-templates.html"&gt;Capture templates&lt;/a&gt; to understand how this works.&lt;/p&gt;
&lt;p&gt;Of course, then I thought: what if my &lt;span class="app"&gt;emacs&lt;/span&gt; session lasts from
one year into the other, and I then add a new book?  It will have the
wrong year!&lt;/p&gt;
&lt;p&gt;And then I immediately thought of &lt;a class="reference external" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Advising-Functions.html"&gt;Advising Emacs Lisp Functions&lt;/a&gt;!
(I feel old — it was the &lt;code class="docutils literal"&gt;defadvice&lt;/code&gt; function when I started using
it.)&lt;/p&gt;
&lt;p&gt;So I added the following code:&lt;/p&gt;
&lt;pre class="code emacs-lisp"&gt;&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-1"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;defvar&lt;/span&gt; &lt;span class="nv"&gt;tkb-org-year&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;format-time-string&lt;/span&gt; &lt;span class="s"&gt;"%Y"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-2"&gt;&lt;/a&gt;    &lt;span class="s"&gt;"The year the current emacs session was started, for use with org-capture."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-3"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt; &lt;span class="nv"&gt;tkb-org-capture-advice-update-year&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;&amp;amp;optional&lt;/span&gt; &lt;span class="nv"&gt;goto&lt;/span&gt; &lt;span class="nv"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-4"&gt;&lt;/a&gt;    &lt;span class="s"&gt;"Update ‘tkb-org-year’ and update the entry for adding a book in&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-5"&gt;&lt;/a&gt;&lt;span class="s"&gt;‘org-capture-templates’ to use the new value."&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-6"&gt;&lt;/a&gt;    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nv"&gt;new-year&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;format-time-string&lt;/span&gt; &lt;span class="s"&gt;"%Y"&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-7"&gt;&lt;/a&gt;      &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;unless&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;string-equal&lt;/span&gt; &lt;span class="nv"&gt;tkb-org-year&lt;/span&gt; &lt;span class="nv"&gt;new-year&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-8"&gt;&lt;/a&gt;        &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;setf&lt;/span&gt; &lt;span class="nv"&gt;tkb-org-year&lt;/span&gt; &lt;span class="nv"&gt;new-year&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-9"&gt;&lt;/a&gt;        &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;setf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;--&amp;gt;&lt;/span&gt; &lt;span class="s"&gt;"b"&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;assoc&lt;/span&gt; &lt;span class="nv"&gt;it&lt;/span&gt; &lt;span class="nv"&gt;org-capture-templates&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-10"&gt;&lt;/a&gt;                   &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;assoc&lt;/span&gt; &lt;span class="ss"&gt;'file+olp&lt;/span&gt; &lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;nth&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-11"&gt;&lt;/a&gt;              &lt;span class="nv"&gt;tkb-org-year&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;a name="rest_code_55226bc3bd9e4951bf5ecf8519330f9a-12"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;advice-add&lt;/span&gt; &lt;span class="ss"&gt;'org-capture&lt;/span&gt; &lt;span class="nb"&gt;:before&lt;/span&gt; &lt;span class="nf"&gt;#'&lt;/span&gt;&lt;span class="nv"&gt;tkb-org-capture-advice-update-year&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;I tested this by manually setting &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;tkb-org-year&lt;/span&gt;&lt;/code&gt; to &lt;code class="docutils literal"&gt;"2021"&lt;/code&gt; and
capturing a new book.  It worked fine!&lt;/p&gt;&lt;/div&gt;</description><category>advice-add</category><category>defadvice</category><category>emacs</category><category>emacs advice</category><category>org-capture</category><category>org-mode</category><category>reading</category><guid>https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/</guid><pubDate>Sat, 21 May 2022 11:17:18 GMT</pubDate></item><item><title>POISE DMS-PLus, a Description</title><link>https://tkurtbond.github.io/posts/2022/02/22/poise-dms-plus-a-description/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;Some time ago I &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2014/11/23/poise-dms-plus/"&gt;linked&lt;/a&gt; to a description of the POISE DMS-Plus, a Data
Management System that I've used extensively since the mid 1980s.
Last time I knew it was owned by Jenzabar.  Since Jenzabar's
description of it (as part of Jenzabar PX) has vanished from their web
pages I thought it would be useful to have a description of it on my
blog.&lt;/p&gt;
&lt;p&gt;I'll include &lt;a class="reference external" href="https://web.archive.org/web/20060313120910/http://www2.esp-tulsa.com/products.htm#dmsplus"&gt;Jenzabar's description&lt;/a&gt; of the POISE DMS-Plus here:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;DMS-Plus&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Each Jenzabar PX Administrative application module is built on
Jenzabar PX DMS-Plus®, a relational database management system (RDBMS)
using fourth-generation (4GL) language. DMS-Plus includes a powerful
report-writer, an information-retrieval system using multiple keys,
screen generation, and has multiple user levels: the operator,
intermediate user, advanced user, and application developers. It also
includes an Administrative Systems Query (ASQ or ask) language that is
designed to make the software easier to use for administrative
personnel. ASQ permits users to select, order, display, and print
information through simple English-like commands. In addition to ASQ,
another option for queries and reporting is QBF (Query By Form), a
point and select method which leads users through the data files and
query options.&lt;/p&gt;
&lt;p&gt;The benefits of a DMS-Plus approach to administrative processing
include ease of use by nontechnical personnel, a greater flexibility,
and speed and simplicity when implementing changes. It includes a
powerful data management and information retrieval facility with
right-to-use source code available. DMS-Plus includes list processing
as well as interfaces to stand-alone word processing systems. Future
enhancement to DMS-Plus are provided as part of the ongoing
subscription services. DMS-Plus is the common language for all types
of users.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;DMS-Plus Highlights&lt;/em&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;DMS-Plus provides Report Generators for easy sorting, selecting, and
printing along with Screen Generators for easy data entry, update,
and review.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DMS-Plus utilizes data manipulation for inserting, updating and
deleting data in the database. In addition to data definition for
adding new elements to the database, data control is also available
for accessing data by persons who have been granted access.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DMS-Plus has a menu processor, import/export capability via ASCII
file formats, a WordPerfect interface, and SQL compliant.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DMS-Plus is a user-oriented system that operates in a multi-user
environment. Simple English-like language prompts and responses are
used to interact with the system. By utilizing the flexibility of
DMS-Plus, each user office can determine the information collected,
can regulate work flow, can set its own schedules for updating
files, and can produce its own reports without depending on
Information System services.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DMS-Plus supports multi-user access. These application systems use
many of the same functions and techniques that provide continuity
across user departments and also allows cross-utilization of
personnel.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Many applications for information management needs may be
implemented through the software provided with little or no
additional programming.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DMS-Plus provides an integrated base of information for
administrative data processing. Information introduced into the
system may be carried forward into all appropriate areas without
redundant entry.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;While the above describes the POISE DMS-Plus as a “relational database
management system”, it isn't really.  It does not use a relational
database.  It comes from the time &lt;strong&gt;before&lt;/strong&gt; relational databases.&lt;/p&gt;
&lt;p&gt;To me, a database is a program that controls access to a collection of
data - you can’t get to the data without asking the database program
for it.&lt;/p&gt;
&lt;p&gt;A data management system (the DMS in DMS-Plus) just lets you associate
related data together, and then multiple programs can access the
pieces, usually using a standard API implemented as a library.&lt;/p&gt;
&lt;p&gt;Before the advent of Unix, files were often much more complicated that
just a stream of bytes.  For instance, under VMS (where I've used the
POISE DMS-Plus the most) the &lt;em&gt;Record Management Services&lt;/em&gt; (RMS)
provides sequential, relative, and indexed file organization, and
fixed-length and variable-length record formats, and allows you to
access records within these files sequentially, directly by key value,
directly by relative record number, or directly by record file
address.  It was common practice for programs to each use their own
specific mix of these aspects of RMS, with the details directly coded
into the program.&lt;/p&gt;
&lt;p&gt;The advantage of the POISE DMS-Plus is it provided a suite of programs
that worked together, allowing users to describe the format of the
files they wanted, enter and modify data in those files, sort and
select data, and produce nicely formatted reports, without having to
write any code.  The programs were interactive, issuing a series of
prompts to the user for what they needed to do next, and were very
easy to learn.  If a secretary wanted to keep track of the inventory
of their office, they would run &lt;span class="command"&gt;DMS:DESCRIBE&lt;/span&gt; to describe
the fields they wanted and allocate space for the file, then run
&lt;span class="command"&gt;DMS:ADD&lt;/span&gt; to add data, &lt;span class="command"&gt;DMS:SEARCH&lt;/span&gt; to search and
update it, &lt;span class="command"&gt;DMS:SORT&lt;/span&gt; to sort and select data, and
&lt;span class="command"&gt;DMS:PRINT&lt;/span&gt; to produce a nicely formatted report.  If they
had to do a lot of data entry into the file, or it was large or
complicated, they could run &lt;span class="command"&gt;DMS:SCREEN&lt;/span&gt; to define a text
user interface screen format for interactive user input, arranging the
fields or subsets of the fields on the screen to make data entry easy,
and then run &lt;span class="command"&gt;DMS:SCOPE&lt;/span&gt; using that screen format to do data
entry.  (I keep wishing for something as easy to use as
&lt;span class="command"&gt;DMS:SCREEN&lt;/span&gt; in the area of database backed web applications,
but haven't found it yet.)&lt;/p&gt;
&lt;p&gt;POISE DMS-Plus files &lt;em&gt;were&lt;/em&gt; relational in that it was possible for
fields in one file to refer to values in fields in another file,
similar to SQL &lt;code class="docutils literal"&gt;JOIN&lt;/code&gt;s and &lt;code class="docutils literal"&gt;FOREIGN KEY&lt;/code&gt; constraints.  So, for
instance, it was possible to have a code field in one file, but on
reports include the description of the code by pulling it from a code
file, keyed by the code field.&lt;/p&gt;
&lt;p&gt;All the POISE DMS-Plus programs used a documented API, the Support
Procedure Library, which programmers could use to write programs that
accessed POISE DMS-Plus files for applications that required
sophisticated, special purpose processing.  Furthermore, they
documented the file structures they used, so it was possible to write
programs that accessed DMS-Plus files directly, if necessary.&lt;/p&gt;
&lt;p&gt;POISE, by the way, stood for “People Oriented Interactive Software for
Education”, and it probably had its greatest success in systems for
education administration, but it was a general purpose tool and I have
worked on projects using it for many other areas, including local and
state government, real estate sales management, oil and gas royalty
management, and many others.&lt;/p&gt;&lt;/div&gt;</description><category>dms-plus</category><category>jenzabar px</category><category>openvms</category><category>poise</category><category>vms</category><guid>https://tkurtbond.github.io/posts/2022/02/22/poise-dms-plus-a-description/</guid><pubDate>Tue, 22 Feb 2022 14:49:38 GMT</pubDate></item><item><title>Redimensioning formal parameter arrays in OpenVMS BASIC, Revisited</title><link>https://tkurtbond.github.io/posts/2022/02/05/redimensioning-formal-parameter-arrays-in-openvms-basic-revisited/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;I was working on a program on a VAX today, and needed to redimension
dynamically allocated arrays that are passed to an external function.
I've done this in the past (an &lt;a class="reference external" href="https://groups.google.com/g/comp.os.vms/c/mVWznNVN17U/m/HE3L4N4nIJAJ"&gt;old USENET post&lt;/a&gt;, and the &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2003/05/08/2003-05-08-vms-code-from-the-past/"&gt;old blog
post&lt;/a&gt; that mentions it), but this time I managed to simplify my
solution, and generalize it to work with both lower and upper bounds,
and so the same function would work with multiple VMS BASIC data
types.  Here's the &lt;a class="reference external" href="https://groups.google.com/g/comp.os.vms/c/mVWznNVN17U/m/yuOAmQtQBAAJ"&gt;new USENET post&lt;/a&gt;.  (How's that for thread
necromancy?)&lt;/p&gt;
&lt;p&gt;I'll include the code in this blog post, too, for ease of reference.
Here's &lt;span class="file"&gt;vax_redim_best.bas&lt;/span&gt;:&lt;/p&gt;
&lt;pre class="code text"&gt;&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-1"&gt;&lt;/a&gt;program vax_redim_best
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-2"&gt;&lt;/a&gt;    option type = explicit, constant type = integer, &amp;amp;
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-3"&gt;&lt;/a&gt;        size = integer long, size = real double
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-4"&gt;&lt;/a&gt;    record rec
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-5"&gt;&lt;/a&gt;        string s = 13
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-6"&gt;&lt;/a&gt;        long   i
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-7"&gt;&lt;/a&gt;    end record rec
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-9"&gt;&lt;/a&gt;    ! Don't declare the parameters, and everything works, even passing
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-10"&gt;&lt;/a&gt;    ! different types.
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-11"&gt;&lt;/a&gt;    external sub redim
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-13"&gt;&lt;/a&gt;    declare long stat, i
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-14"&gt;&lt;/a&gt;    i = 1
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-15"&gt;&lt;/a&gt;    dim rec rec(1 to i)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-16"&gt;&lt;/a&gt;    print "lbound (rec) at start: "; lbound (rec)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-17"&gt;&lt;/a&gt;    print "ubound (rec) at start: "; ubound (rec)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-18"&gt;&lt;/a&gt;    call redim (rec(), 3, 10)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-19"&gt;&lt;/a&gt;    print "lbound (rec) after redim: "; lbound (rec)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-20"&gt;&lt;/a&gt;    print "ubound (rec) after redim: "; ubound (rec)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-21"&gt;&lt;/a&gt;
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-22"&gt;&lt;/a&gt;    dim string s(1 to i)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-23"&gt;&lt;/a&gt;    print "lbound (s) at start: "; lbound (s)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-24"&gt;&lt;/a&gt;    print "ubound (s) at start: "; ubound (s)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-25"&gt;&lt;/a&gt;    call redim (s(), 3, 10)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-26"&gt;&lt;/a&gt;    print "lbound (s) after redim: "; lbound (s)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-27"&gt;&lt;/a&gt;    print "ubound (s) after redim: "; ubound (s)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-28"&gt;&lt;/a&gt;
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-29"&gt;&lt;/a&gt;    dim long l(1 to i)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-30"&gt;&lt;/a&gt;    print "lbound (l) at start: "; lbound (l)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-31"&gt;&lt;/a&gt;    print "ubound (l) at start: "; ubound (l)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-32"&gt;&lt;/a&gt;    call redim (l(), 3, 10)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-33"&gt;&lt;/a&gt;    print "lbound (l) after redim: "; lbound (l)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-34"&gt;&lt;/a&gt;    print "ubound (l) after redim: "; ubound (l)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-35"&gt;&lt;/a&gt;
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-36"&gt;&lt;/a&gt;
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-37"&gt;&lt;/a&gt;end program ! vax_redim_best
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-38"&gt;&lt;/a&gt;
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-39"&gt;&lt;/a&gt;function long redim (long s, long low, long high)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-40"&gt;&lt;/a&gt;    option type = explicit, constant type = integer, &amp;amp;
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-41"&gt;&lt;/a&gt;        size = integer long, size = real double
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-42"&gt;&lt;/a&gt;    external long function bas$rt_dim_bounds (long by value, long by value, long by value)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-43"&gt;&lt;/a&gt;    declare long r
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-44"&gt;&lt;/a&gt;    r = bas$rt_dim_bounds (loc (s), low, high)
&lt;a name="rest_code_fe2a242171a54440b9680b2ad5688461-45"&gt;&lt;/a&gt;end function r ! redim
&lt;/pre&gt;&lt;p&gt;I'll just point out, which I failed to do in the &lt;a class="reference external" href="https://groups.google.com/g/comp.os.vms/c/mVWznNVN17U/m/HE3L4N4nIJAJ"&gt;old USENET post&lt;/a&gt; or
the &lt;a class="reference external" href="https://groups.google.com/g/comp.os.vms/c/mVWznNVN17U/m/yuOAmQtQBAAJ"&gt;new USENET post&lt;/a&gt;, that you have to use a &lt;strong&gt;variable&lt;/strong&gt; when using
the VMS BASIC &lt;code class="docutils literal"&gt;dim&lt;/code&gt; statement or you get a fatal runtime error.  Ooops.&lt;/p&gt;
&lt;p&gt;So use:&lt;/p&gt;
&lt;pre class="code text"&gt;&lt;a name="rest_code_57b1896242a243a0b7226d5acce0209c-1"&gt;&lt;/a&gt;declare long i
&lt;a name="rest_code_57b1896242a243a0b7226d5acce0209c-2"&gt;&lt;/a&gt;i = 5
&lt;a name="rest_code_57b1896242a243a0b7226d5acce0209c-3"&gt;&lt;/a&gt;dim string s(1 to i) ! Notice that last thing is the variable, i
&lt;a name="rest_code_57b1896242a243a0b7226d5acce0209c-4"&gt;&lt;/a&gt;redim (s, 3, 10)
&lt;/pre&gt;&lt;p&gt;If you had said:&lt;/p&gt;
&lt;pre class="code text"&gt;&lt;a name="rest_code_d42051b1982a4d6ca5e876dcf280a30a-1"&gt;&lt;/a&gt;dim string s(1 to 5) ! Notice that last thing is a constant, 5
&lt;a name="rest_code_d42051b1982a4d6ca5e876dcf280a30a-2"&gt;&lt;/a&gt;redim (s, 3, 10)
&lt;/pre&gt;&lt;p&gt;You'd have gotten the following error:&lt;/p&gt;
&lt;pre class="code text"&gt;&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-1"&gt;&lt;/a&gt;%BAS-F-PROLOSSOR, Internal error in VAX BASIC Run-Time Library.  Please submit an SPR
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-2"&gt;&lt;/a&gt;-BAS-I-FROFUN, In external function ALT_REDIM
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-3"&gt;&lt;/a&gt;-BAS-I-FROMOD, In module Y
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-4"&gt;&lt;/a&gt;%TRACE-F-TRACEBACK, symbolic stack dump follows
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-5"&gt;&lt;/a&gt;module name     routine name                     line       rel PC    abs PC
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-7"&gt;&lt;/a&gt;                                                           0004B2AA  0004B2AA
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-8"&gt;&lt;/a&gt;----- above condition handler called with exception 001A833C:
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-9"&gt;&lt;/a&gt;%BAS-F-PROLOSSOR, Internal error in VAX BASIC Run-Time Library.  Please submit an SPR
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-10"&gt;&lt;/a&gt;-BAS-I-FROFUN, In external function ALT_REDIM
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-11"&gt;&lt;/a&gt;----- end of exception message
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-12"&gt;&lt;/a&gt;                                                           0004B2AA  0004B2AA
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-13"&gt;&lt;/a&gt;----- above condition handler called with exception 001A833C:
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-14"&gt;&lt;/a&gt;%BAS-F-PROLOSSOR, Internal error in VAX BASIC Run-Time Library.  Please submit an SPR
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-15"&gt;&lt;/a&gt;----- end of exception message
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-16"&gt;&lt;/a&gt;                                                           0004A352  0004A352
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-17"&gt;&lt;/a&gt;                                                           00054E37  00054E37
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-18"&gt;&lt;/a&gt;ALT_REDIM       ALT_REDIM                          43      0000002E  00000AC2
&lt;a name="rest_code_b6aad6d7f4c84129945145afac5f6327-19"&gt;&lt;/a&gt;Y               Y                                  24      0000015D  0000095D
&lt;/pre&gt;&lt;p&gt;Don't actually submit an SPR, of course: you did it to yourself by
using an undocumented VMS BASIC internal runtime function.&lt;/p&gt;
&lt;p&gt;Oh, I don't have access to an Alpha these days, so I haven't tried it
there, but I imagine using something named &lt;code class="docutils literal"&gt;DBASIC$RT_DIM_BOUNDS&lt;/code&gt;
instead of &lt;code class="docutils literal"&gt;DBASIC$RT_DIM&lt;/code&gt; would likely work there.&lt;/p&gt;&lt;/div&gt;</description><category>alpha</category><category>basic</category><category>hacks</category><category>usenet</category><category>vax</category><category>vms</category><guid>https://tkurtbond.github.io/posts/2022/02/05/redimensioning-formal-parameter-arrays-in-openvms-basic-revisited/</guid><pubDate>Sat, 05 Feb 2022 21:08:22 GMT</pubDate></item><item><title>Getting the homebrew CHICKEN Scheme sqlite3 egg to use the homebrew-installed sqlite3 include files and library files</title><link>https://tkurtbond.github.io/posts/2021/09/13/getting-the-homebrew-chicken-scheme-sqlite3-egg-to-use-the-homebrew-installed-sqlite3-include-files-and-library-files/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;To get the &lt;a class="reference external" href="https://brew.sh/"&gt;Homebrew&lt;/a&gt; installed &lt;a class="reference external" href="http://call-cc.org"&gt;CHICKEN Scheme&lt;/a&gt; (&lt;a class="reference external" href="https://formulae.brew.sh/formula/chicken"&gt;HBCHICKEN&lt;/a&gt;) to use
the &lt;a class="reference external" href="https://brew.sh/"&gt;Homebrew&lt;/a&gt; installed version of &lt;a class="reference external" href="https://www.sqlite.org/"&gt;sqlite3&lt;/a&gt; (&lt;a class="reference external" href="https://formulae.brew.sh/formula/sqlite"&gt;HBSQLITE3&lt;/a&gt;) — because the
one supplied by Apple in macOS is obsolete — for the &lt;a class="reference external" href="http://wiki.call-cc.org/eggref/5/sqlite3"&gt;sqlite egg&lt;/a&gt;,
you need to set &lt;code class="docutils literal"&gt;CSC_OPTIONS&lt;/code&gt; properly:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_cd7d55dbc96f430c9ef9e82b98731374-1"&gt;&lt;/a&gt;$ &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;CSC_OPTIONS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"-I/usr/local/Cellar/sqlite/3.36.0/include -L/usr/local/Cellar/sqlite/3.36.0/lib"&lt;/span&gt;
&lt;a name="rest_code_cd7d55dbc96f430c9ef9e82b98731374-2"&gt;&lt;/a&gt;$ chicken-install sqlite3
&lt;a name="rest_code_cd7d55dbc96f430c9ef9e82b98731374-3"&gt;&lt;/a&gt;building sqlite3
&lt;a name="rest_code_cd7d55dbc96f430c9ef9e82b98731374-4"&gt;&lt;/a&gt;   /usr/local/Cellar/chicken/5.2.0/bin/csc -host -D compiling-extension -J -s -regenerate-import-libraries -setup-mode -I /Users/tkb/.cache/chicken-install/sqlite3 -C -I/Users/tkb/.cache/chicken-install/sqlite3 -O2 -d1 -L -lsqlite3 sqlite3.scm -o /Users/tkb/.cache/chicken-install/sqlite3/sqlite3.so
&lt;a name="rest_code_cd7d55dbc96f430c9ef9e82b98731374-5"&gt;&lt;/a&gt;   /usr/local/Cellar/chicken/5.2.0/bin/csc -regenerate-import-libraries -M -setup-mode -static -I /Users/tkb/.cache/chicken-install/sqlite3 -emit-link-file /Users/tkb/.cache/chicken-install/sqlite3/sqlite3.link -host -D compiling-extension -c -unit sqlite3 -D compiling-static-extension -C -I/Users/tkb/.cache/chicken-install/sqlite3 -O2 -d1 sqlite3.scm -o /Users/tkb/.cache/chicken-install/sqlite3/sqlite3.static.o
&lt;a name="rest_code_cd7d55dbc96f430c9ef9e82b98731374-6"&gt;&lt;/a&gt;   /usr/local/Cellar/chicken/5.2.0/bin/csc -setup-mode -s -host -I /Users/tkb/.cache/chicken-install/sqlite3 -C -I/Users/tkb/.cache/chicken-install/sqlite3 -O2 -d0 -L -lsqlite3 sqlite3.import.scm -o /Users/tkb/.cache/chicken-install/sqlite3/sqlite3.import.so
&lt;a name="rest_code_cd7d55dbc96f430c9ef9e82b98731374-7"&gt;&lt;/a&gt;installing sqlite3
&lt;/pre&gt;&lt;p&gt;You'll probably need to adjust the version numbers in the pathnames
for whatever version is installed on your computer.&lt;/p&gt;&lt;/div&gt;</description><category>chicken scheme</category><category>chicken-install</category><category>csc</category><category>scheme</category><guid>https://tkurtbond.github.io/posts/2021/09/13/getting-the-homebrew-chicken-scheme-sqlite3-egg-to-use-the-homebrew-installed-sqlite3-include-files-and-library-files/</guid><pubDate>Mon, 13 Sep 2021 20:59:50 GMT</pubDate></item><item><title>define-word results using wordnik stopped working</title><link>https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;I use &lt;a class="reference external" href="https://github.com/abo-abo/define-word"&gt;define-word&lt;/a&gt;, a package from melpa (&lt;a class="reference external" href="https://melpa.org/#/define-word"&gt;DWM&lt;/a&gt;), that looks up the
definition of a word online.  It uses &lt;a class="reference external" href="http://wordnik.com/"&gt;wordnik.com&lt;/a&gt; by default.
Recently it stopped returning definitions.&lt;/p&gt;
&lt;p&gt;I did a little digging, and it turns out that it works when
you visit the url with Chrome, but not if you just try to download it
with curl, or &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;url-retrieve&lt;/span&gt;&lt;/code&gt; in Emacs. Adding a
“&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;User-Agent:&lt;/span&gt; Mozilla/5.0 (Macintosh; Intel Mac OS X 11_5_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36&lt;/code&gt;”
with curl’s -H option made it work.&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_8e021d4077de40a491236cc3473877c7-1"&gt;&lt;/a&gt;curl -i -H &lt;span class="s1"&gt;'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_5_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36'&lt;/span&gt; http://wordnik.com/words/importunate
&lt;/pre&gt;&lt;p&gt;So I added a &lt;code class="docutils literal"&gt;let&lt;/code&gt; in my advice for &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;define-word&lt;/span&gt;&lt;/code&gt; that binds
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;url-request-extra-headers&lt;/span&gt;&lt;/code&gt; to an alist with &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;"User-Agent"&lt;/span&gt;&lt;/code&gt; as the
key and &lt;code class="docutils literal"&gt;"Mozilla/5.0 (Macintosh; Intel Mac OS X 11_5_2)
AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63
Safari/537.36"&lt;/code&gt; as the value, and it works again.&lt;/p&gt;
&lt;p&gt;My solution looks something like this (simplified from my actual advice,
which does other things too):&lt;/p&gt;
&lt;pre class="code emacs-lisp"&gt;&lt;a name="rest_code_59b1eba96d3e495aa9d2b645073b3bda-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defadvice&lt;/span&gt; &lt;span class="nv"&gt;define-word&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;around&lt;/span&gt; &lt;span class="nv"&gt;your-around-define-word&lt;/span&gt; &lt;span class="nv"&gt;activate&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_59b1eba96d3e495aa9d2b645073b3bda-2"&gt;&lt;/a&gt;  &lt;span class="s"&gt;"Dynamically bind tkb-define-word-word to the word passed in."&lt;/span&gt;
&lt;a name="rest_code_59b1eba96d3e495aa9d2b645073b3bda-3"&gt;&lt;/a&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nv"&gt;url-request-extra-headers&lt;/span&gt;
&lt;a name="rest_code_59b1eba96d3e495aa9d2b645073b3bda-4"&gt;&lt;/a&gt;         &lt;span class="o"&gt;'&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s"&gt;"User-Agent"&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="s"&gt;"Mozilla/5.0 (Macintosh; Intel Mac OS X 11_5_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36"&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;a name="rest_code_59b1eba96d3e495aa9d2b645073b3bda-5"&gt;&lt;/a&gt;    &lt;span class="nv"&gt;ad-do-it&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;I opened an &lt;a class="reference external" href="https://github.com/abo-abo/define-word/issues/31"&gt;issue&lt;/a&gt; on github, suggesting it might be a good idea to
add a simpler way to add a &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;User-Agent:&lt;/span&gt;&lt;/code&gt; header around
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;define-word--to-string&lt;/span&gt;&lt;/code&gt;’s call to &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;url-retrieve-synchronously&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;</description><category>define-word</category><category>emacs</category><category>wordnik</category><guid>https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/</guid><pubDate>Mon, 13 Sep 2021 19:48:30 GMT</pubDate></item><item><title>Gitub repo for Arrow Macros for Emacs</title><link>https://tkurtbond.github.io/posts/2021/09/07/gitub-repo-for-arrow-macros-for-emacs/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;p&gt;I've added a &lt;a class="reference external" href="https://github.com/tkurtbond/arrow-macros-for-emacs"&gt;Github repository&lt;/a&gt; for my port of &lt;a class="reference external" href="https://github.com/nightfly19/cl-arrows"&gt;CL-Arrows&lt;/a&gt; to
Emacs Lisp (&lt;a class="reference external" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/"&gt;original post&lt;/a&gt;), at the insistence of CPB.&lt;/p&gt;</description><category>arrow macros</category><category>clojure</category><category>common lisp</category><category>emacs</category><category>emacs lisp</category><guid>https://tkurtbond.github.io/posts/2021/09/07/gitub-repo-for-arrow-macros-for-emacs/</guid><pubDate>Tue, 07 Sep 2021 16:07:48 GMT</pubDate></item><item><title>Sorting differs between LANG=C and LANG=en_US.UTF-8, even in ls</title><link>https://tkurtbond.github.io/posts/2021/07/28/sorting-differs-between-langc-and-langen_usutf-8-even-in-ls/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;This is here mostly to give me a concrete example of this happening.&lt;/p&gt;
&lt;p&gt;I have a directory, with two files in it, &lt;span class="file"&gt;ab.txt&lt;/span&gt; and
&lt;span class="file"&gt;a-c.txt&lt;/span&gt;.  Which sorts first when I do a &lt;span class="command"&gt;ls&lt;/span&gt;?  It
depends on what locale is set.  Like this:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_f13f70d55e524ee19f1799175652ebca-1"&gt;&lt;/a&gt;$ &lt;span class="nv"&gt;LANG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;en_US.UTF-8 ls
&lt;a name="rest_code_f13f70d55e524ee19f1799175652ebca-2"&gt;&lt;/a&gt;ab.txt       a-c.txt
&lt;a name="rest_code_f13f70d55e524ee19f1799175652ebca-3"&gt;&lt;/a&gt;$ &lt;span class="nv"&gt;LANG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;C ls
&lt;a name="rest_code_f13f70d55e524ee19f1799175652ebca-4"&gt;&lt;/a&gt;a-c.txt  ab.txt
&lt;/pre&gt;&lt;p&gt;Same thing happens with the &lt;span class="command"&gt;sort&lt;/span&gt; command:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-1"&gt;&lt;/a&gt;$ cat &amp;gt;a-c-first.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-2"&gt;&lt;/a&gt;a-c.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-3"&gt;&lt;/a&gt;ab.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-4"&gt;&lt;/a&gt;$ cat &amp;gt;ab-first.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-5"&gt;&lt;/a&gt;ab.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-6"&gt;&lt;/a&gt;a-c.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-7"&gt;&lt;/a&gt;$ &lt;span class="nv"&gt;LANG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;C sort ab-first.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-8"&gt;&lt;/a&gt;a-c.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-9"&gt;&lt;/a&gt;ab.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-10"&gt;&lt;/a&gt;$ &lt;span class="nv"&gt;LANG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;en_US.UTF-8 sort a-c-first.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-11"&gt;&lt;/a&gt;ab.txt
&lt;a name="rest_code_6e65117ca6494d2cae9f87f7ac82cefd-12"&gt;&lt;/a&gt;a-c.txt
&lt;/pre&gt;&lt;p&gt;I found this surprising when it first broke some code I was using,
since I'd spent so much of my existence in LANG=C (I'm still surprised
that Unicode has existed for more than half my life), but once I set
LANG=en_US.UTF-8 because I was using UTF-8 characters in my documents
I found I was in a different (sorting) world.&lt;/p&gt;&lt;/div&gt;</description><category>LANG=C</category><category>LANG=en_US.UTF-8</category><category>sort</category><category>sorting</category><guid>https://tkurtbond.github.io/posts/2021/07/28/sorting-differs-between-langc-and-langen_usutf-8-even-in-ls/</guid><pubDate>Wed, 28 Jul 2021 09:05:50 GMT</pubDate></item></channel></rss>