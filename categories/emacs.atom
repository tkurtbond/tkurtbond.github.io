<?xml version='1.0' encoding='UTF-8'?>
<?xml-stylesheet href="https://tkurtbond.github.io/assets/xml/atom.xsl" type="text/xsl media="all"?>
<feed xml:lang="en" xmlns="http://www.w3.org/2005/Atom">
  <title>Lacking Natural Simplicity (Posts about emacs)</title>
  <id>https://tkurtbond.github.io/categories/emacs.atom</id>
  <updated>2024-01-21T16:45:38Z</updated>
  <author>
    <name>T. Kurt Bond</name>
  </author>
  <link rel="self" type="application/atom+xml" href="https://tkurtbond.github.io/categories/emacs.atom"/>
  <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/categories/emacs/"/>
  <generator uri="https://getnikola.com/">Nikola</generator>
  <entry>
    <title>Maintaining the old ada-mode.el formerly distributed with Emacs</title>
    <id>https://tkurtbond.github.io/posts/2022/12/06/maintaining-the-old-ada-modeel-formerly-distributed-with-emacs/</id>
    <updated>2022-12-06T13:28:59-05:00</updated>
    <published>2022-12-06T13:28:59-05:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2022/12/06/maintaining-the-old-ada-modeel-formerly-distributed-with-emacs/"/>
    <summary type="html">&lt;p&gt;I wrote a &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2022/07/09/using-the-old-version-of-ada-mode-for-emacs/"&gt;post&lt;/a&gt; about using the old ada-mode.el that used to be
distributed with &lt;span class="app"&gt;Emacs&lt;/span&gt; because I couldn't get the newer,
separate package &lt;a class="reference external" href="https://www.gnu.org/software/emacs/manual/html_mono/ada-mode.html"&gt;version&lt;/a&gt; to work for me.&lt;/p&gt;
&lt;p&gt;Well, this morning when I pulled up an Ada file in &lt;span class="app"&gt;Emacs&lt;/span&gt; version
28 there were two problems:&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;The information to invoke ada-mode on Ada files was not in the
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;auto-mode-alist&lt;/span&gt;&lt;/code&gt; variable in &lt;span class="app"&gt;Emacs&lt;/span&gt;.  That was easy
enough to fix: add &lt;span class="file"&gt;.ada&lt;/span&gt;, &lt;span class="file"&gt;.ads&lt;/span&gt;, and &lt;span class="file"&gt;.adb&lt;/span&gt; to
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;auto-mode-alist&lt;/span&gt;&lt;/code&gt; (and &lt;span class="file"&gt;.gpr&lt;/span&gt;, too, since Ada mode works
for &lt;span class="app"&gt;gprbuild&lt;/span&gt; files as well):&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code emacs-lisp"&gt;&lt;a id="rest_code_7a32069564de4463a2c98549fb86db4a-1" name="rest_code_7a32069564de4463a2c98549fb86db4a-1" href="https://tkurtbond.github.io/posts/2022/12/06/maintaining-the-old-ada-modeel-formerly-distributed-with-emacs/#rest_code_7a32069564de4463a2c98549fb86db4a-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;cl-loop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;ext&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;'&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"\\.gpr$"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"\\.ada$"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"\\.ads$"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"\\.adb$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7a32069564de4463a2c98549fb86db4a-2" name="rest_code_7a32069564de4463a2c98549fb86db4a-2" href="https://tkurtbond.github.io/posts/2022/12/06/maintaining-the-old-ada-modeel-formerly-distributed-with-emacs/#rest_code_7a32069564de4463a2c98549fb86db4a-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nb"&gt;do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;add-to-list&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;'auto-mode-alist&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;cons&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;ext&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;'ada-mode&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;That was easy enough.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;When I tried to do any indentation &lt;span class="cmd"&gt;emacs&lt;/span&gt; reported an error,
with the error message “End position is smaller than start
position”.  Eventually I tracked this down to a call to
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;parse-partial-sexp&lt;/span&gt;&lt;/code&gt; in &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;ada-in-open-paren-p&lt;/span&gt;&lt;/code&gt;.  It turns out
that somewhere after &lt;span class="app"&gt;Emacs&lt;/span&gt; version 27.2 was released the
&lt;span class="app"&gt;Emacs&lt;/span&gt; developers added a check to &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;parse-partial-sexp&lt;/span&gt;&lt;/code&gt; to
ensure that the &lt;code class="docutils literal"&gt;FROM&lt;/code&gt; argument (which indicates where in the
buffer to start parsing) was less than the &lt;code class="docutils literal"&gt;TO&lt;/code&gt; argument (which
indicates where in the buffer to &lt;strong&gt;stop&lt;/strong&gt; parsing).&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Drat.  Drat.  Drat.  Well, looking at the code it was clear that
since &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;ada-in-open-paren-p&lt;/span&gt;&lt;/code&gt; is explicitly searching backwards
that &lt;code class="docutils literal"&gt;TO&lt;/code&gt; would &lt;strong&gt;always&lt;/strong&gt; be smaller than &lt;code class="docutils literal"&gt;FROM&lt;/code&gt;.  So I could
just transpose the s-expressions that found those two values.  I
tried it, and it worked!&lt;/p&gt;
&lt;p&gt;At that point I realized that I had committed to maintain the old
version of ada-mode, at least for myself, and that I'd already talked
about it on my blog and it was small step from there to setting up a
GitHub &lt;a class="reference external" href="https://github.com/tkurtbond/old-ada-mode"&gt;repository&lt;/a&gt; with the old code, adding an &lt;a class="reference external" href="https://github.com/tkurtbond/old-ada-mode/issues/1"&gt;issue&lt;/a&gt; describing the
problem, adding a &lt;a class="reference external" href="https://github.com/tkurtbond/old-ada-mode/commit/7ee6fe55862ec615c7fe23d881adfee2d0094770"&gt;commit&lt;/a&gt; with the fix, and then writing this blog
post.&lt;/p&gt;
&lt;p&gt;Somewhere, someone is laughing and enjoying the schadenfreude.  Maybe
this will help someone else.&lt;/p&gt;
&lt;p&gt;And since I already have a GitHub &lt;a class="reference external" href="https://github.com/tkurtbond/old-ada-mode"&gt;repository&lt;/a&gt;, I ought to document the
first &lt;a class="reference external" href="https://github.com/tkurtbond/old-ada-mode/issues/2"&gt;problem&lt;/a&gt; and since it is a documentation problem, put a mention
in the &lt;a class="reference external" href="https://github.com/tkurtbond/old-ada-mode/commit/67a79caacd851120fee2bca4704938a2f27e1bba"&gt;README&lt;/a&gt;.&lt;/p&gt;</summary>
    <category term="ada" label="ada"/>
    <category term="ada-mode" label="ada-mode"/>
    <category term="ada-modeel" label="ada-mode.el"/>
    <category term="emacs" label="emacs"/>
  </entry>
  <entry>
    <title>Using the old version of Ada Mode for Emacs</title>
    <id>https://tkurtbond.github.io/posts/2022/07/09/using-the-old-version-of-ada-mode-for-emacs/</id>
    <updated>2022-07-09T22:20:40-04:00</updated>
    <published>2022-07-09T22:20:40-04:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2022/07/09/using-the-old-version-of-ada-mode-for-emacs/"/>
    <summary type="html">&lt;p&gt;&lt;em&gt;Last edited: 2022-12-06 14:33:55 EST&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;There are a lot of things to like about the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ada_(programming_language)"&gt;Ada&lt;/a&gt; programming language;
it seems to have a solid core of users, enough to support multiple
commercial implementations and a &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Free_software"&gt;free/libre software&lt;/a&gt; implementation
that is part of the &lt;a class="reference external" href="https://gcc.gnu.org/"&gt;GNU Compiler Collection&lt;/a&gt;.  I occasionally use it
myself.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;However:&lt;/strong&gt; I'm sure that the current version of &lt;a class="reference external" href="https://www.nongnu.org/ada-mode/"&gt;Ada Mode&lt;/a&gt; for
&lt;a class="reference external" href="https://www.gnu.org/software/emacs/"&gt;Emacs&lt;/a&gt; (available as an &lt;a class="reference external" href="https://elpa.gnu.org/"&gt;ELPA&lt;/a&gt; &lt;a class="reference external" href="https://elpa.gnu.org/packages/ada-mode.html"&gt;package&lt;/a&gt;, and thus not included in
&lt;span class="app"&gt;Emacs&lt;/span&gt; itself), which provides smart editing for the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ada_(programming_language)"&gt;Ada&lt;/a&gt;
programming language, and uses an external parser for the indentation,
fontification&lt;a class="footnote-reference brackets" href="https://tkurtbond.github.io/posts/2022/07/09/using-the-old-version-of-ada-mode-for-emacs/#fontification" id="footnote-reference-1" role="doc-noteref"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;1&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/a&gt;, and navigation engine, is wonderful
if you can get it working, but I have &lt;strong&gt;never&lt;/strong&gt; been able to get it to
work.  My most recent try was today on Fedora 36 using GNAT 12.1.1
20220507 (Red Hat 12.1.1-1).&lt;/p&gt;
&lt;p&gt;Here's what happened when I tried to build the Ada code for the
parser, which is supplied as part of the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;ada-mode&lt;/span&gt;&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ ./build.sh
ada_mode_wisi_parse.gpr:44:26: warning: object directory "obj" not found
Setup
   [mkdir]        object directory for project Ada_Mode_Wisi_Parse
Compile
   [Ada]          ada_mode_wisi_lalr_parse.ads
   [Ada]          ada_mode_wisi_lr1_parse.ads
   [Ada]          run_ada_lalr_parse.ads
   [Ada]          run_ada_lr1_parse.ads
   [Ada]          gpr_mode_wisi_parse.ads
   [Ada]          run_gpr_parse.ads
   [Ada]          gpr_query.adb
   [C]            wisitoken_grammar_re2c.c
   [C]            ada_re2c.c
   [C]            gpr_re2c.c
   [Ada]          ada_process_actions.adb
   [Ada]          ada_process_lr1_main.adb
   [Ada]          gen_run_wisi_lr_text_rep_parse.adb
   [Ada]          run_wisi_common_parse.adb
   [Ada]          wisi.adb
gnatcoll-sql.adb:742:07: error: ambiguous expression (cannot resolve "Append")
gnatcoll-sql.adb:742:07: error: possible interpretation at a-coinve.ads:280, instance at gnatcoll-sql.ads:1109
gnatcoll-sql.adb:742:07: error: possible interpretation at a-coinve.ads:270, instance at gnatcoll-sql.ads:1109

   compilation of gpr_query.adb failed

gprbuild: *** compilation phase failed&lt;/pre&gt;
&lt;p&gt;Sigh.  Without the external parser the current &lt;a class="reference external" href="https://www.nongnu.org/ada-mode/"&gt;Ada Mode&lt;/a&gt; is
completely unworkable: it doesn't even do indentation correctly, much
less do fontification.&lt;/p&gt;
&lt;p&gt;However, when I did some Ada work a number of years ago, I was ok
with the version that used to be in &lt;span class="app"&gt;Emacs&lt;/span&gt; itself.  So I dug it
out of the &lt;a class="reference external" href="https://savannah.gnu.org/git/?group=emacs"&gt;Emacs git repository&lt;/a&gt; at &lt;a class="reference external" href="https://savannah.gnu.org"&gt;savannah.gnu.org&lt;/a&gt;.  Basically,
I cloned the git repository and then figured out what commit it was
deleted in by doing:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ git rev-list HEAD -n 1 -- lisp/progmodes/ada-mode.el
a13c64204c8ead966789abf8efe176e4f2d4f599&lt;/pre&gt;
&lt;p&gt;Then I checked out the files involved:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ git checkout a13c64204c8ead966789abf8efe176e4f2d4f599^ lisp/progmodes/ada-mode.el lisp/progmodes/ada-prj.el lisp/progmodes/ada-stmt.el lisp/progmodes/ada-xref.el doc/misc/ada-mode.texi&lt;/pre&gt;
&lt;p&gt;The &lt;code class="docutils literal"&gt;^&lt;/code&gt; at the end of the commit hash says to get the previous
commit.&lt;/p&gt;
&lt;p&gt;You'll also need &lt;span class="file"&gt;doc/docstyle.texi&lt;/span&gt; and
&lt;span class="file"&gt;doc/doclicense.texi&lt;/span&gt; if you want to build documentation from
&lt;span class="file"&gt;ada-mode.texi&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;And I've put the files in a &lt;a class="reference external" href="https://tkurtbond.github.io/emacs/old-ada-mode.zip"&gt;zip file&lt;/a&gt; for anybody who is in the same
situation as I was, along with the generated documentation files
&lt;span class="file"&gt;.info&lt;/span&gt;, &lt;span class="file"&gt;.html&lt;/span&gt;, and &lt;span class="file"&gt;.pdf&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Just put them somewhere on your &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;load-path&lt;/span&gt;&lt;/code&gt; and add &lt;code class="docutils literal"&gt;(autoload
&lt;span class="pre"&gt;'ada-mode&lt;/span&gt; &lt;span class="pre"&gt;"ada-mode")&lt;/span&gt;&lt;/code&gt; to your emacs config file.&lt;/p&gt;
&lt;p&gt;I'm sure the current &lt;a class="reference external" href="https://www.nongnu.org/ada-mode/"&gt;Ada Mode&lt;/a&gt; has a lot more useful features, and
I'd love to use it, but
this at least lets me edit with automatic indentation, formatting, and
fontification.&lt;/p&gt;
&lt;aside class="footnote-list brackets"&gt;
&lt;aside class="footnote brackets" id="fontification" role="doc-footnote"&gt;
&lt;span class="label"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;&lt;a role="doc-backlink" href="https://tkurtbond.github.io/posts/2022/07/09/using-the-old-version-of-ada-mode-for-emacs/#footnote-reference-1"&gt;1&lt;/a&gt;&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;‘Fontification’ is the process of displaying source code with
different font properties (such as color and typeface) for
differing syntactic roles.  &lt;a class="reference external" href="https://www.gnu.org/software/emacs/"&gt;Emacs&lt;/a&gt; and many other editors do this
to make it easier to distinguish different parts of the source
code, to help prevent errors.&lt;/p&gt;
&lt;/aside&gt;
&lt;/aside&gt;
&lt;!--  --&gt;
&lt;!-- Local Variables:
time-stamp-format: "%Y-%02m-%02d %02H:%02M:%02S %Z"
time-stamp-start: "\\*Last edited:[ \t]+\\\\?"
time-stamp-end: "\\*\\\\?\n"
End: --&gt;</summary>
    <category term="ada" label="ada"/>
    <category term="ada-mode" label="ada-mode"/>
    <category term="ada-modeel" label="ada-mode.el"/>
    <category term="emacs" label="emacs"/>
    <category term="freelibre-software" label="free/libre software"/>
  </entry>
  <entry>
    <title>Recording the books I read with org-mode and org-capture</title>
    <id>https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/</id>
    <updated>2022-05-21T07:17:18-04:00</updated>
    <published>2022-05-21T07:17:18-04:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/"/>
    <summary type="html">&lt;p&gt;I used to record the books that I read on this &lt;a class="reference external" href="https://tkurtbond.github.io/categories/recent-reading/"&gt;blog&lt;/a&gt;, but that took
too much &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2010/07/21/reading-but-not-recording/"&gt;effort&lt;/a&gt;.  However, if I don't record the books I read, I
sometimes can't remember whether I read a particular book or not,
especially with Kindle Unlimited books.  (Was it the seventh book of
the series that I read last, or the eighth?)&lt;/p&gt;
&lt;p&gt;I record the books that I read in &lt;a class="reference external" href="https://www.gnu.org/software/emacs/"&gt;emacs&lt;/a&gt; using &lt;a class="reference external" href="https://orgmode.org/"&gt;org-mode&lt;/a&gt; and —
since today — &lt;a class="reference external" href="ttps://orgmode.org/manual/Capture.html"&gt;org-capture&lt;/a&gt;.  Here's what the org file looks like:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-1" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-1" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-1"&gt;&lt;/a&gt;* 2022
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-2" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-2" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-2"&gt;&lt;/a&gt;** Read
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-3" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-3" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-3"&gt;&lt;/a&gt;*** : Title of Book I Haven't Finished Reading -- https://www.amazon.com/amazon-book-link-if-it-exists
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-4" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-4" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-4"&gt;&lt;/a&gt;...
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-5" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-5" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-5"&gt;&lt;/a&gt;*** 2022-05-21: Title of Book I **Have** Finished Reading -- https://www.amazon.com/amazon-book-link-if-it-exists
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-6" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-6" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-6"&gt;&lt;/a&gt;...
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-7" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-7" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-7"&gt;&lt;/a&gt;** Did not finish
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-8" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-8" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-8"&gt;&lt;/a&gt;*** : Title of Book I Won't Finish Reading -- https://www.amazon.com/amazon-book-link-if-it-exists
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-9" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-9" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-9"&gt;&lt;/a&gt;...
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-10" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-10" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-10"&gt;&lt;/a&gt;* 2021
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-11" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-11" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-11"&gt;&lt;/a&gt;* Previously read, sometime
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-12" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-12" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-12"&gt;&lt;/a&gt;** Title of Book I Finished Reading at some indeterminate date in the past -- https://www.amazon.com/amazon-book-link-if-it-exists
&lt;a id="rest_code_46a022e92ec448a5bb67cf75b1289f44-13" name="rest_code_46a022e92ec448a5bb67cf75b1289f44-13" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_46a022e92ec448a5bb67cf75b1289f44-13"&gt;&lt;/a&gt;...
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I keep the org file in a &lt;span class="app"&gt;git&lt;/span&gt; repository hosted online so I can
edit it on whatever computer is close at hand, or on my cell phone.
(Having a &lt;span class="app"&gt;git&lt;/span&gt; client with a simple editor on my phone is
wonderful!)&lt;/p&gt;
&lt;p&gt;When I start reading a book I create a new entry by selecting the
title and author of the book on its Amazon page, use the Chrome
extension Create Link to create a plain text link, which I then insert
into the org file at the right heading level and with a &lt;code class="docutils literal"&gt;:␢&lt;/code&gt; (a
colon followed by a blank space) after the asterisks of the heading
and before the link.  When I'm done with reading the book I put the
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/ISO_8601"&gt;ISO 8601&lt;/a&gt; date (&lt;em&gt;YYYY-MM-DD&lt;/em&gt;) before the colon.&lt;/p&gt;
&lt;p&gt;I wrote a script today to count how many books I've read so far this
year:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-1" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-1" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;#! /usr/bin/env bash&lt;/span&gt;
&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-2" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-2" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-3" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-3" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-3"&gt;&lt;/a&gt;&lt;span class="nv"&gt;YEAR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;date&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'+%Y'&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-4" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-4" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-4"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LAST_YEAR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$((&lt;/span&gt;&lt;span class="nv"&gt;YEAR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="k"&gt;))&lt;/span&gt;
&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-5" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-5" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-6" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-6" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-6"&gt;&lt;/a&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-E&lt;span class="w"&gt; &lt;/span&gt;-n&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"/^\* &lt;/span&gt;&lt;span class="nv"&gt;$YEAR&lt;/span&gt;&lt;span class="s2"&gt;/,/^(\*\* Did not finish|\* &lt;/span&gt;&lt;span class="nv"&gt;$LAST_YEAR&lt;/span&gt;&lt;span class="s2"&gt;)/p"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$READ_FILE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-7" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-7" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"/^* &lt;/span&gt;&lt;span class="nv"&gt;$YEAR&lt;/span&gt;&lt;span class="s2"&gt;/d"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"/^** Read/d"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-8" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-8" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"/^(\*\* Did not finish|\* &lt;/span&gt;&lt;span class="nv"&gt;$LAST_YEAR&lt;/span&gt;&lt;span class="s2"&gt;)/d"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-9" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-9" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-E&lt;span class="w"&gt; &lt;/span&gt;-n&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"/^\*\*\*[ \t]+[0-9]/p"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_1359e10b4b134effa4c86df344d4ffd2-10" name="rest_code_1359e10b4b134effa4c86df344d4ffd2-10" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_1359e10b4b134effa4c86df344d4ffd2-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;wc&lt;span class="w"&gt; &lt;/span&gt;-l
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This gets all the lines for this year, or just up to the ones that I did not finish, if there are any yet, then gets read of the leading&lt;/p&gt;
&lt;p&gt;This works pretty well.&lt;/p&gt;
&lt;p&gt;And so far I've read 227 books this year.&lt;/p&gt;
&lt;p&gt;And then I got to thinking: I could probably use &lt;a class="reference external" href="ttps://orgmode.org/manual/Capture.html"&gt;org-capture&lt;/a&gt; to
automate finding the file, finding the right place to insert the
information, and then copying the link from the clipboard and
inserting it along with the heading formation!&lt;/p&gt;
&lt;p&gt;Here's the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;org-capture-templates&lt;/span&gt;&lt;/code&gt; value I use for this:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code emacs-lisp"&gt;&lt;a id="rest_code_515c5b95313143598108ce6367bdca4d-1" name="rest_code_515c5b95313143598108ce6367bdca4d-1" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_515c5b95313143598108ce6367bdca4d-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;setq&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;org-capture-templates&lt;/span&gt;
&lt;a id="rest_code_515c5b95313143598108ce6367bdca4d-2" name="rest_code_515c5b95313143598108ce6367bdca4d-2" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_515c5b95313143598108ce6367bdca4d-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;`&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s"&gt;"b"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Add book about to read"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;entry&lt;/span&gt;
&lt;a id="rest_code_515c5b95313143598108ce6367bdca4d-3" name="rest_code_515c5b95313143598108ce6367bdca4d-3" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_515c5b95313143598108ce6367bdca4d-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;file+olp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;expand-file-name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"~/Repos/tkb-org/Books/read.org"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_515c5b95313143598108ce6367bdca4d-4" name="rest_code_515c5b95313143598108ce6367bdca4d-4" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_515c5b95313143598108ce6367bdca4d-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;format-time-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"%Y"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Read"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_515c5b95313143598108ce6367bdca4d-5" name="rest_code_515c5b95313143598108ce6367bdca4d-5" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_515c5b95313143598108ce6367bdca4d-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="s"&gt;"*** : %c"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;:prepend&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You'll want to read &lt;a class="reference external" href="https://orgmode.org/manual/Capture-templates.html"&gt;Capture templates&lt;/a&gt; to understand how this works.&lt;/p&gt;
&lt;p&gt;Of course, then I thought: what if my &lt;span class="app"&gt;emacs&lt;/span&gt; session lasts from
one year into the other, and I then add a new book?  It will have the
wrong year!&lt;/p&gt;
&lt;p&gt;And then I immediately thought of &lt;a class="reference external" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Advising-Functions.html"&gt;Advising Emacs Lisp Functions&lt;/a&gt;!
(I feel old — it was the &lt;code class="docutils literal"&gt;defadvice&lt;/code&gt; function when I started using
it.)&lt;/p&gt;
&lt;p&gt;So I added the following code:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code emacs-lisp"&gt;&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-1" name="rest_code_2726d5c87c8c46f589c6178d91297793-1" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-1"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;defvar&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;tkb-org-year&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;format-time-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"%Y"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-2" name="rest_code_2726d5c87c8c46f589c6178d91297793-2" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="s"&gt;"The year the current emacs session was started, for use with org-capture."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-3" name="rest_code_2726d5c87c8c46f589c6178d91297793-3" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;tkb-org-capture-advice-update-year&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;&amp;amp;optional&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;goto&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-4" name="rest_code_2726d5c87c8c46f589c6178d91297793-4" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="s"&gt;"Update ‘tkb-org-year’ and update the entry for adding a book in&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-5" name="rest_code_2726d5c87c8c46f589c6178d91297793-5" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-5"&gt;&lt;/a&gt;&lt;span class="s"&gt;‘org-capture-templates’ to use the new value."&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-6" name="rest_code_2726d5c87c8c46f589c6178d91297793-6" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nv"&gt;new-year&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;format-time-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"%Y"&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-7" name="rest_code_2726d5c87c8c46f589c6178d91297793-7" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;unless&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;string-equal&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;tkb-org-year&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;new-year&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-8" name="rest_code_2726d5c87c8c46f589c6178d91297793-8" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;setf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;tkb-org-year&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;new-year&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-9" name="rest_code_2726d5c87c8c46f589c6178d91297793-9" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;setf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;--&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"b"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;assoc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;org-capture-templates&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-10" name="rest_code_2726d5c87c8c46f589c6178d91297793-10" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;assoc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;'file+olp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;nth&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-11" name="rest_code_2726d5c87c8c46f589c6178d91297793-11" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="nv"&gt;tkb-org-year&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;a id="rest_code_2726d5c87c8c46f589c6178d91297793-12" name="rest_code_2726d5c87c8c46f589c6178d91297793-12" href="https://tkurtbond.github.io/posts/2022/05/21/recording-the-books-i-read-with-org-mode-and-org-capture/#rest_code_2726d5c87c8c46f589c6178d91297793-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;advice-add&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;'org-capture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;:before&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;#'&lt;/span&gt;&lt;span class="nv"&gt;tkb-org-capture-advice-update-year&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I tested this by manually setting &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;tkb-org-year&lt;/span&gt;&lt;/code&gt; to &lt;code class="docutils literal"&gt;"2021"&lt;/code&gt; and
capturing a new book.  It worked fine!&lt;/p&gt;</summary>
    <category term="advice-add" label="advice-add"/>
    <category term="defadvice" label="defadvice"/>
    <category term="emacs" label="emacs"/>
    <category term="emacs-advice" label="emacs advice"/>
    <category term="org-capture" label="org-capture"/>
    <category term="org-mode" label="org-mode"/>
    <category term="reading" label="reading"/>
  </entry>
  <entry>
    <title>define-word results using wordnik stopped working</title>
    <id>https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/</id>
    <updated>2021-09-13T15:48:30-04:00</updated>
    <published>2021-09-13T15:48:30-04:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/"/>
    <summary type="html">&lt;p&gt;I use &lt;a class="reference external" href="https://github.com/abo-abo/define-word"&gt;define-word&lt;/a&gt;, a package from melpa (&lt;a class="reference external" href="https://melpa.org/#/define-word"&gt;DWM&lt;/a&gt;), that looks up the
definition of a word online.  It uses &lt;a class="reference external" href="http://wordnik.com/"&gt;wordnik.com&lt;/a&gt; by default.
Recently it stopped returning definitions.&lt;/p&gt;
&lt;p&gt;I did a little digging, and it turns out that it works when
you visit the url with Chrome, but not if you just try to download it
with curl, or &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;url-retrieve&lt;/span&gt;&lt;/code&gt; in Emacs. Adding a
“&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;User-Agent:&lt;/span&gt; Mozilla/5.0 (Macintosh; Intel Mac OS X 11_5_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36&lt;/code&gt;”
with curl’s -H option made it work.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_35b5db6ec0794e588563e86e7ee3ff0a-1" name="rest_code_35b5db6ec0794e588563e86e7ee3ff0a-1" href="https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/#rest_code_35b5db6ec0794e588563e86e7ee3ff0a-1"&gt;&lt;/a&gt;curl&lt;span class="w"&gt; &lt;/span&gt;-i&lt;span class="w"&gt; &lt;/span&gt;-H&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_5_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;http://wordnik.com/words/importunate
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So I added a &lt;code class="docutils literal"&gt;let&lt;/code&gt; in my advice for &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;define-word&lt;/span&gt;&lt;/code&gt; that binds
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;url-request-extra-headers&lt;/span&gt;&lt;/code&gt; to an alist with &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;"User-Agent"&lt;/span&gt;&lt;/code&gt; as the
key and &lt;code class="docutils literal"&gt;"Mozilla/5.0 (Macintosh; Intel Mac OS X 11_5_2)
AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63
Safari/537.36"&lt;/code&gt; as the value, and it works again.&lt;/p&gt;
&lt;p&gt;My solution looks something like this (simplified from my actual advice,
which does other things too):&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code emacs-lisp"&gt;&lt;a id="rest_code_f430c2ee85a2448483461c6473f18cee-1" name="rest_code_f430c2ee85a2448483461c6473f18cee-1" href="https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/#rest_code_f430c2ee85a2448483461c6473f18cee-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defadvice&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;define-word&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;around&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;your-around-define-word&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;activate&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f430c2ee85a2448483461c6473f18cee-2" name="rest_code_f430c2ee85a2448483461c6473f18cee-2" href="https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/#rest_code_f430c2ee85a2448483461c6473f18cee-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="s"&gt;"Dynamically bind tkb-define-word-word to the word passed in."&lt;/span&gt;
&lt;a id="rest_code_f430c2ee85a2448483461c6473f18cee-3" name="rest_code_f430c2ee85a2448483461c6473f18cee-3" href="https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/#rest_code_f430c2ee85a2448483461c6473f18cee-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nv"&gt;url-request-extra-headers&lt;/span&gt;
&lt;a id="rest_code_f430c2ee85a2448483461c6473f18cee-4" name="rest_code_f430c2ee85a2448483461c6473f18cee-4" href="https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/#rest_code_f430c2ee85a2448483461c6473f18cee-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="o"&gt;'&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s"&gt;"User-Agent"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Mozilla/5.0 (Macintosh; Intel Mac OS X 11_5_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36"&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;a id="rest_code_f430c2ee85a2448483461c6473f18cee-5" name="rest_code_f430c2ee85a2448483461c6473f18cee-5" href="https://tkurtbond.github.io/posts/2021/09/13/define-word-results-using-wordnik-stopped-working/#rest_code_f430c2ee85a2448483461c6473f18cee-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;ad-do-it&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I opened an &lt;a class="reference external" href="https://github.com/abo-abo/define-word/issues/31"&gt;issue&lt;/a&gt; on github, suggesting it might be a good idea to
add a simpler way to add a &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;User-Agent:&lt;/span&gt;&lt;/code&gt; header around
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;define-word--to-string&lt;/span&gt;&lt;/code&gt;’s call to &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;url-retrieve-synchronously&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;</summary>
    <category term="define-word" label="define-word"/>
    <category term="emacs" label="emacs"/>
    <category term="wordnik" label="wordnik"/>
  </entry>
  <entry>
    <title>Gitub repo for Arrow Macros for Emacs</title>
    <id>https://tkurtbond.github.io/posts/2021/09/07/gitub-repo-for-arrow-macros-for-emacs/</id>
    <updated>2021-09-07T12:07:48-04:00</updated>
    <published>2021-09-07T12:07:48-04:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2021/09/07/gitub-repo-for-arrow-macros-for-emacs/"/>
    <summary type="html">&lt;p&gt;I've added a &lt;a class="reference external" href="https://github.com/tkurtbond/arrow-macros-for-emacs"&gt;Github repository&lt;/a&gt; for my port of &lt;a class="reference external" href="https://github.com/nightfly19/cl-arrows"&gt;CL-Arrows&lt;/a&gt; to
Emacs Lisp (&lt;a class="reference external" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/"&gt;original post&lt;/a&gt;), at the insistence of CPB.&lt;/p&gt;</summary>
    <category term="arrow-macros" label="arrow macros"/>
    <category term="clojure" label="clojure"/>
    <category term="common-lisp" label="common lisp"/>
    <category term="emacs" label="emacs"/>
    <category term="emacs-lisp" label="emacs lisp"/>
  </entry>
  <entry>
    <title>Sorting words separated by commas</title>
    <id>https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/</id>
    <updated>2021-07-16T13:05:09-04:00</updated>
    <published>2021-07-16T13:05:09-04:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/"/>
    <summary type="html">&lt;p&gt;I often have lists of "words", separated by commas, possibly on
multiple lines, like this example from a &lt;span class="file"&gt;Makefile&lt;/span&gt;:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code makefile"&gt;&lt;a id="rest_code_9f98c6f73ed14c0dad4677bb17c08b09-1" name="rest_code_9f98c6f73ed14c0dad4677bb17c08b09-1" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_9f98c6f73ed14c0dad4677bb17c08b09-1"&gt;&lt;/a&gt;&lt;span class="c"&gt;#    bookman, schoolbook, palatino, times,&lt;/span&gt;
&lt;a id="rest_code_9f98c6f73ed14c0dad4677bb17c08b09-2" name="rest_code_9f98c6f73ed14c0dad4677bb17c08b09-2" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_9f98c6f73ed14c0dad4677bb17c08b09-2"&gt;&lt;/a&gt;&lt;span class="c"&gt;#    helvetica, helvetica-narrow, optima, cormorant-garamond,&lt;/span&gt;
&lt;a id="rest_code_9f98c6f73ed14c0dad4677bb17c08b09-3" name="rest_code_9f98c6f73ed14c0dad4677bb17c08b09-3" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_9f98c6f73ed14c0dad4677bb17c08b09-3"&gt;&lt;/a&gt;&lt;span class="c"&gt;#    or ebgaramond.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I find these lists are always getting out of order, or they end up
with some short lines and some long lines.  I want to be able to
reformat them automatically, like this:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code makefile"&gt;&lt;a id="rest_code_d9de5dd5fad040369399ce3232a4d4c5-1" name="rest_code_d9de5dd5fad040369399ce3232a4d4c5-1" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_d9de5dd5fad040369399ce3232a4d4c5-1"&gt;&lt;/a&gt;&lt;span class="c"&gt;#    bookman, cormorant-garamond, ebgaramond, helvetica, helvetica-narrow,&lt;/span&gt;
&lt;a id="rest_code_d9de5dd5fad040369399ce3232a4d4c5-2" name="rest_code_d9de5dd5fad040369399ce3232a4d4c5-2" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_d9de5dd5fad040369399ce3232a4d4c5-2"&gt;&lt;/a&gt;&lt;span class="c"&gt;#    optima, palatino, schoolbook, or times.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, I wrote three scripts to deal with them,
&lt;span class="command"&gt;sort-with-commas&lt;/span&gt;, &lt;span class="command"&gt;strip-leading-hash&lt;/span&gt; to get rid
of the leading hashes and spaces, and &lt;span class="command"&gt;prefix&lt;/span&gt; to put the
leading hashes and spaces back.&lt;/p&gt;
&lt;p&gt;Now, above I said "words", because really it's anything separated by
commas, so the "words" can contain space, etc.&lt;/p&gt;
&lt;p&gt;Also, notice that the period after "ebgaramond" and the "or" before
"ebgaramond"` in the original list disappear, and an "or " appears
before the new end of the list, "times", and a period follows it.  And
you can have have the same situation with "and".  So, the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-p&lt;/span&gt;&lt;/code&gt;
option to &lt;span class="command"&gt;sort-with-commas&lt;/span&gt; adds a period after the last
word, the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-a&lt;/span&gt;&lt;/code&gt; option adds and "and " before the last word, and the
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-o&lt;/span&gt;&lt;/code&gt; option adds an "or " before the last word.  If you are sorting
only part of a list, you want to have a comma after the last "word",
so there is the option &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-f&lt;/span&gt;&lt;/code&gt; for that.  And to remove the the period
from the original list, so it doesn't end up in the middle of the new
list, or to remove "and " or "or ", there is the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-r&lt;/span&gt;&lt;/code&gt; option.&lt;/p&gt;
&lt;p&gt;The default is to return the sorted list as one long line, but you can
easily reformat it to multiple lines by running it through the Unix
command &lt;span class="command"&gt;fmt&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Although in this case the list is prefixed with a "#" and some spaces
because it comes from a comment in a Makefile, you have to remove
those to sort the list.  I wrote the script
&lt;span class="command"&gt;strip-leading-hash&lt;/span&gt; to do that, too, rather than having to
remember the &lt;span class="command"&gt;sed&lt;/span&gt; command to so that all the time.&lt;/p&gt;
&lt;p&gt;So, to sort the original list I'd run the command&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_0c6ce1697bd74d32b36c9d24e03eca76-1" name="rest_code_0c6ce1697bd74d32b36c9d24e03eca76-1" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_0c6ce1697bd74d32b36c9d24e03eca76-1"&gt;&lt;/a&gt;strip-leading-hash&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sort-with-commas&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;fmt&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;prefix&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"#    "&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;which means “strip the leading hashes and spaces, remove the trailing
period and the "and " or "or ", add a final period after the last word,
add an "or " before the final word, reformat as a paragraph, and
prefix the lines with the hash and spaces.”&lt;/p&gt;
&lt;p&gt;When I use this I'm usually in &lt;span class="app"&gt;emacs&lt;/span&gt; and using &lt;span class="key"&gt;M-|&lt;/span&gt; to
run it on the region (the currently selected text), often with the
&lt;span class="key"&gt;C-u&lt;/span&gt; to replace the region with results.&lt;/p&gt;
&lt;p&gt;Here's the main script, &lt;span class="file"&gt;sort-with-commas&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://tkurtbond.github.io/listings/sort-with-commas.html"&gt;sort-with-commas&lt;/a&gt;  &lt;a class="reference external" href="https://tkurtbond.github.io/listings/sort-with-commas"&gt;(Source)&lt;/a&gt;&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-1" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-1" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;#! /usr/bin/env bash&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-2" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-2" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;###############################################################################&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-3" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-3" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Sort a list of words that are seperated by commas, optionally followed by&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-4" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-4" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-4"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# a newline into a single line seperated by commas followed by spaces.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-5" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-5" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-6" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-6" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-6"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# For example: it translates (ignore the "# +" at the beginning of lines)&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-7" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-7" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-7"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#    bookman, schoolbook,palatino,&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-8" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-8" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#    times, helvetica, helvetica-narrow,&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-9" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-9" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-9"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# to&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-10" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-10" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-10"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#    bookman, helvetica, helvetica-narrow, palatino, schoolbook, times&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-11" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-11" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-11"&gt;&lt;/a&gt;&lt;span class="c1"&gt;###############################################################################&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-12" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-12" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-12"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-13" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-13" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-13"&gt;&lt;/a&gt;&lt;span class="nv"&gt;AND_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;off&lt;span class="w"&gt;                     &lt;/span&gt;&lt;span class="c1"&gt;# Insert "and " before last word.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-14" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-14" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-14"&gt;&lt;/a&gt;&lt;span class="nv"&gt;FINAL_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;off&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="c1"&gt;# Leave "," after last word.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-15" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-15" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-15"&gt;&lt;/a&gt;&lt;span class="nv"&gt;OR_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;off&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="c1"&gt;# Insert "or " before last word.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-16" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-16" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-16"&gt;&lt;/a&gt;&lt;span class="nv"&gt;PERIOD_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;off&lt;span class="w"&gt;                  &lt;/span&gt;&lt;span class="c1"&gt;# Insert a final period after last word.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-17" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-17" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-17"&gt;&lt;/a&gt;&lt;span class="nv"&gt;REMOVE_AND_OR_PERIOD_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;off
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-18" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-18" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-19" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-19" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-20" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-20" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-20"&gt;&lt;/a&gt;&lt;span class="nb"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;errors&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-21" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-21" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-21"&gt;&lt;/a&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;getopts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"?afhopr"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;opt
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-22" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-22" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-22"&gt;&lt;/a&gt;&lt;span class="k"&gt;do&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-23" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-23" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-23"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="nv"&gt;$opt&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-24" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-24" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-24"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="se"&gt;\?&lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;h&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;errors++&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-25" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-25" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-25"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;a&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;AND_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-26" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-26" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;f&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;FINAL_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-27" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-27" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;o&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;OR_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-28" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-28" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;p&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;PERIOD_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-29" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-29" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;r&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;REMOVE_AND_OR_PERIOD_OPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-30" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-30" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-30"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;esac&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-31" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-31" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-31"&gt;&lt;/a&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-32" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-32" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-32"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-33" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-33" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-33"&gt;&lt;/a&gt;&lt;span class="nb"&gt;shift&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;$((&lt;/span&gt;&lt;span class="nv"&gt;OPTIND&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="k"&gt;))&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-34" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-34" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-34"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-35" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-35" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-35"&gt;&lt;/a&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;||&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$errors&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-36" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-36" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;cat&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-37" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-37" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-37"&gt;&lt;/a&gt;&lt;span class="s"&gt;usage: sort-with-commas [OPTION]&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-38" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-38" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-38"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-39" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-39" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-39"&gt;&lt;/a&gt;&lt;span class="s"&gt;This reads its standard input and sorts a line or multiple lines with&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-40" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-40" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-40"&gt;&lt;/a&gt;&lt;span class="s"&gt;"words" separated by commas, then reassembles the line, words&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-41" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-41" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-41"&gt;&lt;/a&gt;&lt;span class="s"&gt;separated by a comma and s space, optionally leaving a final comma&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-42" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-42" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-42"&gt;&lt;/a&gt;&lt;span class="s"&gt;after the last word, or a period, and optionally putting "and " or "or&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-43" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-43" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-43"&gt;&lt;/a&gt;&lt;span class="s"&gt;" before the last word.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-44" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-44" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-44"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-45" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-45" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-45"&gt;&lt;/a&gt;&lt;span class="s"&gt;Options&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-46" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-46" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-46"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-47" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-47" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-47"&gt;&lt;/a&gt;&lt;span class="s"&gt;-? -h   This message.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-48" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-48" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-48"&gt;&lt;/a&gt;&lt;span class="s"&gt;-a      Insert "and " before last word.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-49" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-49" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-49"&gt;&lt;/a&gt;&lt;span class="s"&gt;-f      Leave final comma after last word.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-50" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-50" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-50"&gt;&lt;/a&gt;&lt;span class="s"&gt;-o      Insert "or " before last word.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-51" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-51" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-51"&gt;&lt;/a&gt;&lt;span class="s"&gt;-p      Insert a period after the last word.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-52" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-52" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-52"&gt;&lt;/a&gt;&lt;span class="s"&gt;-r      Remove "and " or "or " that occur at the beginning of a "word" in the&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-53" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-53" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-53"&gt;&lt;/a&gt;&lt;span class="s"&gt;        original list.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-54" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-54" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-54"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-55" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-55" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-55"&gt;&lt;/a&gt;&lt;span class="s"&gt;Note that combining -a and -o, or -f and -p do what you say, but the results&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-56" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-56" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-56"&gt;&lt;/a&gt;&lt;span class="s"&gt;are silly.&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-57" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-57" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-57"&gt;&lt;/a&gt;&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-58" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-58" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-58"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-59" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-59" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-59"&gt;&lt;/a&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-60" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-60" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-60"&gt;&lt;/a&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-61" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-61" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-61"&gt;&lt;/a&gt;tr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;','&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'\n'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-E&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'s/^[ \t]+//'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'/^$/d'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-62" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-62" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-62"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;([[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="nv"&gt;$REMOVE_AND_OR_PERIOD_OPT&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"on"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-63" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-63" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-63"&gt;&lt;/a&gt;&lt;span class="w"&gt;         &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-E&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'s/^(and|or)[ \t]+//'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'s/\.[ \t]*$//'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;||&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cat&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-64" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-64" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-64"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;sort&lt;span class="w"&gt; &lt;/span&gt;-u&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-65" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-65" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-65"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-E&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'s/$/,/'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-66" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-66" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-66"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="nv"&gt;$AND_OPT&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"on"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'$s/^/and /'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cat&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-67" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-67" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-67"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="nv"&gt;$FINAL_OPT&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"on"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cat&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'$s/,//'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-68" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-68" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-68"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="nv"&gt;$OR_OPT&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"on"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'$s/^/or /'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cat&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-69" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-69" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-69"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="nv"&gt;$PERIOD_OPT&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"on"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'$s/$/./'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cat&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_84686dd4d46d47c2bb9b44be1969fba3-70" name="rest_code_84686dd4d46d47c2bb9b44be1969fba3-70" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_84686dd4d46d47c2bb9b44be1969fba3-70"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;tr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'\n'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;' '&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-E&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'s/[ ]$//'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here's &lt;span class="file"&gt;strip-leading-hash&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://tkurtbond.github.io/listings/strip-leading-hash.html"&gt;strip-leading-hash&lt;/a&gt;  &lt;a class="reference external" href="https://tkurtbond.github.io/listings/strip-leading-hash"&gt;(Source)&lt;/a&gt;&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_2f8c08f042b042d18697244822cef34a-1" name="rest_code_2f8c08f042b042d18697244822cef34a-1" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_2f8c08f042b042d18697244822cef34a-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;#! /usr/bin/env bash&lt;/span&gt;
&lt;a id="rest_code_2f8c08f042b042d18697244822cef34a-2" name="rest_code_2f8c08f042b042d18697244822cef34a-2" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_2f8c08f042b042d18697244822cef34a-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_2f8c08f042b042d18697244822cef34a-3" name="rest_code_2f8c08f042b042d18697244822cef34a-3" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_2f8c08f042b042d18697244822cef34a-3"&gt;&lt;/a&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-E&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'s/^#[ \t]*//'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And here's &lt;span class="file"&gt;prefix&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://tkurtbond.github.io/listings/prefix.html"&gt;prefix&lt;/a&gt;  &lt;a class="reference external" href="https://tkurtbond.github.io/listings/prefix"&gt;(Source)&lt;/a&gt;&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_ce00532e953a4a35afc3dad9ab7dff6e-1" name="rest_code_ce00532e953a4a35afc3dad9ab7dff6e-1" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_ce00532e953a4a35afc3dad9ab7dff6e-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;#! /usr/bin/env bash&lt;/span&gt;
&lt;a id="rest_code_ce00532e953a4a35afc3dad9ab7dff6e-2" name="rest_code_ce00532e953a4a35afc3dad9ab7dff6e-2" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_ce00532e953a4a35afc3dad9ab7dff6e-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_ce00532e953a4a35afc3dad9ab7dff6e-3" name="rest_code_ce00532e953a4a35afc3dad9ab7dff6e-3" href="https://tkurtbond.github.io/posts/2021/07/16/sorting-words-separated-by-commas/#rest_code_ce00532e953a4a35afc3dad9ab7dff6e-3"&gt;&lt;/a&gt;sed&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"s/^/&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;/"&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary>
    <category term="bash" label="bash"/>
    <category term="emacs" label="emacs"/>
    <category term="script" label="script"/>
    <category term="shell" label="shell"/>
  </entry>
  <entry>
    <title>Having Emacs time-stamps at the end of files</title>
    <id>https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/</id>
    <updated>2020-08-05T16:34:22-04:00</updated>
    <published>2020-08-05T16:34:22-04:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/"/>
    <summary type="html">&lt;p&gt;Do you ever use &lt;span class="app"&gt;Emacs&lt;/span&gt; time stamp functionality (type &lt;span class="key"&gt;C-h
f time-stamp&lt;/span&gt; in &lt;span class="app"&gt;Emacs&lt;/span&gt; to learn about that) to insert the
current date time stamp into your file when you save it?  I use this
frequently in documents I write, for my blog or standalone.  For the
longest time I thought you had to have the time stamp at the beginning
of the file.  But I wanted it at the end of blog posts because it’s
really an afterthought to most readers.  (Sometimes I go back and edit
posts some time after first posting them — perhaps they were
incomplete, or they had errors that needed correcting, etc.)  It turns
out that you can do that — if you set the variable
&lt;code&gt;time-stamp-line-limit&lt;/code&gt; to a negative number it will look
backwards from the end of the file for the timestamp.  I often set the
time stamp variables in a &lt;code class="docutils literal"&gt;Local Variables:&lt;/code&gt; comment at the end of
the file.&lt;/p&gt;
&lt;p&gt;Here's the &lt;a class="reference external" href="https://docutils.sourceforge.io/rst.html"&gt;reST&lt;/a&gt; fragment I insert into my blog posts that uses
&lt;code&gt;time-stamp&lt;/code&gt;:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ReST"&gt;&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-1" name="rest_code_a460b149c157477eaf2bd9d534bd760e-1" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;role&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; app
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-2" name="rest_code_a460b149c157477eaf2bd9d534bd760e-2" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-2"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;role&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; file
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-3" name="rest_code_a460b149c157477eaf2bd9d534bd760e-3" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-3"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;role&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; command
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-4" name="rest_code_a460b149c157477eaf2bd9d534bd760e-4" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-4"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;role&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; key
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-5" name="rest_code_a460b149c157477eaf2bd9d534bd760e-5" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-6" name="rest_code_a460b149c157477eaf2bd9d534bd760e-6" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-6"&gt;&lt;/a&gt;&lt;span class="cp"&gt;.. *Last edited: 2020-08-05 17:03:37 EDT*&lt;/span&gt;
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-7" name="rest_code_a460b149c157477eaf2bd9d534bd760e-7" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-8" name="rest_code_a460b149c157477eaf2bd9d534bd760e-8" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-8"&gt;&lt;/a&gt;&lt;span class="cp"&gt;..&lt;/span&gt;
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-9" name="rest_code_a460b149c157477eaf2bd9d534bd760e-9" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-9"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   Local Variables:&lt;/span&gt;
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-10" name="rest_code_a460b149c157477eaf2bd9d534bd760e-10" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-10"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   time-stamp-format: "%04y-%02m-%02d %02H:%02M:%02S %Z"&lt;/span&gt;
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-11" name="rest_code_a460b149c157477eaf2bd9d534bd760e-11" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-11"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   time-stamp-start: "Last edited:[ \t]+\\\\?"&lt;/span&gt;
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-12" name="rest_code_a460b149c157477eaf2bd9d534bd760e-12" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-12"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   time-stamp-end: "\\*\\\\?\n"&lt;/span&gt;
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-13" name="rest_code_a460b149c157477eaf2bd9d534bd760e-13" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-13"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   time-stamp-line-limit: -20&lt;/span&gt;
&lt;a id="rest_code_a460b149c157477eaf2bd9d534bd760e-14" name="rest_code_a460b149c157477eaf2bd9d534bd760e-14" href="https://tkurtbond.github.io/posts/2020/08/05/having-emacs-time-stamps-at-the-end-of-files/#rest_code_a460b149c157477eaf2bd9d534bd760e-14"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   End:&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary>
    <category term="emacs" label="emacs"/>
    <category term="time-stamp" label="time-stamp"/>
  </entry>
  <entry>
    <title>Arrow Macros in Emacs Lisp</title>
    <id>https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/</id>
    <updated>2020-07-03T14:11:16-04:00</updated>
    <published>2020-07-03T14:11:16-04:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/"/>
    <summary type="html">&lt;p&gt;Are you familiar with arrow macros?  (They have nothing to do with
&lt;a class="reference external" href="https://en.wikibooks.org/wiki/Haskell/Understanding_arrows"&gt;arrows in Haskell&lt;/a&gt;.) They started out in &lt;a class="reference external" href="https://clojure.org/"&gt;Clojure&lt;/a&gt;, I think, and have
been ported to &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Common_Lisp"&gt;Common Lisp&lt;/a&gt; and probably other Lisps, though I didn't
find one for &lt;a class="reference external" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/"&gt;Emacs Lisp&lt;/a&gt;.  I think the &lt;a class="reference external" href="https://github.com/Harleqin/arrows"&gt;arrows&lt;/a&gt; package is the most up
to date in &lt;a class="reference external" href="https://www.quicklisp.org/"&gt;Quicklisp&lt;/a&gt; for &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Common_Lisp"&gt;Common Lisp&lt;/a&gt;, but I found the &lt;a class="reference external" href="https://github.com/nightfly19/cl-arrows"&gt;cl-arrows&lt;/a&gt;
package first so that's the one I converted to &lt;a class="reference external" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/"&gt;Emacs Lisp&lt;/a&gt; today.&lt;/p&gt;
&lt;p&gt;There were two slightly tricky parts to the port&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;I needed to use lexical binding for the source file&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://github.com/nightfly19/cl-arrows"&gt;cl-arrows&lt;/a&gt;'s test suite used fractions, but &lt;a class="reference external" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/"&gt;Emacs Lisp&lt;/a&gt; doesn't
have them.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Anyway, I think they're very useful.  If you have a value and
you want it to be processed by several functions in a chain you
can use an arrow macro instead of using lots of nested function
calls. For instance,&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code emacs-lisp"&gt;&lt;a id="rest_code_1fb17546da8b482ca63b85117f150a0e-1" name="rest_code_1fb17546da8b482ca63b85117f150a0e-1" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_1fb17546da8b482ca63b85117f150a0e-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-+$"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"^-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"^-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"\\.+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"\\.-"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-\\."&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"[^-.a-z0-9]+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;string&lt;/span&gt;&lt;span class="p"&gt;))))))))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;is annoying and hard to read on one line.  If you split it into multiple lines&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code emacs-lisp"&gt;&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-1" name="rest_code_7e8ea35427a64917a0e693828643cabc-1" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-2" name="rest_code_7e8ea35427a64917a0e693828643cabc-2" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-2"&gt;&lt;/a&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-+$"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-3" name="rest_code_7e8ea35427a64917a0e693828643cabc-3" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-3"&gt;&lt;/a&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-4" name="rest_code_7e8ea35427a64917a0e693828643cabc-4" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="s"&gt;"^-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-5" name="rest_code_7e8ea35427a64917a0e693828643cabc-5" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-6" name="rest_code_7e8ea35427a64917a0e693828643cabc-6" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="s"&gt;"^-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-7" name="rest_code_7e8ea35427a64917a0e693828643cabc-7" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-8" name="rest_code_7e8ea35427a64917a0e693828643cabc-8" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="s"&gt;"\\.+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-9" name="rest_code_7e8ea35427a64917a0e693828643cabc-9" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-10" name="rest_code_7e8ea35427a64917a0e693828643cabc-10" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="s"&gt;"\\.-"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-11" name="rest_code_7e8ea35427a64917a0e693828643cabc-11" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-12" name="rest_code_7e8ea35427a64917a0e693828643cabc-12" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="s"&gt;"-\\."&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-13" name="rest_code_7e8ea35427a64917a0e693828643cabc-13" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-14" name="rest_code_7e8ea35427a64917a0e693828643cabc-14" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="s"&gt;"-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-"&lt;/span&gt;
&lt;a id="rest_code_7e8ea35427a64917a0e693828643cabc-15" name="rest_code_7e8ea35427a64917a0e693828643cabc-15" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_7e8ea35427a64917a0e693828643cabc-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"[^-.a-z0-9]+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;string&lt;/span&gt;&lt;span class="p"&gt;))))))))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;that's also pretty horrible.  To read it you have to skip to the end,
figure out that function call, then skip back to the next function
call, and so forth, until you get back to the last function call,
reading it from inside out.  It looks much better if you use the
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-&amp;gt;&amp;gt;&lt;/span&gt;&lt;/code&gt; arrow macro, which substitutes the value you are passing along
as the last argument to the functions you are calling:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code emacs-lisp"&gt;&lt;a id="rest_code_ea4332e0ad78447bb343b023111e7cd0-1" name="rest_code_ea4332e0ad78447bb343b023111e7cd0-1" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_ea4332e0ad78447bb343b023111e7cd0-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;-&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;string&lt;/span&gt;
&lt;a id="rest_code_ea4332e0ad78447bb343b023111e7cd0-2" name="rest_code_ea4332e0ad78447bb343b023111e7cd0-2" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_ea4332e0ad78447bb343b023111e7cd0-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"[^-.a-z0-9]+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4332e0ad78447bb343b023111e7cd0-3" name="rest_code_ea4332e0ad78447bb343b023111e7cd0-3" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_ea4332e0ad78447bb343b023111e7cd0-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4332e0ad78447bb343b023111e7cd0-4" name="rest_code_ea4332e0ad78447bb343b023111e7cd0-4" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_ea4332e0ad78447bb343b023111e7cd0-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-\\."&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4332e0ad78447bb343b023111e7cd0-5" name="rest_code_ea4332e0ad78447bb343b023111e7cd0-5" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_ea4332e0ad78447bb343b023111e7cd0-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"\\.-"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4332e0ad78447bb343b023111e7cd0-6" name="rest_code_ea4332e0ad78447bb343b023111e7cd0-6" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_ea4332e0ad78447bb343b023111e7cd0-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"\\.+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4332e0ad78447bb343b023111e7cd0-7" name="rest_code_ea4332e0ad78447bb343b023111e7cd0-7" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_ea4332e0ad78447bb343b023111e7cd0-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"^-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4332e0ad78447bb343b023111e7cd0-8" name="rest_code_ea4332e0ad78447bb343b023111e7cd0-8" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_ea4332e0ad78447bb343b023111e7cd0-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-+$"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I also think it is more understandable than the highly nested calls,
since you can follow along in from start to finish, rather than from
inside out: you've got the value, you pass it to the first function,
then to the second, and so forth.&lt;/p&gt;
&lt;p&gt;There are also macros to insert the value at the front of the argument
list (&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-&amp;gt;&lt;/span&gt;&lt;/code&gt;) and to insert the value where a &lt;code class="docutils literal"&gt;&amp;lt;&amp;gt;&lt;/code&gt; symbol is found
(&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-&amp;lt;&amp;gt;&lt;/span&gt;&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;I wrote some &lt;a class="reference external" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/"&gt;Emacs Lisp&lt;/a&gt; code with the last expression above today, and
I think it makes a good example of why they are useful.&lt;/p&gt;
&lt;p&gt;Here's the use case that inspired me to port them to &lt;a class="reference external" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/"&gt;Emacs
Lisp&lt;/a&gt;.  When I save things from the internet I often want to
create a directory to save them in based on the filename or
some text on a web page or something, but usually there are
spaces or special characters in that text, so I have to
sanitize the text to make it a safe and simple filename.  So I
need to replace all special characters with dashes.  But I
don't want dashes repeated multiple times, just a single dash,
and I don't want dashes followed or preceded by periods, only
the period.&lt;/p&gt;
&lt;p&gt;Here' s some code to do that:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code emacs-lisp"&gt;&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-1" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-1" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;tkb-sanitize-for-filename&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;string&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-2" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-2" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="s"&gt;"Clean up characters in STRING that aren't good for&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-3" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-3" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-3"&gt;&lt;/a&gt;&lt;span class="s"&gt;filenames."&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-4" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-4" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;-&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;string&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-5" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-5" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"[^-.a-z0-9]+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-6" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-6" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-7" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-7" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-\\."&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-8" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-8" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"\\.-"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-9" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-9" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"\\.+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-10" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-10" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"^-+"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-11" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-11" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;replace-regexp-in-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"-+$"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-12" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-12" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-12"&gt;&lt;/a&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-13" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-13" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-13"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;tkb-sanitize-kill-for-filename&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;string&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-14" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-14" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="s"&gt;"Clean up characters that aren't good for filenames in the&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-15" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-15" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-15"&gt;&lt;/a&gt;&lt;span class="s"&gt;top of the kill&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-16" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-16" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-16"&gt;&lt;/a&gt;&lt;span class="s"&gt;ring and put the result on the top of the kill ring."&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-17" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-17" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;;; gets the kill or the system clipboard if it is new.&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-18" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-18" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;interactive&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;list&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;current-kill&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-19" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-19" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nv"&gt;new-string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;tkb-sanitize-for-filename&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;string&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-20" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-20" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;message&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Old string: %s\nNew String: %s"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;string&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;new-string&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-21" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-21" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;kill-new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;new-string&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-22" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-22" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-22"&gt;&lt;/a&gt;
&lt;a id="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-23" name="rest_code_9990b9e73a9849ccb9e08dedf4e3e846-23" href="https://tkurtbond.github.io/posts/2020/07/03/arrow-macros-in-emacs-lisp/#rest_code_9990b9e73a9849ccb9e08dedf4e3e846-23"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;global-set-key&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;kbd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"C-c k S"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;'tkb-sanitize-kill-for-filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note that the function &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;tkb-sanitize-kill-for-filename&lt;/span&gt;&lt;/code&gt; that I use
interactively gets uses &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;(current-kill&lt;/span&gt; 0 t)&lt;/code&gt; because it either
returns the top of the kill ring, or if the system clipboard is newer
it puts that on top of the kill ring and returns it.  (The docstring
of &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;current-kill&lt;/span&gt;&lt;/code&gt; makes that a little difficult to figure out.)&lt;/p&gt;
&lt;p&gt;So if I have the name of a product as
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;"***Flashy####Product%%%%Name!!!!"&lt;/span&gt;&lt;/code&gt; I copy that to the clipboard
with &lt;span class="key"&gt;⌘-C&lt;/span&gt;, switch to emacs, do &lt;span class="key"&gt;C-c k S&lt;/span&gt;, switch back to
whatever program is saving the file, and use the generated,
sanitized name &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;Flashy-Product-Name&lt;/span&gt;&lt;/code&gt; with &lt;span class="key"&gt;⌘-V&lt;/span&gt;.  Nifty!&lt;/p&gt;
&lt;p&gt;(And if you've ever wondered what the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Unicode"&gt;Unicode&lt;/a&gt; character for the Mac
keyboard &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Command_key"&gt;Command key&lt;/a&gt; (⌘) is, it is the PLACE OF INTEREST SIGN, and
you can enter it in &lt;span class="app"&gt;Emacs&lt;/span&gt; by &lt;span class="key"&gt;C-x 8 RETURN PLACE OF
INTEREST SIGN⏎&lt;/span&gt;.  The symbol they use for for the key labeled alt and
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Option_key"&gt;option&lt;/a&gt; (⌥) is the Unicode OPTION KEY, and the symbol they use for
the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Shift_key"&gt;Shift Key&lt;/a&gt; (⇧) is UPWARDS WHITE ARROW.  I'm surprised they
don't have a special symbol for &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Control_key"&gt;Control&lt;/a&gt;, but it looks like they just
use the plain ASCII ^, known in Unicode as CIRCUMFLEX ACCENT.)&lt;/p&gt;
&lt;p&gt;Anyway, &lt;a class="reference external" href="https://tkurtbond.github.io/arrows-for-emacs.zip"&gt;here&lt;/a&gt;'s a &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Info-ZIP"&gt;ZIP&lt;/a&gt; file with the Emacs Lisp source for the arrow
macros so you can use them if you've been convinced of their
usefulness by this post.  It also has some minimal documentation in
the &lt;span class="file"&gt;README.md&lt;/span&gt; that came from the &lt;span class="file"&gt;README.md&lt;/span&gt; from
&lt;a class="reference external" href="https://github.com/nightfly19/cl-arrows"&gt;cl-arrows&lt;/a&gt;, which seems to repeat the information from the
docstrings for the macros.&lt;/p&gt;
&lt;section id="section-1"&gt;
&lt;h2&gt;2021-09-07&lt;/h2&gt;
&lt;p&gt;Now in a &lt;a class="reference external" href="https://github.com/tkurtbond/arrow-macros-for-emacs"&gt;Gitub repo&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Last edited: 2021-09-07 13:25:09 EDT&lt;/em&gt;&lt;/p&gt;
&lt;!-- Local Variables:
time-stamp-format: "%Y-%02m-%02d %02H:%02M:%02S %Z"
time-stamp-start: "\\*Last edited:[ \t]+\\\\?"
time-stamp-end: "\\*\\\\?\n"
time-stamp-line-limit: -20
End: --&gt;
&lt;/section&gt;</summary>
    <category term="arrow-macros" label="arrow macros"/>
    <category term="clojure" label="clojure"/>
    <category term="common-lisp" label="common lisp"/>
    <category term="emacs" label="emacs"/>
    <category term="emacs-lisp" label="emacs lisp"/>
    <category term="unicode" label="unicode"/>
  </entry>
  <entry>
    <title>Getting nxml-mode in emacs to validate DocBook 5 documents</title>
    <id>https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/</id>
    <updated>2019-11-05T20:32:24-05:00</updated>
    <published>2019-11-05T20:32:24-05:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/"/>
    <summary type="html">&lt;p&gt;I have occasion to edit and build a DocBook 5 document under both
macOS Catalina and Fedora 30.&lt;/p&gt;
&lt;p&gt;On macOS I've used homebrew to install the docbook, docbook-xsl, and
libxslt (for xsltproc), and fop formulas, and changed my PATH to
include the directory where brew installed &lt;code class="docutils literal"&gt;xsltproc&lt;/code&gt;. which will then
use &lt;code class="docutils literal"&gt;/usr/local/etc/xml/catalog&lt;/code&gt; to find files, in which brew installed
links to the docbook schemas and xsl stylesheets.&lt;/p&gt;
&lt;p&gt;On Fedora I've used &lt;code class="docutils literal"&gt;dnf&lt;/code&gt; to install the docbook5-schemas,
docbook5-style-xsl, and fop packages.&lt;/p&gt;
&lt;p&gt;The document builds fine on both OSes, but Emacs doesn't validate
properly against the DocBook RELAX NG schemas, because the &lt;code class="docutils literal"&gt;*.rnc&lt;/code&gt; files
supplied with Emacs (26.3 on macOS, 26.2 on Fedora) are for DocBook 4.
However, Emacs will look at a &lt;code class="docutils literal"&gt;schemas.xml&lt;/code&gt; file in the same directory
as the file you are editing to find the &lt;code class="docutils literal"&gt;*.rnc&lt;/code&gt; files.  Unfortunately,
of course, they have different locations on macOS with brew and on
Fedora.&lt;/p&gt;
&lt;p&gt;So I wrote a script, generate-schemas-xml, in bash using xmlcatalog to
look up the translation for the URI for the RELAX NG compiled schema
file and generate the &lt;code class="docutils literal"&gt;schemas.xml&lt;/code&gt; file and substitute the translation
into the file:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://tkurtbond.github.io/listings/generate-schemas-xml.html"&gt;generate-schemas-xml&lt;/a&gt;  &lt;a class="reference external" href="https://tkurtbond.github.io/listings/generate-schemas-xml"&gt;(Source)&lt;/a&gt;&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-1" name="rest_code_c7e11e1303754599967506c6967a6bee-1" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;#! /usr/bin/env bash&lt;/span&gt;
&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-2" name="rest_code_c7e11e1303754599967506c6967a6bee-2" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-3" name="rest_code_c7e11e1303754599967506c6967a6bee-3" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-3"&gt;&lt;/a&gt;&lt;span class="nv"&gt;schema_location&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;xmlcatalog&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;""&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"http://docbook.org/xml/5.0/rng/docbookxi.rnc"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-4" name="rest_code_c7e11e1303754599967506c6967a6bee-4" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"^file:///"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;'s#^file://##'&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;
&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-5" name="rest_code_c7e11e1303754599967506c6967a6bee-5" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-6" name="rest_code_c7e11e1303754599967506c6967a6bee-6" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-6"&gt;&lt;/a&gt;cat&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;schemas.xml&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-7" name="rest_code_c7e11e1303754599967506c6967a6bee-7" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-7"&gt;&lt;/a&gt;&lt;span class="s"&gt;&amp;lt;locatingRules xmlns="http://thaiopensource.com/ns/locating-rules/1.0"&amp;gt;&lt;/span&gt;
&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-8" name="rest_code_c7e11e1303754599967506c6967a6bee-8" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-8"&gt;&lt;/a&gt;&lt;span class="s"&gt;&amp;lt;namespace ns="http://docbook.org/ns/docbook" uri="$schema_location"/&amp;gt;&lt;/span&gt;
&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-9" name="rest_code_c7e11e1303754599967506c6967a6bee-9" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-9"&gt;&lt;/a&gt;&lt;span class="s"&gt;&amp;lt;/locatingRules&amp;gt;&lt;/span&gt;
&lt;a id="rest_code_c7e11e1303754599967506c6967a6bee-10" name="rest_code_c7e11e1303754599967506c6967a6bee-10" href="https://tkurtbond.github.io/posts/2019/11/05/getting-nxml-mode-in-emacs-to-validate-docbook-5-documents/#rest_code_c7e11e1303754599967506c6967a6bee-10"&gt;&lt;/a&gt;&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then I had my Makefile generate the &lt;code class="docutils literal"&gt;schemas.xml&lt;/code&gt; file if it was missing.&lt;/p&gt;
&lt;p&gt;It was more complicated that I'd have liked, but it does work.&lt;/p&gt;</summary>
    <category term="docbook-5" label="docbook 5"/>
    <category term="emacs" label="emacs"/>
    <category term="fedora" label="fedora"/>
    <category term="macos" label="macos"/>
  </entry>
  <entry>
    <title>Defining keys in the C-x 8 prefix keymap</title>
    <id>https://tkurtbond.github.io/posts/2012/10/03/defining-keys-in-the-c-x-8-prefix-keymap/</id>
    <updated>2012-10-03T23:54:40-05:00</updated>
    <published>2012-10-03T23:54:40-05:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2012/10/03/defining-keys-in-the-c-x-8-prefix-keymap/"/>
    <summary type="html">&lt;p&gt;Yay!  I finally found it!&lt;/p&gt;
&lt;p&gt;Suppose you hate typing “C-x 8 RET GREEK SMALL LETTER LAMBDA” to
insert a lowercase lambda character in emacs (perhaps because you have
a dull American keyboard and aren't very savvy to input methods).  You
can add a key definition to the “C-x 8 prefix keymap”, say “gl”, so
you can type “C-x 8 g l” and insert a lowercase lambda.&lt;/p&gt;
&lt;p&gt;Here's how you might do it for “λ”, “Λ”, and “§”:&lt;/p&gt;
&lt;pre class="literal-block"&gt;(load-library "iso-transl.el")
(iso-transl-define-keys '(("gl" . [?λ])   ; greek lowercase lambda
                          ("gL" . [?Λ])   ; greek uppercase lambda
                          ("ps" . [?§]))) ; punctuation SECTION SIGN&lt;/pre&gt;</summary>
    <category term="emacs" label="emacs"/>
    <category term="emacs-lisp" label="emacs lisp"/>
    <category term="key-translation" label="key translation"/>
    <category term="unicode" label="unicode"/>
  </entry>
</feed>
