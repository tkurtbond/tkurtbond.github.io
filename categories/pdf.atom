<?xml version='1.0' encoding='UTF-8'?>
<?xml-stylesheet href="https://tkurtbond.github.io/assets/xml/atom.xsl" type="text/xsl media="all"?>
<feed xml:lang="en" xmlns="http://www.w3.org/2005/Atom">
  <title>Lacking Natural Simplicity (Posts about pdf)</title>
  <id>https://tkurtbond.github.io/categories/pdf.atom</id>
  <updated>2024-01-21T16:45:49Z</updated>
  <author>
    <name>T. Kurt Bond</name>
  </author>
  <link rel="self" type="application/atom+xml" href="https://tkurtbond.github.io/categories/pdf.atom"/>
  <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/categories/pdf/"/>
  <generator uri="https://getnikola.com/">Nikola</generator>
  <entry>
    <title>Simple OVA Character Sheet for Google Sheets</title>
    <id>https://tkurtbond.github.io/posts/2023/02/28/simple-ova-character-sheet-for-google-sheets/</id>
    <updated>2023-02-28T18:48:04-05:00</updated>
    <published>2023-02-28T18:48:04-05:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2023/02/28/simple-ova-character-sheet-for-google-sheets/"/>
    <summary type="html">&lt;p&gt;I added a simple character sheet for &lt;a class="reference external" href="https://www.wiseturtle.com/games.html"&gt;OVA: The Anime
Role-Playing Game&lt;/a&gt; for Google Sheets to my &lt;a class="reference external" href="https://tkurtbond.github.io/pages/rpg-downloads/"&gt;RPG Downloads&lt;/a&gt; page.&lt;/p&gt;
&lt;p&gt;I like the design of this one a bit better.  I may have to redesign
the &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2023/02/20/simple-ova-character-sheet-for-libreoffice-calc/"&gt;LibreOffice version&lt;/a&gt;.&lt;/p&gt;</summary>
    <category term="character-sheet" label="character sheet"/>
    <category term="google-sheets" label="google sheets"/>
    <category term="ova" label="ova"/>
    <category term="pdf" label="pdf"/>
    <category term="rpg" label="rpg"/>
  </entry>
  <entry>
    <title>Simple OVA Character Sheet for LibreOffice Calc</title>
    <id>https://tkurtbond.github.io/posts/2023/02/20/simple-ova-character-sheet-for-libreoffice-calc/</id>
    <updated>2023-02-20T22:26:47-05:00</updated>
    <published>2023-02-20T22:26:47-05:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2023/02/20/simple-ova-character-sheet-for-libreoffice-calc/"/>
    <summary type="html">&lt;p&gt;I added a brutally simple character sheet for &lt;a class="reference external" href="https://www.wiseturtle.com/games.html"&gt;OVA: The Anime
Role-Playing Game&lt;/a&gt; to my &lt;a class="reference external" href="https://tkurtbond.github.io/pages/rpg-downloads/"&gt;RPG Downloads&lt;/a&gt; page.  It is for
LibreOffice Calc.  There is also a brutally simple PDF generated from
it as well.&lt;/p&gt;</summary>
    <category term="character-sheet" label="character sheet"/>
    <category term="libreoffice" label="libreoffice"/>
    <category term="libreoffice-calc" label="libreoffice calc"/>
    <category term="ova" label="ova"/>
    <category term="pdf" label="pdf"/>
    <category term="rpg" label="rpg"/>
  </entry>
  <entry>
    <title>Customizing pandoc ms output with a Lua filter</title>
    <id>https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/</id>
    <updated>2020-05-03T01:01:53-04:00</updated>
    <published>2020-05-03T01:01:53-04:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/"/>
    <summary type="html">&lt;p&gt;This article started as a &lt;a class="reference external" href="https://groups.google.com/d/msg/pandoc-discuss/UJgyLbxTNxo/MZDVFts-BAAJ"&gt;message&lt;/a&gt; I sent to the the &lt;a class="reference external" href="https://groups.google.com/forum/#!forum/pandoc-discuss"&gt;pandoc-discuss&lt;/a&gt;
Google Group.  This version has more links and has been slightly
reworded.&lt;/p&gt;
&lt;p&gt;I work with &lt;a class="reference external" href="https://docutils.sourceforge.io/rst.html"&gt;ReStructuredText&lt;/a&gt; documents a lot and often use &lt;a class="reference external" href="https://pandoc.org/"&gt;pandoc&lt;/a&gt; to
format them, especially to PDF by way of &lt;span class="app"&gt;pandoc&lt;/span&gt;'s &lt;code class="docutils literal"&gt;ms&lt;/code&gt;
output format, which uses &lt;span class="app"&gt;groff&lt;/span&gt; with the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-ms&lt;/span&gt;&lt;/code&gt; macros to produce the
PDF output.  Using &lt;code class="docutils literal"&gt;ms&lt;/code&gt; output is fast, &lt;span class="app"&gt;groff&lt;/span&gt; is usually available
on the operating systems I use, and if you &lt;em&gt;do&lt;/em&gt; have to install &lt;span class="app"&gt;groff&lt;/span&gt;
it is easy to do and much, much smaller than any &lt;span class="app"&gt;TeX&lt;/span&gt; distributions.&lt;/p&gt;
&lt;p&gt;However, it would be a nice to be able to customize the &lt;code class="docutils literal"&gt;ms&lt;/code&gt; output
more for specific input, like if you are using technical writing and
are pining for something like the various inline roles of &lt;a class="reference external" href="https://tdg.docbook.org/tdg/5.1/ch02.html#s.inline"&gt;DocBook&lt;/a&gt;, or
wanted poems to be typeset more stylishly that the &lt;code class="docutils literal"&gt;ms&lt;/code&gt; output does.&lt;/p&gt;
&lt;p&gt;You should probably be a little familiar with the &lt;a class="reference external" href="https://pandoc.org/MANUAL.html"&gt;Pandoc User
Manual&lt;/a&gt; and have the documentation for &lt;a class="reference external" href="https://pandoc.org/lua-filters.html"&gt;Lua Filter&lt;/a&gt;'s available for
reference while reading this article.  And having a reading
familiarity with &lt;a class="reference external" href="https://www.gnu.org/software/groff/"&gt;groff&lt;/a&gt; and its &lt;a class="reference external" href="https://www.gnu.org/software/groff/manual/"&gt;manual&lt;/a&gt; and specifically the &lt;a class="reference external" href="https://www.gnu.org/software/groff/manual/html_node/ms.html#ms"&gt;-ms
macros&lt;/a&gt; will be useful too.  And maybe &lt;a class="reference external" href="https://www.lua.org/"&gt;Lua&lt;/a&gt; as well.&lt;/p&gt;
&lt;p&gt;Starting with an &lt;a class="reference external" href="https://dave.autonoma.ca/blog/2020/04/28/typesetting-markdown-part-8/"&gt;article&lt;/a&gt; from Dave Jarvis that had an example &lt;a class="reference external" href="https://pandoc.org/lua-filters.html"&gt;Lua
filter&lt;/a&gt; for customizing the &lt;span class="app"&gt;ConTeXt&lt;/span&gt; output and a little help
from the pandoc-discuss mailing list I came up with this example &lt;a class="reference external" href="https://pandoc.org/lua-filters.html"&gt;Lua
Filter&lt;/a&gt; that formats program names and poems specially.&lt;/p&gt;
&lt;p&gt;This filter wraps spans with a class, such as from interpreted text
roles defined in the source ReST (like &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;:program:`pandoc`&lt;/span&gt;&lt;/code&gt;) in calls
to user defined &lt;span class="app"&gt;groff&lt;/span&gt; strings &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;\*[start&amp;lt;class&amp;gt;]&lt;/span&gt;&lt;/code&gt; and
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;\*[stop&amp;lt;class&amp;gt;]&lt;/span&gt;&lt;/code&gt;.  (I've specified the string definitions for
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;\*[startprogram]&lt;/span&gt;&lt;/code&gt; and &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;\*[stopprogram]&lt;/span&gt;&lt;/code&gt; in the source ReST as a
raw block for &lt;code class="docutils literal"&gt;ms&lt;/code&gt; output but they could be in a customized &lt;code class="docutils literal"&gt;ms&lt;/code&gt;
pandoc template, too.)  These strings can include &lt;span class="app"&gt;groff&lt;/span&gt; escapes to
change the font and the glyph color and then change back to the
previous font and glyph color.  In this example I made PDF output for
the interpreted text role &lt;code class="docutils literal"&gt;program&lt;/code&gt; come out in a constant width
font and in red.&lt;/p&gt;
&lt;p&gt;It also wraps divs with classes with calls to user defined &lt;span class="app"&gt;groff&lt;/span&gt;
macros &lt;code class="docutils literal"&gt;.start&amp;lt;class&amp;gt;&lt;/code&gt; and &lt;code class="docutils literal"&gt;.stop&amp;lt;class&amp;gt;&lt;/code&gt; (also included in the
source ReST in the raw block for ms output).&lt;/p&gt;
&lt;p&gt;For divs with the poem class, it converts any contained LineBlock
elements into a list of Plain elements containing its contents,
avoiding the ms output for the LineBlock starting with &lt;code class="docutils literal"&gt;.LP&lt;/code&gt;, which
would cancel the &lt;code class="docutils literal"&gt;.DS&lt;/code&gt; (display start) macro I want to use in the
.startpoem macro definition.  The &lt;code class="docutils literal"&gt;.LP&lt;/code&gt; would also reset the font family
in use to the default, another reason to avoid it. &lt;a class="footnote-reference brackets" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#lp" id="footnote-reference-1" role="doc-noteref"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;1&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The filter also converts the empty element that occurs in the line block
as a result of a blank line in the line block input into a RawBlock
that creates a blank line in the ms output, to show the division into
stanzas of the poem.&lt;/p&gt;
&lt;p&gt;Interestingly, the first Str elements in the each line in the content
of the line block preserved the leading spaces from the input as
Unicode NO-BREAK SPACE characters, preserving indentation of lines in
the line block.  Unfortunately, the width of those spaces alone is not
enough create a visually distinct indentation, so this filter changes
those Str elements into a RawInline that outputs a &lt;span class="app"&gt;groff&lt;/span&gt; horizfontal
movement whose width is based on the number of leading NO-BREAK SPACE
characters, and follow this with a new Str element that has the
leading NO-BREAK SPACE characters removed.&lt;/p&gt;
&lt;p&gt;Here is the Lua filter, &lt;span class="file"&gt;classify-rst-ms.lua&lt;/span&gt;:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code lua"&gt;&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-1" name="rest_code_09328b4890b94557a809d88dfe19476c-1" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;onig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;require&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"rex_onig"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;-- Need a regex package that understands UTF8.&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-2" name="rest_code_09328b4890b94557a809d88dfe19476c-2" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;-- text in LineBreak preserves leading spaces as Unicode NO-BREAK SPACE&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-3" name="rest_code_09328b4890b94557a809d88dfe19476c-3" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;leading_nobreakspace_rx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;onig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"^(&lt;/span&gt;&lt;span class="se"&gt;\u{a0}&lt;/span&gt;&lt;span class="s2"&gt;+)(.*)$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;nil&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"UTF8"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-4" name="rest_code_09328b4890b94557a809d88dfe19476c-4" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-5" name="rest_code_09328b4890b94557a809d88dfe19476c-5" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-5"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;Div&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-6" name="rest_code_09328b4890b94557a809d88dfe19476c-6" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-6"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;classes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;find_if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;matches&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-7" name="rest_code_09328b4890b94557a809d88dfe19476c-7" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-7"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;numPara&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-8" name="rest_code_09328b4890b94557a809d88dfe19476c-8" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-8"&gt;&lt;/a&gt;   &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-9" name="rest_code_09328b4890b94557a809d88dfe19476c-9" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-9"&gt;&lt;/a&gt;     &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;"[^%w]*"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;""&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-10" name="rest_code_09328b4890b94557a809d88dfe19476c-10" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-10"&gt;&lt;/a&gt;     &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;"poem"&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-11" name="rest_code_09328b4890b94557a809d88dfe19476c-11" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;element&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;walk_block&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-12" name="rest_code_09328b4890b94557a809d88dfe19476c-12" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-12"&gt;&lt;/a&gt;           &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-13" name="rest_code_09328b4890b94557a809d88dfe19476c-13" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-13"&gt;&lt;/a&gt;              &lt;span class="c1"&gt;-- Replace LineBlock element with a list of Plain elements&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-14" name="rest_code_09328b4890b94557a809d88dfe19476c-14" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-14"&gt;&lt;/a&gt;              &lt;span class="c1"&gt;-- containing the LineBlock's subelements.&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-15" name="rest_code_09328b4890b94557a809d88dfe19476c-15" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-15"&gt;&lt;/a&gt;              &lt;span class="n"&gt;LineBlock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;el&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-16" name="rest_code_09328b4890b94557a809d88dfe19476c-16" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-16"&gt;&lt;/a&gt;                 &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-17" name="rest_code_09328b4890b94557a809d88dfe19476c-17" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-17"&gt;&lt;/a&gt;                 &lt;span class="kr"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;subel&lt;/span&gt; &lt;span class="kr"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;ipairs&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;el&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="kr"&gt;do&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-18" name="rest_code_09328b4890b94557a809d88dfe19476c-18" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-18"&gt;&lt;/a&gt;                    &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="o"&gt;#&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-19" name="rest_code_09328b4890b94557a809d88dfe19476c-19" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-19"&gt;&lt;/a&gt;                       &lt;span class="c1"&gt;-- If subel is an empty table, output a raw empty line&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-20" name="rest_code_09328b4890b94557a809d88dfe19476c-20" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-20"&gt;&lt;/a&gt;                       &lt;span class="nb"&gt;table.insert&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RawBlock&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"ms"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\n\n&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-21" name="rest_code_09328b4890b94557a809d88dfe19476c-21" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-21"&gt;&lt;/a&gt;                    &lt;span class="kr"&gt;else&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-22" name="rest_code_09328b4890b94557a809d88dfe19476c-22" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-22"&gt;&lt;/a&gt;                       &lt;span class="c1"&gt;-- Check for leading NO-BREAK SPACE charaters&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-23" name="rest_code_09328b4890b94557a809d88dfe19476c-23" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-23"&gt;&lt;/a&gt;                       &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;m1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;onig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;match&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-24" name="rest_code_09328b4890b94557a809d88dfe19476c-24" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-24"&gt;&lt;/a&gt;                                                  &lt;span class="n"&gt;leading_nobreakspace_rx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-25" name="rest_code_09328b4890b94557a809d88dfe19476c-25" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-25"&gt;&lt;/a&gt;                       &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;m1&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-26" name="rest_code_09328b4890b94557a809d88dfe19476c-26" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-26"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- Replace the NO-BREAK SPACE characters with a raw&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-27" name="rest_code_09328b4890b94557a809d88dfe19476c-27" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-27"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- groff horizontal movement, because the&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-28" name="rest_code_09328b4890b94557a809d88dfe19476c-28" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-28"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- NO-BREAK SPACE characters are too narrow.&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-29" name="rest_code_09328b4890b94557a809d88dfe19476c-29" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-29"&gt;&lt;/a&gt;                          &lt;span class="nb"&gt;table.insert&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RawInline&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"ms"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;string.format&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;h'%dn'"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;utf8.len&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m1&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-30" name="rest_code_09328b4890b94557a809d88dfe19476c-30" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-30"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- Modify what was used to be the first item to just&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-31" name="rest_code_09328b4890b94557a809d88dfe19476c-31" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-31"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- include the trailing characters of the match.&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-32" name="rest_code_09328b4890b94557a809d88dfe19476c-32" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-32"&gt;&lt;/a&gt;                          &lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Str&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-33" name="rest_code_09328b4890b94557a809d88dfe19476c-33" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-33"&gt;&lt;/a&gt;                          &lt;span class="nb"&gt;table.insert&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Plain&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-34" name="rest_code_09328b4890b94557a809d88dfe19476c-34" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-34"&gt;&lt;/a&gt;                       &lt;span class="kr"&gt;else&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-35" name="rest_code_09328b4890b94557a809d88dfe19476c-35" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-35"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- Just put the subel in Plain element.&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-36" name="rest_code_09328b4890b94557a809d88dfe19476c-36" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-36"&gt;&lt;/a&gt;                          &lt;span class="nb"&gt;table.insert&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Plain&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-37" name="rest_code_09328b4890b94557a809d88dfe19476c-37" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-37"&gt;&lt;/a&gt;                       &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-38" name="rest_code_09328b4890b94557a809d88dfe19476c-38" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-38"&gt;&lt;/a&gt;                    &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-39" name="rest_code_09328b4890b94557a809d88dfe19476c-39" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-39"&gt;&lt;/a&gt;                 &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-40" name="rest_code_09328b4890b94557a809d88dfe19476c-40" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-40"&gt;&lt;/a&gt;                 &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-41" name="rest_code_09328b4890b94557a809d88dfe19476c-41" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-41"&gt;&lt;/a&gt;        &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="p"&gt;})&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-42" name="rest_code_09328b4890b94557a809d88dfe19476c-42" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-42"&gt;&lt;/a&gt;     &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-43" name="rest_code_09328b4890b94557a809d88dfe19476c-43" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-43"&gt;&lt;/a&gt;     &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-44" name="rest_code_09328b4890b94557a809d88dfe19476c-44" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-44"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;".start"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-45" name="rest_code_09328b4890b94557a809d88dfe19476c-45" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-45"&gt;&lt;/a&gt;        &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-46" name="rest_code_09328b4890b94557a809d88dfe19476c-46" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-46"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;".stop"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-47" name="rest_code_09328b4890b94557a809d88dfe19476c-47" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-47"&gt;&lt;/a&gt;     &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-48" name="rest_code_09328b4890b94557a809d88dfe19476c-48" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-48"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-49" name="rest_code_09328b4890b94557a809d88dfe19476c-49" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-49"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-50" name="rest_code_09328b4890b94557a809d88dfe19476c-50" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-50"&gt;&lt;/a&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-51" name="rest_code_09328b4890b94557a809d88dfe19476c-51" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-51"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;Span&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-52" name="rest_code_09328b4890b94557a809d88dfe19476c-52" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-52"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;classes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;find_if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;matches&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-53" name="rest_code_09328b4890b94557a809d88dfe19476c-53" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-53"&gt;&lt;/a&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-54" name="rest_code_09328b4890b94557a809d88dfe19476c-54" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-54"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-55" name="rest_code_09328b4890b94557a809d88dfe19476c-55" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-55"&gt;&lt;/a&gt;     &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"[^%w]*"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;""&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-56" name="rest_code_09328b4890b94557a809d88dfe19476c-56" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-56"&gt;&lt;/a&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-57" name="rest_code_09328b4890b94557a809d88dfe19476c-57" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-57"&gt;&lt;/a&gt;     &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-58" name="rest_code_09328b4890b94557a809d88dfe19476c-58" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-58"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ms_inline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;*[start"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"]"&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-59" name="rest_code_09328b4890b94557a809d88dfe19476c-59" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-59"&gt;&lt;/a&gt;        &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-60" name="rest_code_09328b4890b94557a809d88dfe19476c-60" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-60"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ms_inline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;*[stop"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"]"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-61" name="rest_code_09328b4890b94557a809d88dfe19476c-61" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-61"&gt;&lt;/a&gt;     &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-62" name="rest_code_09328b4890b94557a809d88dfe19476c-62" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-62"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-63" name="rest_code_09328b4890b94557a809d88dfe19476c-63" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-63"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-64" name="rest_code_09328b4890b94557a809d88dfe19476c-64" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-64"&gt;&lt;/a&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-65" name="rest_code_09328b4890b94557a809d88dfe19476c-65" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-65"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;matches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-66" name="rest_code_09328b4890b94557a809d88dfe19476c-66" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-66"&gt;&lt;/a&gt; &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;"^%a+"&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-67" name="rest_code_09328b4890b94557a809d88dfe19476c-67" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-67"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-68" name="rest_code_09328b4890b94557a809d88dfe19476c-68" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-68"&gt;&lt;/a&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-69" name="rest_code_09328b4890b94557a809d88dfe19476c-69" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-69"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;macro&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-70" name="rest_code_09328b4890b94557a809d88dfe19476c-70" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-70"&gt;&lt;/a&gt; &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RawBlock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;"ms"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;macro&lt;/span&gt; &lt;span class="o"&gt;..&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-71" name="rest_code_09328b4890b94557a809d88dfe19476c-71" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-71"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-72" name="rest_code_09328b4890b94557a809d88dfe19476c-72" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-72"&gt;&lt;/a&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-73" name="rest_code_09328b4890b94557a809d88dfe19476c-73" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-73"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;ms_inline&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;macro&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-74" name="rest_code_09328b4890b94557a809d88dfe19476c-74" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-74"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RawInline&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"ms"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;macro&lt;/span&gt; &lt;span class="o"&gt;..&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;..&lt;/span&gt; &lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_09328b4890b94557a809d88dfe19476c-75" name="rest_code_09328b4890b94557a809d88dfe19476c-75" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_09328b4890b94557a809d88dfe19476c-75"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here is the ReST source of the document, &lt;span class="file"&gt;poem-plus.rst&lt;/span&gt;:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ReST"&gt;&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-1" name="rest_code_741cd11826df4a10b8f49e65737b3de9-1" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-1"&gt;&lt;/a&gt;Lua Filters For Massaging &lt;span class="s"&gt;``ms``&lt;/span&gt; Output
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-2" name="rest_code_741cd11826df4a10b8f49e65737b3de9-2" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-2"&gt;&lt;/a&gt;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-3" name="rest_code_741cd11826df4a10b8f49e65737b3de9-3" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-4" name="rest_code_741cd11826df4a10b8f49e65737b3de9-4" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-4"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;raw&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; ms
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-5" name="rest_code_741cd11826df4a10b8f49e65737b3de9-5" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-6" name="rest_code_741cd11826df4a10b8f49e65737b3de9-6" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-6"&gt;&lt;/a&gt;   .ds startprogram \\f[CW]\\m[red]
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-7" name="rest_code_741cd11826df4a10b8f49e65737b3de9-7" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-7"&gt;&lt;/a&gt;   .ds stopprogram \\m[]\\fP
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-8" name="rest_code_741cd11826df4a10b8f49e65737b3de9-8" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-8"&gt;&lt;/a&gt;   .de startpoem
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-9" name="rest_code_741cd11826df4a10b8f49e65737b3de9-9" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-9"&gt;&lt;/a&gt;   .ds OLDFAM \\*[FAM]
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-10" name="rest_code_741cd11826df4a10b8f49e65737b3de9-10" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-10"&gt;&lt;/a&gt;   .ds FAM BM
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-11" name="rest_code_741cd11826df4a10b8f49e65737b3de9-11" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-11"&gt;&lt;/a&gt;   .DS I 3
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-12" name="rest_code_741cd11826df4a10b8f49e65737b3de9-12" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-12"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   ..&lt;/span&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-13" name="rest_code_741cd11826df4a10b8f49e65737b3de9-13" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-13"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   .de stoppoem&lt;/span&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-14" name="rest_code_741cd11826df4a10b8f49e65737b3de9-14" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-14"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   .DE&lt;/span&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-15" name="rest_code_741cd11826df4a10b8f49e65737b3de9-15" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-15"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   .ds FAM \\*[OLDFAM]&lt;/span&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-16" name="rest_code_741cd11826df4a10b8f49e65737b3de9-16" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-16"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   ..&lt;/span&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-17" name="rest_code_741cd11826df4a10b8f49e65737b3de9-17" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-18" name="rest_code_741cd11826df4a10b8f49e65737b3de9-18" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-18"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;role&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; program
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-19" name="rest_code_741cd11826df4a10b8f49e65737b3de9-19" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-20" name="rest_code_741cd11826df4a10b8f49e65737b3de9-20" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-20"&gt;&lt;/a&gt;This is a sentence.  This sentence talks about &lt;span class="na"&gt;:program:&lt;/span&gt;&lt;span class="nv"&gt;`pandoc`&lt;/span&gt;.
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-21" name="rest_code_741cd11826df4a10b8f49e65737b3de9-21" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-21"&gt;&lt;/a&gt;This is
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-22" name="rest_code_741cd11826df4a10b8f49e65737b3de9-22" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-22"&gt;&lt;/a&gt;another sentence.
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-23" name="rest_code_741cd11826df4a10b8f49e65737b3de9-23" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-23"&gt;&lt;/a&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-24" name="rest_code_741cd11826df4a10b8f49e65737b3de9-24" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-24"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;class&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; poem
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-25" name="rest_code_741cd11826df4a10b8f49e65737b3de9-25" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-26" name="rest_code_741cd11826df4a10b8f49e65737b3de9-26" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-26"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; Some say the world will end in fire,
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-27" name="rest_code_741cd11826df4a10b8f49e65737b3de9-27" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-27"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    Some say in ice.
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-28" name="rest_code_741cd11826df4a10b8f49e65737b3de9-28" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-28"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; From what I've tasted of desire
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-29" name="rest_code_741cd11826df4a10b8f49e65737b3de9-29" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-29"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    I hold with those who favor fire.
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-30" name="rest_code_741cd11826df4a10b8f49e65737b3de9-30" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-30"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; But if it had to perish twice,
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-31" name="rest_code_741cd11826df4a10b8f49e65737b3de9-31" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-31"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    I think I know enough of hate
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-32" name="rest_code_741cd11826df4a10b8f49e65737b3de9-32" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-32"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    To say that for destruction ice
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-33" name="rest_code_741cd11826df4a10b8f49e65737b3de9-33" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-33"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    Is also great,
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-34" name="rest_code_741cd11826df4a10b8f49e65737b3de9-34" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-34"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; And would suffice.
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-35" name="rest_code_741cd11826df4a10b8f49e65737b3de9-35" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-35"&gt;&lt;/a&gt;   |
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-36" name="rest_code_741cd11826df4a10b8f49e65737b3de9-36" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-36"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; And another line,
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-37" name="rest_code_741cd11826df4a10b8f49e65737b3de9-37" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-37"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    And an indented line.
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-38" name="rest_code_741cd11826df4a10b8f49e65737b3de9-38" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-38"&gt;&lt;/a&gt;
&lt;a id="rest_code_741cd11826df4a10b8f49e65737b3de9-39" name="rest_code_741cd11826df4a10b8f49e65737b3de9-39" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_741cd11826df4a10b8f49e65737b3de9-39"&gt;&lt;/a&gt;This is a final sentence.
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And here is the ms output:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code groff"&gt;&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-1" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-1" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-1"&gt;&lt;/a&gt;.&lt;span class="k"&gt;SH&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-2" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-2" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-2"&gt;&lt;/a&gt;Lua Filters For Massaging &lt;span class="se"&gt;\f[CB]ms\f[B]&lt;/span&gt; Output
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-3" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-3" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-3"&gt;&lt;/a&gt;.&lt;span class="k"&gt;pdfhref&lt;/span&gt; &lt;span class="s"&gt;O&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="s2"&gt;"Lua Filters For Massaging ms Output"&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-4" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-4" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-4"&gt;&lt;/a&gt;.&lt;span class="k"&gt;pdfhref&lt;/span&gt; &lt;span class="s"&gt;M&lt;/span&gt; &lt;span class="s2"&gt;"lua-filters-for-massaging-ms-output"&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-5" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-5" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-5"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;startprogram&lt;/span&gt; &lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt;f[CW]\\m[red]&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-6" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-6" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-6"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;stopprogram&lt;/span&gt; &lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt;m[]\\fP&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-7" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-7" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-7"&gt;&lt;/a&gt;.&lt;span class="k"&gt;de&lt;/span&gt; &lt;span class="s"&gt;startpoem&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-8" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-8" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-8"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;OLDFAM&lt;/span&gt; &lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt;*[FAM]&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-9" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-9" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-9"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;FAM&lt;/span&gt; &lt;span class="s"&gt;BM&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-10" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-10" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-10"&gt;&lt;/a&gt;.&lt;span class="k"&gt;DS&lt;/span&gt; &lt;span class="s"&gt;I&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-11" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-11" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-11"&gt;&lt;/a&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="s"&gt;.&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-12" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-12" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-12"&gt;&lt;/a&gt;.&lt;span class="k"&gt;de&lt;/span&gt; &lt;span class="s"&gt;stoppoem&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-13" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-13" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-13"&gt;&lt;/a&gt;.&lt;span class="k"&gt;DE&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-14" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-14" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-14"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;FAM&lt;/span&gt; &lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt;*[OLDFAM]&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-15" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-15" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-15"&gt;&lt;/a&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="s"&gt;.&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-16" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-16" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-16"&gt;&lt;/a&gt;.&lt;span class="k"&gt;LP&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-17" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-17" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-17"&gt;&lt;/a&gt;This is a sentence.
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-18" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-18" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-18"&gt;&lt;/a&gt;This sentence talks about &lt;span class="se"&gt;\*[startprogram]pandoc\*[stopprogram]&lt;/span&gt;.
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-19" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-19" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-19"&gt;&lt;/a&gt;This is
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-20" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-20" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-20"&gt;&lt;/a&gt;another sentence.
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-21" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-21" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-21"&gt;&lt;/a&gt;.&lt;span class="k"&gt;startpoem&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-22" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-22" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-22"&gt;&lt;/a&gt;Some say the world will end in fire,
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-23" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-23" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-23"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'Some say in ice.
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-24" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-24" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-24"&gt;&lt;/a&gt;From what I&lt;span class="se"&gt;\[&lt;/span&gt;aq]ve tasted of desire
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-25" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-25" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-25"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'I hold with those who favor fire.
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-26" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-26" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-26"&gt;&lt;/a&gt;But if it had to perish twice,
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-27" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-27" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-27"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'I think I know enough of hate
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-28" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-28" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-28"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'To say that for destruction ice
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-29" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-29" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-29"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'Is also great,
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-30" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-30" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-30"&gt;&lt;/a&gt;And would suffice.
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-31" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-31" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-31"&gt;&lt;/a&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-32" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-32" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-32"&gt;&lt;/a&gt;And another line,
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-33" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-33" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-33"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'And an indented line.
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-34" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-34" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-34"&gt;&lt;/a&gt;.&lt;span class="k"&gt;stoppoem&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-35" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-35" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-35"&gt;&lt;/a&gt;.&lt;span class="k"&gt;LP&lt;/span&gt;
&lt;a id="rest_code_47b45220b5c2408bb49a9296a29ae3b8-36" name="rest_code_47b45220b5c2408bb49a9296a29ae3b8-36" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_47b45220b5c2408bb49a9296a29ae3b8-36"&gt;&lt;/a&gt;This is a final sentence.
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The command to produce the ms output is:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_faefc9bcfa5c4bb096c2af3709b96b95-1" name="rest_code_faefc9bcfa5c4bb096c2af3709b96b95-1" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_faefc9bcfa5c4bb096c2af3709b96b95-1"&gt;&lt;/a&gt;pandoc&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;rst&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;ms&lt;span class="w"&gt; &lt;/span&gt;--lua-filter&lt;span class="w"&gt; &lt;/span&gt;classify-rst-ms.lua&lt;span class="w"&gt; &lt;/span&gt;--wrap&lt;span class="o"&gt;=&lt;/span&gt;preserve&lt;span class="w"&gt; &lt;/span&gt;poem-plus.rst&lt;span class="w"&gt; &lt;/span&gt;--output&lt;span class="o"&gt;=&lt;/span&gt;poem-plus-rst.ms
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and the command to produce a PDF is:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_14326908cd114a61a98d5e31e2aa3723-1" name="rest_code_14326908cd114a61a98d5e31e2aa3723-1" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#rest_code_14326908cd114a61a98d5e31e2aa3723-1"&gt;&lt;/a&gt;pandoc&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;rst&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;ms&lt;span class="w"&gt; &lt;/span&gt;--lua-filter&lt;span class="w"&gt; &lt;/span&gt;classify-rst-ms.lua&lt;span class="w"&gt; &lt;/span&gt;--wrap&lt;span class="o"&gt;=&lt;/span&gt;preserve&lt;span class="w"&gt; &lt;/span&gt;poem-plus.rst&lt;span class="w"&gt; &lt;/span&gt;--output&lt;span class="o"&gt;=&lt;/span&gt;poem-plus-rst.ms.pdf
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a class="reference external" href="https://tkurtbond.github.io/poem-plus-rst.ms.pdf"&gt;Here&lt;/a&gt; is the output PDF.&lt;/p&gt;
&lt;p&gt;Being able to rewrite the tree and insert RawBlocks and RawInlines is
really powerful when it comes to customizing output for particular
output formats.&lt;/p&gt;
&lt;p&gt;I hope this example is useful for others like me just learning to use
Lua filters.&lt;/p&gt;
&lt;aside class="footnote-list brackets"&gt;
&lt;aside class="footnote brackets" id="lp" role="doc-footnote"&gt;
&lt;span class="label"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;&lt;a role="doc-backlink" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#footnote-reference-1"&gt;1&lt;/a&gt;&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;The &lt;code class="docutils literal"&gt;.LP&lt;/code&gt; macro in the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-ms&lt;/span&gt;&lt;/code&gt; macros resets a lot of
things back to the default when it is used, so if you want the custom
&lt;span class="app"&gt;groff&lt;/span&gt; setting from your user defined macros to continue from the
start to the end you can't allow the use of &lt;code class="docutils literal"&gt;.LP&lt;/code&gt; between the
&lt;code class="docutils literal"&gt;.start&amp;lt;class&amp;gt;&lt;/code&gt; and &lt;code class="docutils literal"&gt;.stop&amp;lt;class&amp;gt;&lt;/code&gt; macros.&lt;/p&gt;
&lt;/aside&gt;
&lt;/aside&gt;</summary>
    <category term="groff-ms-macros" label="groff ms macros"/>
    <category term="lua-filters" label="lua filters"/>
    <category term="pandoc" label="pandoc"/>
    <category term="pandoc-discuss" label="pandoc-discuss"/>
    <category term="pdf" label="pdf"/>
    <category term="restructuredtext" label="restructuredtext"/>
  </entry>
  <entry>
    <title>PDF-XChange Viewer</title>
    <id>https://tkurtbond.github.io/posts/2009/04/28/pdf-xchange-viewer/</id>
    <updated>2009-04-28T11:12:45-05:00</updated>
    <published>2009-04-28T11:12:45-05:00</published>
    <author>
      <name>T. Kurt Bond</name>
    </author>
    <link rel="alternate" type="text/html" href="https://tkurtbond.github.io/posts/2009/04/28/pdf-xchange-viewer/"/>
    <summary type="html">&lt;p&gt;I like to stick to Free/Libre (as in freedom) and Open Source Software
as much as I can, but I haven't found a open source program that lets
me add text on existing PDF documents yet, so I use a commercial but
free (as in costs nothing for personal use) program
&lt;a class="reference external" href="http://www.docu-track.com/home/prod_user/PDF-XChange_Tools/pdfx_viewer"&gt;PDF-XChange Viewer&lt;/a&gt;, which can be downloaded &lt;a class="reference external" href="http://www.docu-track.com/downloads/users/"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Unlike most of the other commercial but free programs that allow you
to add text to existing documents, PDF-XChange Viewer doesn't add any
nagware watermarking to the document to indicate that it was produced
with the free version, so you can use it fill out forms in PDF
documents that don't have electric form fields, which is very useful on
long forms.&lt;/p&gt;
&lt;p&gt;It's not perfect — I've had trouble with it on a few PDFs that seemed
to have pathological defects — but overall it works well.&lt;/p&gt;
&lt;p&gt;I'd still rather have a Free/Libre or Open Source program, though.&lt;/p&gt;</summary>
    <category term="computer" label="computer"/>
    <category term="pdf" label="pdf"/>
    <category term="tools" label="tools"/>
  </entry>
</feed>
