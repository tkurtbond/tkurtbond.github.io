<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Lacking Natural Simplicity</title><link>https://tkurtbond.github.io/</link><description>Random musings on books, code, and tabletop games.</description><atom:link href="https://tkurtbond.github.io/rss.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2020 &lt;a href="mailto:tkurtbond@gmail.com"&gt;T. Kurt Bond&lt;/a&gt; </copyright><lastBuildDate>Sun, 03 May 2020 06:37:55 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Customizing pandoc ms output with a lua filter</title><link>https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;This article started as a &lt;a class="reference external" href="https://groups.google.com/d/msg/pandoc-discuss/UJgyLbxTNxo/MZDVFts-BAAJ"&gt;message&lt;/a&gt; I sent to the the &lt;a class="reference external" href="https://groups.google.com/forum/#!forum/pandoc-discuss"&gt;pandoc-discuss&lt;/a&gt;
Google Group.  This version has more links and has been slightly
reworded.&lt;/p&gt;
&lt;p&gt;I work with &lt;a class="reference external" href="https://docutils.sourceforge.io/rst.html"&gt;ReStructuredText&lt;/a&gt; documents a lot and often use &lt;a class="reference external" href="https://pandoc.org/"&gt;pandoc&lt;/a&gt; to
format them, especially to PDF by way of &lt;span class="app"&gt;pandoc&lt;/span&gt;'s &lt;code class="docutils literal"&gt;ms&lt;/code&gt;
output format, which uses &lt;span class="app"&gt;groff&lt;/span&gt; with the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-ms&lt;/span&gt;&lt;/code&gt; macros to produce the
PDF output.  Using &lt;code class="docutils literal"&gt;ms&lt;/code&gt; output is fast, &lt;span class="app"&gt;groff&lt;/span&gt; is usually available
on the operating systems I use, and if you &lt;em&gt;do&lt;/em&gt; have to install &lt;span class="app"&gt;groff&lt;/span&gt;
it is easy to do and much, much smaller than any &lt;span class="app"&gt;TeX&lt;/span&gt; distributions.&lt;/p&gt;
&lt;p&gt;However, it would be a nice to be able to customize the &lt;code class="docutils literal"&gt;ms&lt;/code&gt; output
more for specific input, like if you are using technical writing and
are pining for something like the various inline roles of &lt;a class="reference external" href="https://tdg.docbook.org/tdg/5.1/ch02.html#s.inline"&gt;DocBook&lt;/a&gt;, or
wanted poems to be typeset more stylishly that the &lt;code class="docutils literal"&gt;ms&lt;/code&gt; output does.&lt;/p&gt;
&lt;p&gt;You should probably be a little familiar with the &lt;a class="reference external" href="https://pandoc.org/MANUAL.html"&gt;Pandoc User
Manual&lt;/a&gt; and have the documentation for &lt;a class="reference external" href="https://pandoc.org/lua-filters.html"&gt;Lua Filter&lt;/a&gt;'s available for
reference while reading this article.  And having a reading
familiarity with &lt;a class="reference external" href="https://www.gnu.org/software/groff/"&gt;groff&lt;/a&gt; and its &lt;a class="reference external" href="https://www.gnu.org/software/groff/manual/"&gt;manual&lt;/a&gt; and specifically the &lt;a class="reference external" href="https://www.gnu.org/software/groff/manual/html_node/ms.html#ms"&gt;-ms
macros&lt;/a&gt; will be useful too.&lt;/p&gt;
&lt;p&gt;Starting with an &lt;a class="reference external" href="https://dave.autonoma.ca/blog/2020/04/28/typesetting-markdown-part-8/"&gt;article&lt;/a&gt; from Dave Jarvis that had an example &lt;a class="reference external" href="https://pandoc.org/lua-filters.html"&gt;Lua
filter&lt;/a&gt; for customizing the &lt;span class="app"&gt;ConTeXt&lt;/span&gt; output and a little help
from the pandoc-discuss mailing list I came up with this example &lt;a class="reference external" href="https://pandoc.org/lua-filters.html"&gt;Lua
Filter&lt;/a&gt; that formats program names and poems specially.&lt;/p&gt;
&lt;p&gt;This filter wraps spans with a class, such as from interpreted text
roles defined in the source ReST (like &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;:program:`pandoc`&lt;/span&gt;&lt;/code&gt;) in calls
to user defined &lt;span class="app"&gt;groff&lt;/span&gt; strings &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;\*[start&amp;lt;class&amp;gt;]&lt;/span&gt;&lt;/code&gt; and
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;\*[stop&amp;lt;class&amp;gt;]&lt;/span&gt;&lt;/code&gt;.  (I've specified the string definitions for
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;\*[startprogram]&lt;/span&gt;&lt;/code&gt; and &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;\*[stopprogram]&lt;/span&gt;&lt;/code&gt; in the source ReST as a
raw block for &lt;code class="docutils literal"&gt;ms&lt;/code&gt; output but they could be in a customized &lt;code class="docutils literal"&gt;ms&lt;/code&gt;
pandoc template, too.)  These strings can include &lt;span class="app"&gt;groff&lt;/span&gt; escapes to
change the font and the glyph color and then change back to the
previous font and glyph color.  In this example I made PDF output for
the interpreted text role &lt;code class="docutils literal"&gt;program&lt;/code&gt; come out in a constant width
font and in red.&lt;/p&gt;
&lt;p&gt;It also wraps divs with classes with calls to user defined &lt;span class="app"&gt;groff&lt;/span&gt;
macros &lt;code class="docutils literal"&gt;.start&amp;lt;class&amp;gt;&lt;/code&gt; and &lt;code class="docutils literal"&gt;.stop&amp;lt;class&amp;gt;&lt;/code&gt; (also included in the
source ReST in the raw block for ms output).&lt;/p&gt;
&lt;p&gt;For divs with the poem class, it converts any contained LineBlock
elements into a list of Plain elements containing its contents,
avoiding the ms output for the LineBlock starting with &lt;code class="docutils literal"&gt;.LP&lt;/code&gt;, which
would cancel the &lt;code class="docutils literal"&gt;.DS&lt;/code&gt; (display start) macro I want to use in the
.startpoem macro definition.  The &lt;code class="docutils literal"&gt;.LP&lt;/code&gt; would also reset the font family
in use to the default, another reason to avoid it. &lt;a class="footnote-reference brackets" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#lp" id="id1"&gt;1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The filter also converts the empty element that occurs in the line block
as a result of a blank line in the line block input into a RawBlock
that creates a blank line in the ms output, to show the division into
stanzas of the poem.&lt;/p&gt;
&lt;p&gt;Interestingly, the first Str elements in the each line in the content
of the line block preserved the leading spaces from the input as
Unicode NO-BREAK SPACE characters, preserving indentation of lines in
the line block.  Unfortunately, the width of those spaces alone is not
enough create a visually distinct indentation, so this filter changes
those Str elements into a RawInline that outputs a &lt;span class="app"&gt;groff&lt;/span&gt; horizfontal
movement whose width is based on the number of leading NO-BREAK SPACE
characters, and follow this with a new Str element that has the
leading NO-BREAK SPACE characters removed.&lt;/p&gt;
&lt;p&gt;Here is the Lua filter:&lt;/p&gt;
&lt;pre class="code lua"&gt;&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;onig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;require&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"rex_onig"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;-- Need a regex package that understands UTF8.&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;-- text in LineBreak preserves leading spaces as Unicode NO-BREAK SPACE&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;leading_nobreakspace_rx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;onig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"^(&lt;/span&gt;&lt;span class="se"&gt;\u{a0}&lt;/span&gt;&lt;span class="s2"&gt;+)(.*)$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;nil&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"UTF8"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-5"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;Div&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-6"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;classes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;find_if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;matches&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-7"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;numPara&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-8"&gt;&lt;/a&gt;   &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-9"&gt;&lt;/a&gt;     &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;"[^%w]*"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;""&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-10"&gt;&lt;/a&gt;     &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;"poem"&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;element&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;walk_block&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-12"&gt;&lt;/a&gt;           &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-13"&gt;&lt;/a&gt;              &lt;span class="c1"&gt;-- Replace LineBlock element with a list of Plain elements&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-14"&gt;&lt;/a&gt;              &lt;span class="c1"&gt;-- containing the LineBlock's subelements.&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-15"&gt;&lt;/a&gt;              &lt;span class="n"&gt;LineBlock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;el&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-16"&gt;&lt;/a&gt;                 &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-17"&gt;&lt;/a&gt;                 &lt;span class="kr"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;subel&lt;/span&gt; &lt;span class="kr"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;ipairs&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;el&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="kr"&gt;do&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-18"&gt;&lt;/a&gt;                    &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="o"&gt;#&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-19"&gt;&lt;/a&gt;                       &lt;span class="c1"&gt;-- If subel is an empty table, output a raw empty line&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-20"&gt;&lt;/a&gt;                       &lt;span class="nb"&gt;table.insert&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RawBlock&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"ms"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\n\n&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-21"&gt;&lt;/a&gt;                    &lt;span class="kr"&gt;else&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-22"&gt;&lt;/a&gt;                       &lt;span class="c1"&gt;-- Check for leading NO-BREAK SPACE charaters&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-23"&gt;&lt;/a&gt;                       &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;m1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;onig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;match&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-24"&gt;&lt;/a&gt;                                                  &lt;span class="n"&gt;leading_nobreakspace_rx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-25"&gt;&lt;/a&gt;                       &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;m1&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-26"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- Replace the NO-BREAK SPACE characters with a raw&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-27"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- groff horizontal movement, because the&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-28"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- NO-BREAK SPACE characters are too narrow.&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-29"&gt;&lt;/a&gt;                          &lt;span class="nb"&gt;table.insert&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RawInline&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"ms"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;string.format&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;h'%dn'"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;utf8.len&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m1&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-30"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- Modify what was used to be the first item to just&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-31"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- include the trailing characters of the match.&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-32"&gt;&lt;/a&gt;                          &lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Str&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-33"&gt;&lt;/a&gt;                          &lt;span class="nb"&gt;table.insert&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Plain&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-34"&gt;&lt;/a&gt;                       &lt;span class="kr"&gt;else&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-35"&gt;&lt;/a&gt;                          &lt;span class="c1"&gt;-- Just put the subel in Plain element.&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-36"&gt;&lt;/a&gt;                          &lt;span class="nb"&gt;table.insert&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Plain&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subel&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-37"&gt;&lt;/a&gt;                       &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-38"&gt;&lt;/a&gt;                    &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-39"&gt;&lt;/a&gt;                 &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-40"&gt;&lt;/a&gt;                 &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-41"&gt;&lt;/a&gt;        &lt;span class="kr"&gt;end&lt;/span&gt; &lt;span class="p"&gt;})&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-42"&gt;&lt;/a&gt;     &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-43"&gt;&lt;/a&gt;     &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-44"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;".start"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-45"&gt;&lt;/a&gt;        &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-46"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;".stop"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-47"&gt;&lt;/a&gt;     &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-48"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-49"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-50"&gt;&lt;/a&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-51"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;Span&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-52"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;local&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;classes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;find_if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;matches&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-53"&gt;&lt;/a&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-54"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-55"&gt;&lt;/a&gt;     &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"[^%w]*"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;""&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-56"&gt;&lt;/a&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-57"&gt;&lt;/a&gt;     &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-58"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ms_inline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;*[start"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"]"&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-59"&gt;&lt;/a&gt;        &lt;span class="n"&gt;element&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-60"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ms_inline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;*[stop"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"]"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-61"&gt;&lt;/a&gt;     &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-62"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-63"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-64"&gt;&lt;/a&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-65"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;matches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-66"&gt;&lt;/a&gt; &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;"^%a+"&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-67"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-68"&gt;&lt;/a&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-69"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;macro&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-70"&gt;&lt;/a&gt; &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RawBlock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;"ms"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;macro&lt;/span&gt; &lt;span class="o"&gt;..&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-71"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-72"&gt;&lt;/a&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-73"&gt;&lt;/a&gt;&lt;span class="kr"&gt;function&lt;/span&gt; &lt;span class="nf"&gt;ms_inline&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;macro&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-74"&gt;&lt;/a&gt;  &lt;span class="kr"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pandoc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RawInline&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"ms"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;macro&lt;/span&gt; &lt;span class="o"&gt;..&lt;/span&gt; &lt;span class="n"&gt;annotation&lt;/span&gt; &lt;span class="o"&gt;..&lt;/span&gt; &lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b60bae2a9c074e6d84d8a2f58227dd0d-75"&gt;&lt;/a&gt;&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Here is the ReST source of the document:&lt;/p&gt;
&lt;pre class="code ReST"&gt;&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-1"&gt;&lt;/a&gt;Lua Filters For Massaging &lt;span class="s"&gt;``ms``&lt;/span&gt; Output
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-2"&gt;&lt;/a&gt;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-4"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;raw&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; ms
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-6"&gt;&lt;/a&gt;   .ds startprogram \\f[CW]\\m[red]
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-7"&gt;&lt;/a&gt;   .ds stopprogram \\m[]\\fP
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-8"&gt;&lt;/a&gt;   .de startpoem
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-9"&gt;&lt;/a&gt;   .ds OLDFAM \\*[FAM]
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-10"&gt;&lt;/a&gt;   .ds FAM BM
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-11"&gt;&lt;/a&gt;   .DS I 3
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-12"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   ..&lt;/span&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-13"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   .de stoppoem&lt;/span&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-14"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   .DE&lt;/span&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-15"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   .ds FAM \\*[OLDFAM]&lt;/span&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-16"&gt;&lt;/a&gt;&lt;span class="cp"&gt;   ..&lt;/span&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-17"&gt;&lt;/a&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-18"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;role&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; program
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-20"&gt;&lt;/a&gt;This is a sentence.  This sentence talks about &lt;span class="na"&gt;:program:&lt;/span&gt;&lt;span class="nv"&gt;`pandoc`&lt;/span&gt;.
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-21"&gt;&lt;/a&gt;This is
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-22"&gt;&lt;/a&gt;another sentence.
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-23"&gt;&lt;/a&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-24"&gt;&lt;/a&gt;&lt;span class="p"&gt;..&lt;/span&gt; &lt;span class="ow"&gt;class&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt; poem
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-25"&gt;&lt;/a&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-26"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; Some say the world will end in fire,
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-27"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    Some say in ice.
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-28"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; From what I've tasted of desire
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-29"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    I hold with those who favor fire.
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-30"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; But if it had to perish twice,
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-31"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    I think I know enough of hate
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-32"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    To say that for destruction ice
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-33"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    Is also great,
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-34"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; And would suffice.
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-35"&gt;&lt;/a&gt;   |
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-36"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt; And another line,
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-37"&gt;&lt;/a&gt;   &lt;span class="o"&gt;|&lt;/span&gt;    And an indented line.
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-38"&gt;&lt;/a&gt;
&lt;a name="rest_code_c9ff9d99fbad45fbb44f39a48dc6d9a7-39"&gt;&lt;/a&gt;This is a final sentence.
&lt;/pre&gt;&lt;p&gt;And here is the ms output:&lt;/p&gt;
&lt;pre class="code groff"&gt;&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-1"&gt;&lt;/a&gt;.&lt;span class="k"&gt;SH&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-2"&gt;&lt;/a&gt;Lua Filters For Massaging &lt;span class="se"&gt;\f[CB]ms\f[B]&lt;/span&gt; Output
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-3"&gt;&lt;/a&gt;.&lt;span class="k"&gt;pdfhref&lt;/span&gt; &lt;span class="s"&gt;O&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="s2"&gt;"Lua Filters For Massaging ms Output"&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-4"&gt;&lt;/a&gt;.&lt;span class="k"&gt;pdfhref&lt;/span&gt; &lt;span class="s"&gt;M&lt;/span&gt; &lt;span class="s2"&gt;"lua-filters-for-massaging-ms-output"&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-5"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;startprogram&lt;/span&gt; &lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt;f[CW]\\m[red]&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-6"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;stopprogram&lt;/span&gt; &lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt;m[]\\fP&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-7"&gt;&lt;/a&gt;.&lt;span class="k"&gt;de&lt;/span&gt; &lt;span class="s"&gt;startpoem&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-8"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;OLDFAM&lt;/span&gt; &lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt;*[FAM]&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-9"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;FAM&lt;/span&gt; &lt;span class="s"&gt;BM&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-10"&gt;&lt;/a&gt;.&lt;span class="k"&gt;DS&lt;/span&gt; &lt;span class="s"&gt;I&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-11"&gt;&lt;/a&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="s"&gt;.&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-12"&gt;&lt;/a&gt;.&lt;span class="k"&gt;de&lt;/span&gt; &lt;span class="s"&gt;stoppoem&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-13"&gt;&lt;/a&gt;.&lt;span class="k"&gt;DE&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-14"&gt;&lt;/a&gt;.&lt;span class="k"&gt;ds&lt;/span&gt; &lt;span class="s"&gt;FAM&lt;/span&gt; &lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt;*[OLDFAM]&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-15"&gt;&lt;/a&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="s"&gt;.&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-16"&gt;&lt;/a&gt;.&lt;span class="k"&gt;LP&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-17"&gt;&lt;/a&gt;This is a sentence.
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-18"&gt;&lt;/a&gt;This sentence talks about &lt;span class="se"&gt;\*[startprogram]pandoc\*[stopprogram]&lt;/span&gt;.
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-19"&gt;&lt;/a&gt;This is
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-20"&gt;&lt;/a&gt;another sentence.
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-21"&gt;&lt;/a&gt;.&lt;span class="k"&gt;startpoem&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-22"&gt;&lt;/a&gt;Some say the world will end in fire,
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-23"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'Some say in ice.
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-24"&gt;&lt;/a&gt;From what I&lt;span class="se"&gt;\[&lt;/span&gt;aq]ve tasted of desire
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-25"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'I hold with those who favor fire.
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-26"&gt;&lt;/a&gt;But if it had to perish twice,
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-27"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'I think I know enough of hate
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-28"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'To say that for destruction ice
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-29"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'Is also great,
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-30"&gt;&lt;/a&gt;And would suffice.
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-31"&gt;&lt;/a&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-32"&gt;&lt;/a&gt;And another line,
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-33"&gt;&lt;/a&gt;&lt;span class="se"&gt;\h&lt;/span&gt;'3n'And an indented line.
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-34"&gt;&lt;/a&gt;.&lt;span class="k"&gt;stoppoem&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-35"&gt;&lt;/a&gt;.&lt;span class="k"&gt;LP&lt;/span&gt;
&lt;a name="rest_code_b652c2b03a8148e3b237f6d45c05f486-36"&gt;&lt;/a&gt;This is a final sentence.
&lt;/pre&gt;&lt;p&gt;The command to produce the ms output is:&lt;/p&gt;
&lt;pre class="code text"&gt;&lt;a name="rest_code_ddadf337aef84b6586e27e1d09688f8e-1"&gt;&lt;/a&gt;pandoc -f rst -t ms --lua-filter classify-rst-ms.lua --wrap=preserve poem-plus.rst
&lt;/pre&gt;&lt;p&gt;and the command to produce a PDF is:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_f062f0fad1b44bb697dfbee252e53684-1"&gt;&lt;/a&gt;pandoc -f rst -t ms --lua-filter classify-rst-ms.lua --wrap&lt;span class="o"&gt;=&lt;/span&gt;preserve poem-plus.rst --output&lt;span class="o"&gt;=&lt;/span&gt;poem-plus-rst-ms.pdf
&lt;/pre&gt;&lt;p&gt;&lt;a class="reference external" href="https://tkurtbond.github.io/poem-plus-rst-ms.pdf"&gt;Here&lt;/a&gt; is the output PDF.&lt;/p&gt;
&lt;p&gt;Being able to rewrite the tree and insert RawBlocks and RawInlines is
really powerful when it comes to customizing output for particular
output formats.&lt;/p&gt;
&lt;p&gt;I hope this example is useful for others like me just learning to use
Lua filters.&lt;/p&gt;
&lt;dl class="footnote brackets"&gt;
&lt;dt class="label" id="lp"&gt;&lt;span class="brackets"&gt;&lt;a class="fn-backref" href="https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/#id1"&gt;1&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;The &lt;code class="docutils literal"&gt;.LP&lt;/code&gt; macro in the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-ms&lt;/span&gt;&lt;/code&gt; macros resets a lot of
things back to the default when it is used, so if you want the custom
&lt;span class="app"&gt;groff&lt;/span&gt; setting from your user defined macros to continue from the
start to the end you can't allow the use of &lt;code class="docutils literal"&gt;.LP&lt;/code&gt; between the
&lt;code class="docutils literal"&gt;.start&amp;lt;class&amp;gt;&lt;/code&gt; and &lt;code class="docutils literal"&gt;.stop&amp;lt;class&amp;gt;&lt;/code&gt; macros.&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;&lt;/div&gt;</description><category>groff ms macros</category><category>lua filters</category><category>pandoc</category><category>pandoc-discuss</category><category>pdf</category><category>restructuredtext</category><guid>https://tkurtbond.github.io/posts/2020/05/03/customizing-pandoc-ms-output-with-a-lua-filter/</guid><pubDate>Sun, 03 May 2020 05:01:53 GMT</pubDate></item><item><title>Binding a symbol defined with DEFCONSTANT with LET is not portable in Common Lisp</title><link>https://tkurtbond.github.io/posts/2020/04/24/binding-a-symbol-defined-with-defconstant-with-let-is-not-portable-in-common-lisp/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;&lt;a class="reference external" href="http://www.sbcl.org/"&gt;SBCL&lt;/a&gt; and &lt;a class="reference external" href="https://ccl.clozure.com/"&gt;CCL&lt;/a&gt; and &lt;a class="reference external" href="https://clisp.sourceforge.io/"&gt;CLISP&lt;/a&gt; think binding a symbol defined with &lt;code class="docutils literal"&gt;defconstant&lt;/code&gt;
is an error, so if you do&lt;/p&gt;
&lt;pre class="code common-lisp"&gt;&lt;a name="rest_code_3c0ac046cc934a26af4f0b3b0417ba45-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defconstant&lt;/span&gt; &lt;span class="nv"&gt;foo&lt;/span&gt; &lt;span class="s"&gt;"foo"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_3c0ac046cc934a26af4f0b3b0417ba45-2"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nv"&gt;foo&lt;/span&gt; &lt;span class="s"&gt;"bar"&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="nv"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;you get an error.  But in &lt;a class="reference external" href="https://abcl.org/"&gt;ABCL&lt;/a&gt; and &lt;a class="reference external" href="https://common-lisp.net/project/ecl/"&gt;ECL&lt;/a&gt; you don’t.&lt;/p&gt;
&lt;p&gt;If you try&lt;/p&gt;
&lt;pre class="code common-lisp"&gt;&lt;a name="rest_code_e11c81000bd04c11b01c366e7f6562da-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;defun&lt;/span&gt; &lt;span class="nv"&gt;x&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nv"&gt;foo&lt;/span&gt; &lt;span class="s"&gt;"bar"&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="nv"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;in SBCL and CCL you get an error when the function is compiled.
In SBCL the function is defined, but always gives an error when run.
In CCL the function does not get defined.&lt;/p&gt;&lt;/div&gt;</description><category>abcl</category><category>ccl</category><category>clisp</category><category>common lisp</category><category>ecl</category><category>sbcl</category><guid>https://tkurtbond.github.io/posts/2020/04/24/binding-a-symbol-defined-with-defconstant-with-let-is-not-portable-in-common-lisp/</guid><pubDate>Sat, 25 Apr 2020 03:46:39 GMT</pubDate></item><item><title>Recent Reading: Howard and Carter</title><link>https://tkurtbond.github.io/posts/2020/04/04/recent-reading-howard-and-carter/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;Cthulhu: The Mythos and Kindred Horrors&lt;/cite&gt;, by Robert E. Howard,
copyright 1987 by Ala Key Kuykendall and Alla Ray Morris; Baen
Publishing Enterprises; ISBN 0-671-65641-4.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I enjoyed reading these again; it has been many years since I have
read them.  The racism of the stories set in America is what you'd
expect from a person of Howard's era, but understanding that, the
other elements of the stories make the book worth reading.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;By the Light of the Green Star&lt;/cite&gt;, by Lin Carter, copyright 1974; DAW
Books Number 110.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;As the Green Star Rises&lt;/cite&gt;, by Lin Carter, copyright 1975; DAW Books;
ISBN 0-87997-811-2.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;In the Green Star's Glow&lt;/cite&gt;, by Lin Carter, copyright 1976; DAW
Books.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It is interesting to note that these were popular enough at the time
to go into multiple printings, judging from my copies, all of which
are later printings except for the second book, &lt;cite&gt;When the Green Star
Calls&lt;/cite&gt;. The &lt;a class="reference external" href="https://www.amazon.com/gp/bookseries/B00CJDD9ZY/ref=dp_st_0879970626"&gt;Amazon&lt;/a&gt; reviews of the books in the series are positive as
well.&lt;/p&gt;
&lt;p&gt;They are definitely fast, fun, pulpy adventures.&lt;/p&gt;&lt;/div&gt;</description><category>horror</category><category>lin carter</category><category>robert e. howard</category><category>sword &amp; planet</category><guid>https://tkurtbond.github.io/posts/2020/04/04/recent-reading-howard-and-carter/</guid><pubDate>Sat, 04 Apr 2020 17:11:22 GMT</pubDate></item><item><title>Recent Reading: Carter and Page</title><link>https://tkurtbond.github.io/posts/2020/03/22/recent-reading-carter-and-page/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;I've continued reading Lin Carter's &lt;cite class="series"&gt;Green Star&lt;/cite&gt; Sword &amp;amp;
Planet novels.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;When the Green Star Calls&lt;/cite&gt;, by Lin Carter, copyright 1973; DAW
Books Number 62.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;By the Light of the Green Star&lt;/cite&gt;, by Lin Carter, copyright 1974; DAW
Books Number 110.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Both of these are short novels, 176 pages for the first and 175 pages
for the second.  Both end on cliffhangers.  In the first the
protagonist and his friends are split into two groups, and they are
apart the whole in the second.&lt;/p&gt;
&lt;p&gt;I've also continued my Sword &amp;amp; Sorcery reading with Norvell W. Page,
who is new to me.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;Flame Winds&lt;/cite&gt;, by Norvell W. Page; copyright 1939 by Street and
Smith, Inc., copyright 1967 by Conde Nast Publications, Inc.;
Berkley Publishing Corp., 1978.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Well, it was no &lt;cite&gt;Conan&lt;/cite&gt;, but it was entertaining!&lt;/p&gt;&lt;/div&gt;</description><category>lin carter</category><category>norvell w. page</category><category>sword &amp; planet</category><category>sword &amp; sorcery</category><guid>https://tkurtbond.github.io/posts/2020/03/22/recent-reading-carter-and-page/</guid><pubDate>Sun, 22 Mar 2020 23:34:49 GMT</pubDate></item><item><title>The "Typical Activities" checklist from The Traveller Book and Starter Traveller</title><link>https://tkurtbond.github.io/posts/2020/03/17/the-typical-activities-checklist-from-the-traveller-book-and-starter-traveller/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;I've been looking at Cepheus Engine and I've noticed that there is
nothing like the “Typical Activities” checklist that first appeared in
&lt;cite&gt;The Traveller Book&lt;/cite&gt;, but which I first encountered in play recently
with &lt;cite&gt;Starter Traveller&lt;/cite&gt;.  It made a definite impression on me — with
this one could improvise a trading session from start to end.  I'm not
sure yet whether Cepheus Engine supports the completely improvised
Traveller adventure &lt;a class="reference external" href="https://talestoastound.wordpress.com/2016/05/31/traveller-out-of-the-box-the-casual-and-improvisatory-nature-of-early-traveller-play/"&gt;talked about&lt;/a&gt; on the &lt;a class="reference external" href="https://talestoastound.wordpress.com/"&gt;Tales to Astound&lt;/a&gt; blog,
but using this with Cepheus Engine would certainly make it easier.&lt;/p&gt;
&lt;hr class="docutils"&gt;
&lt;div class="section" id="typical-activities"&gt;
&lt;h2&gt;Typical Activities&lt;/h2&gt;
&lt;ol class="upperroman simple"&gt;
&lt;li&gt;&lt;p&gt;Arrive in star system.&lt;/p&gt;
&lt;ol class="upperalpha simple"&gt;
&lt;li&gt;&lt;p&gt;Scan area for potential danger, problems, and other data.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Set course insystem.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Possible ship encounter.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Local gas giant.&lt;/p&gt;
&lt;ol class="upperalpha simple"&gt;
&lt;li&gt;&lt;p&gt;Achieve orbit.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Refuel.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Set course to major world or outsystem.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Local major world.&lt;/p&gt;
&lt;ol class="upperalpha simple"&gt;
&lt;li&gt;&lt;p&gt;Achieve orbit.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Proceed to orbital starport (unstreamlined ships) or surface
starport (streamlined ships).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Arrival onplanet.&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Unload high passengers.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Unload mail.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Unload middle passengers.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Unload cargo.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Unload low passengers.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Conclude low lottery.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Refit and maintenance.&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Refuel from starport.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Renew ship life support.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Commodity activity.&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Sell speculative cargo.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Buy speculative cargo.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ship business.&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Pay berthing costs.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pay bank payment.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pay maintenance fund.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pay crew salaries.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Miscellaneous activity.&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Patron encounters.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Planetary exploration.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Local areas of interest.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Hire new crew members.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Prepare for departure.&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Load cargo.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Load low passengers.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Load middle passengers.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Load high passengers.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Load mail.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Collect income for all aspects of current trip.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Departure.&lt;/p&gt;
&lt;ol class="upperalpha simple"&gt;
&lt;li&gt;&lt;p&gt;Lift-off.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Achieve orbit.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Set course outsystem.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Possible ship encounter.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Jump.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Note: This list is primarily of interest to merchants. Not all events
on this list are explained in this chapter on travelling. Other
relevant chapters include Worlds, Encounters, and Trade and Commerce.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>cepheus engine</category><category>rpg</category><category>starter traveller</category><category>the traveller book</category><category>traveller</category><guid>https://tkurtbond.github.io/posts/2020/03/17/the-typical-activities-checklist-from-the-traveller-book-and-starter-traveller/</guid><pubDate>Tue, 17 Mar 2020 19:23:13 GMT</pubDate></item><item><title>Playing Classic Traveller in 2020</title><link>https://tkurtbond.github.io/posts/2020/03/16/playing-classic-traveller-in-2020/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;div class="section" id="finally-playing-classic-traveller"&gt;
&lt;h2&gt;Finally playing Classic Traveller&lt;/h2&gt;
&lt;p&gt;A friend of mine who was in my gaming group back in the 1980s read the
article &lt;a class="reference external" href="https://www.tor.com/2020/01/10/traveller-a-classic-science-fiction-simulator/"&gt;Traveller: A Classic Science Fiction Simulator&lt;/a&gt; at
&lt;a class="reference external" href="https://www.tor.com"&gt;Tor.com&lt;/a&gt; and found it interesting.  We discussed it, and he
downloaded &lt;a class="reference external" href="https://www.drivethrurpg.com/product/80190/CTSTStarter-Traveller"&gt;Starter Traveller&lt;/a&gt; from &lt;a class="reference external" href="https://www.drivethrurpg.com/"&gt;Drivethrurpg.com&lt;/a&gt; (it is free)
and started reading it.  I had the PDF already, and I printed it out
and started reading it as well.  I also found a physical copy for sale
on the Internet, so I ordered that as well, and it was much more
convenient to use than my printout in binders.&lt;/p&gt;
&lt;div class="admonition admonition-my-gaming-history"&gt;
&lt;p class="admonition-title"&gt;My Gaming History&lt;/p&gt;
&lt;p&gt;My experience with Traveller back in the 1980s was minimal: another
friend had the little black box with the three little black books
(LBBs), and we rolled up characters (which at the time seemed way
more complicated than &lt;cite&gt;D&amp;amp;D&lt;/cite&gt;, which we were used to).  Then we tried
to figure out what to do, which was not immediately obvious to us.
&lt;cite&gt;D&amp;amp;D&lt;/cite&gt; has the obvious core activity of going down in a dungeon and
killing monsters, but Traveller was a lot more wide-open.  My
friend hadn't bought an adventure (which I find very useful for
getting an idea of core activity of a game) and he'd bought the
&lt;cite&gt;Basic Set&lt;/cite&gt;, so there wasn't an adventure in the box.  We didn't
realize that we could use the various checklists and procedures to
improvise an adventure on the spot.  So we didn't get far, alas.&lt;/p&gt;
&lt;p&gt;I bought several new editions of Traveller over the years
(&lt;cite&gt;Megatraveller&lt;/cite&gt;, &lt;cite&gt;Traveller: The New Era&lt;/cite&gt;, &lt;cite&gt;Traveller 4, Traveller
5&lt;/cite&gt;) but never found the chance to play them.  But my interest in
Classic Traveller grew once I found it being talked about in
Internet forums and blogs.  I bought a copy of the original rules
and many other LBBs, and some of the farfuture.net reprints and
CD-ROMs.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Anyway, yesterday afternoon I went over to my friend's house with my
&lt;cite&gt;Starter Traveller&lt;/cite&gt; box and some other Classic Traveller materials for
show and tell, and then we rolled up three characters each, 2D6 for
attributes in order.  I had two survive character generation (because
we were using the hardcore “you can die in character generation” rule
that was the default in Classic Traveller), both had been in the Army,
both having miserable strengths (one of them couldn't carry his rifle
&lt;strong&gt;and&lt;/strong&gt; a clip of ammo; don't know how he made it through the Army),
and the weakest only had one term and the other only had two terms,
though he made Lieutenant.  My friend had one character survive
character generation, also from the Army, and he had more terms that
either of my characters, though I don't remember how many, and ended
up a Lt. Colonel if I remember correctly.&lt;/p&gt;
&lt;p&gt;Then we ran a practice combat between my friend's character and my
better character: Submachine Guns at short range (1–5 meters) in a
forest!  Classic Traveller doesn't have initiative, so everything
happens simultaneously, and we both shot the other and each had an
attribute reduced to zero, so we both fell unconscious.  After ten
minutes we both woke up, and decided to &lt;strong&gt;not&lt;/strong&gt; try to kill each other
again.  Since he had Medical-1 he used his medical kit and healed us
both.&lt;/p&gt;
&lt;p&gt;Then we tried our hand at what some think is &lt;cite&gt;Traveller&lt;/cite&gt;‘s core
activity: shipping cargo to another planet (once we finally figured
out that standard shipping of non-speculative cargo is covered in the
“REVENUE” subsection of “STARSHIP ECONOMICS”, and not near “TRADE AND
COMMERCE” section that we mistakenly thought it would be near).  So,
we rolled up some cargoes and High, Middle, and Low passages for our
arbitrarily chosen world.  Then we worked out all the expenses for our
ship, the standard Type-A Free Trader, to see if we could keep up with
them.  And we could, though there seemed to be little slack.  Success!
This lead us back to the “REQUIRED STARSHIP COMPONENTS” subsection of
the “STARSHIPS” section to figure out how much fuel was available for
maneuvering in-system after a jump.  (10 tons out of 30 tons of fuel
was available for the maneuver drive and the power plant, if I
remember correctly.)  We looked at speculative cargoes a bit, but
didn't actually try them.  We weren't sure how you found the selling
price once you were at your destination.  (A second roll on the
“Actual Value” table?)&lt;/p&gt;
&lt;p&gt;At some point we looked at experience and character development in
Classic Traveller.  As far as we can tell, that section is missing
from &lt;cite&gt;Starter Traveller&lt;/cite&gt;, though it is in the 1981 LBBs and &lt;cite&gt;The
Traveller Book&lt;/cite&gt;.  (Is it in the 1977 LBBs?  I'll have to
check. &lt;a class="footnote-reference brackets" href="https://tkurtbond.github.io/posts/2020/03/16/playing-classic-traveller-in-2020/#megatraveller" id="id1"&gt;1&lt;/a&gt;) Anyway, basically you do a 4 year
self-improvement program, and if you succeed in staying the program
(Roll your Determination, and you need an 8+ on 2D6), the program
improves a couple of skills temporarily by 1 level of expertise.  You
can then do another 4 year program to make those gains permanent.
(There are similar but slightly different procedures for improving
physical attributes, weapons skills, and education.)&lt;/p&gt;
&lt;p&gt;Anyway, we had a lot of fun.  Next time we get together we're going to
design a starship or two and try space combat!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="reflections-afterward"&gt;
&lt;h2&gt;Reflections Afterward&lt;/h2&gt;
&lt;p&gt;The version of &lt;cite&gt;Starter Traveller&lt;/cite&gt; available at DrivethruRPG.com seems
to be a better scan than the one off the Classic Traveller CD-Rom at
&lt;a class="reference external" href="https://www.farfuture.net/"&gt;farfuture.net&lt;/a&gt;, and is arranged in three separate PDF files, one for
each of the three books in the set, which is much more convenient for
printing and for viewing more than one at once on a screen.  Alas,
neither of them had select-able text, each page being a scanned image.&lt;/p&gt;
&lt;p&gt;I had brought my copy of the 1977 edition of Classic Traveller, 3
digest sized (5½×8½ inches) booklets in the classic box, along with
some of the other books/supplements/adventures in that format, the
Quick Link Interactive reprint of the 1981 LBBs in one volume, and the
hardcover edition of &lt;cite&gt;The Traveller Book&lt;/cite&gt;.  I find the pamphlet format
of the original Classic Traveller books charming: they're an easy size
for reading away from the table, they seem to have lasted pretty well
over the years, and it is relatively easy to refer to two of them at
once.  On the other hand, &lt;cite&gt;Starter Traveller&lt;/cite&gt;'s division into a book
of the &lt;cite&gt;Core Rules&lt;/cite&gt;, another book of &lt;cite&gt;Charts and Tables&lt;/cite&gt;, and a final
book with adventures, is very handy at the table where you have room
enough to have both &lt;cite&gt;Core Rules&lt;/cite&gt; open and &lt;cite&gt;Charts and Tables&lt;/cite&gt; open to
the the specific pages for the tables matching what you're reading in
&lt;cite&gt;Core Rules&lt;/cite&gt;.  Also &lt;cite&gt;Starter Traveller&lt;/cite&gt; has a “TYPICAL ACTIVITIES”
checklist on p. 9 of &lt;cite&gt;Charts and Tables&lt;/cite&gt; (that I can't find in the
3LBBs) that basically outlines how you could improvise a Free
Trader-based adventure at the table.  The hardback &lt;cite&gt;The Traveller
Book&lt;/cite&gt; is sturdy and easy to use at the table, but not as convenient as
&lt;cite&gt;Starter Traveller&lt;/cite&gt;‘s split into &lt;cite&gt;Core Rules&lt;/cite&gt; and &lt;cite&gt;Charts and
Tables&lt;/cite&gt;.  The &lt;cite&gt;Core Rules&lt;/cite&gt; booklet had helpful page references to
&lt;cite&gt;Charts and Tables&lt;/cite&gt; for each of the major sections, and these were
usually a 2-page spread with all (or nearly all) of the tables for the
subject being discussed.  Despite the charming nature of the LBBs, I
think having the separate &lt;cite&gt;Charts and Tables&lt;/cite&gt; book from &lt;cite&gt;Starter
Traveller&lt;/cite&gt; is so convenient that we'll continue using it at the table.&lt;/p&gt;
&lt;p&gt;I found it useful to have multiple versions of Traveller available
while reading &lt;cite&gt;Starter Traveller&lt;/cite&gt; to cross-check things: I found an
erratum in &lt;cite&gt;Starter Traveller&lt;/cite&gt; this way.&lt;/p&gt;
&lt;dl class="footnote brackets"&gt;
&lt;dt class="label" id="megatraveller"&gt;&lt;span class="brackets"&gt;&lt;a class="fn-backref" href="https://tkurtbond.github.io/posts/2020/03/16/playing-classic-traveller-in-2020/#id1"&gt;1&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;I remembered that &lt;cite&gt;Megatraveller&lt;/cite&gt; had a different
method for character advancement/experience, so I looked that up
when I got home.&lt;/p&gt;
&lt;p&gt;You can learn a new skill by experience, observing and trying that
skill and gaining 1 Adventure Tally (AT) per session if the referee
it played a significant part in the session.  Once you've acquired
enough ATs, you need to roll a 15 or more on 2D6 with a Dice
Modifier (DM) from Intelligence (if it is high enough) and the
number of ATs you've accumulated.  Use the same procedure to
improve a skill.  There is a similar procedure for improving
characteristics.  (This is similar to getting skill “Ticks” in
RuneQuest or other &lt;cite&gt;Basic Roleplaying&lt;/cite&gt;-based systems.)&lt;/p&gt;
&lt;p&gt;You could also learn a skill by formal training. &lt;strong&gt;(1)&lt;/strong&gt; You have
to roll 7+ on 2D6 (having an applicable skill gives you a DM; the
skill depends on what kind of training you're seeking) to find the
training.  &lt;strong&gt;(2)&lt;/strong&gt; You have to roll 7+ on 2D6 (with a DM from your
Determination characteristic) to stay determined to complete the
training.  Finally, &lt;strong&gt;(3)&lt;/strong&gt; You have to roll to see if you were
successful by rolling 11+ on 2D6 (with DMs from the skill you are
training if you already have it, or other related skills you
already know, and your instructors Instruction skill).  The
training takes on average 200 hours, and costs approximately Cr10
per hour.  There is a similar procedure for improving
characteristics, except for Social Standing, which can only be
improved by actually acquiring money and spending it.&lt;/p&gt;
&lt;p&gt;Amusingly &lt;cite&gt;Megatraveller&lt;/cite&gt;, in contrast to Classic Traveller's
relative lack of character improvement, points out that increasing
skills and characteristics by accumulating ATs encourages
characters' participation, keeps them interested in the game, and
makes them aware of the benefits they can achieve in a session.
I'll note that this is just like leveling in &lt;cite&gt;D&amp;amp;D&lt;/cite&gt; or getting
experience points in skill based games like &lt;cite&gt;Hero System&lt;/cite&gt; or
&lt;cite&gt;GURPS&lt;/cite&gt;.&lt;/p&gt;
&lt;p&gt;Finally, my quick look through the &lt;cite&gt;Megatraveller&lt;/cite&gt; &lt;cite&gt;Players'
Manual&lt;/cite&gt; gave me the impression that &lt;cite&gt;Megatraveller&lt;/cite&gt; is just much
more complicated that Classic Traveller in every way, a typical
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Second-system_effect"&gt;second-system effect&lt;/a&gt;.&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>b</category><category>classic traveller</category><category>d&amp;d</category><category>gurps</category><category>hero system</category><category>my gaming history</category><category>rpg</category><category>starter traveller</category><guid>https://tkurtbond.github.io/posts/2020/03/16/playing-classic-traveller-in-2020/</guid><pubDate>Mon, 16 Mar 2020 14:11:52 GMT</pubDate></item><item><title>TAS Form 2 Revised at Tales To Astonish</title><link>https://tkurtbond.github.io/posts/2020/03/15/tas-form-2-revised-at-tales-to-astonish/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;p&gt;The Tales to Astonish blog has an &lt;a class="reference external" href="https://talestoastound.wordpress.com/2015/01/16/modified-character-sheet-for-classic-traveller/"&gt;article&lt;/a&gt; with a revised version of
TAS Form 2, the character sheet for Traveller.  The article
includes a direct link to a fairly large JPG (in height and width, not
data size) that thus can be printed. &lt;a class="footnote-reference brackets" href="https://tkurtbond.github.io/posts/2020/03/15/tas-form-2-revised-at-tales-to-astonish/#seann" id="id1"&gt;1&lt;/a&gt; It has places for each weapon to
write the modifiers for each type of armor, each range, the required
attribute and the Dice Modifier (DM) for if you are under the required
level, the advantageous attribute and the DM for if you meet or are
over the advantageous level, where it delivers a blow, a swing, or a
shot, the weakened blow or swing DM, and the hits of damage a
successful blow does.  Having this information for each weapon on the
character sheet so you don't have to look it up each combat is very
useful.&lt;/p&gt;
&lt;dl class="footnote brackets"&gt;
&lt;dt class="label" id="seann"&gt;&lt;span class="brackets"&gt;&lt;a class="fn-backref" href="https://tkurtbond.github.io/posts/2020/03/15/tas-form-2-revised-at-tales-to-astonish/#id1"&gt;1&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;He links to a blog &lt;a class="reference external" href="http://seann-mcanally.blogspot.com/2010/07/tas-form-2-revised.html"&gt;post&lt;/a&gt; that seems to be the original
source of that character sheet, which is on a blog only open to
invited readers now, but the Internet Archive has the blog page
&lt;a class="reference external" href="https://web.archive.org/web/20180910140807/http://seann-mcanally.blogspot.com/2010/07/tas-form-2-revised.html"&gt;saved&lt;/a&gt;, and on it there is a &lt;a class="reference external" href="http://www.gonensworld.com/seann/tas-form2-revised.pdf"&gt;link&lt;/a&gt; to the PDF.  The Internet
Archive didn't have the PDF saved, but the original link itself
still worked.  I also added &lt;a class="reference external" href="https://web.archive.org/web/20200316034554/http://www.gonensworld.com/seann/tas-form2-revised.pdf"&gt;it&lt;/a&gt; to the Internet Archive, so
hopefully it is saved forever.&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;&lt;/div&gt;</description><category>character sheet</category><category>classic traveller</category><category>rpg</category><category>traveller</category><guid>https://tkurtbond.github.io/posts/2020/03/15/tas-form-2-revised-at-tales-to-astonish/</guid><pubDate>Mon, 16 Mar 2020 03:22:43 GMT</pubDate></item><item><title>Interesting Article Found Recently</title><link>https://tkurtbond.github.io/posts/2020/03/14/interesting-article-found-recently/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;p&gt;I found an interesting &lt;a class="reference external" href="https://dmrbooks.com/test-blog/2019/12/29/sword-amp-planet-a-genre-of-mashups"&gt;article&lt;/a&gt; on &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Sword_and_planet"&gt;Sword &amp;amp; Planet&lt;/a&gt; fiction.&lt;/p&gt;</description><category>planetary romance</category><category>sword &amp; planet</category><guid>https://tkurtbond.github.io/posts/2020/03/14/interesting-article-found-recently/</guid><pubDate>Sat, 14 Mar 2020 22:04:20 GMT</pubDate></item><item><title>Recent Reading: Under the Green Star</title><link>https://tkurtbond.github.io/posts/2020/03/13/recent-reading-under-the-green-star/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;Under the Green Star&lt;/cite&gt;, by Lin Carter, copyright 1972; DAW Books No. 30.&lt;/p&gt;
&lt;p&gt;This is a slight volume, with only 144 pages long, and is a member
of the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Sword_and_planet"&gt;Sword &amp;amp; Planet&lt;/a&gt; genre.  It is an enjoyable action tale,
obviously influenced by &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Edgar_Rice_Burroughs"&gt;Edgar Rice Burroughs&lt;/a&gt;'s &lt;a class="reference external" href="https://en.wikipedia.org/wiki/John_Carter_of_Mars"&gt;John Carter of
Mars&lt;/a&gt; stories.  While perhaps not the equal of the John Carter of
Mars stories, it has attractions of its own.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;While reading &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2020/03/01/recent-reading-flame-and-crimson/"&gt;Flame &amp;amp; Crimson&lt;/a&gt; I was reminded of many &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Sword_and_sorcery"&gt;Sword &amp;amp;
Sorcery&lt;/a&gt; authors, and was introduced to many new ones.  I decided
that I needed to reread and read anew these authors.  Along the way I
broadened my ambit to include Sword &amp;amp; Planet authors, and have begun
with this Lin Carter volume.&lt;/p&gt;&lt;/div&gt;</description><category>edgar rice burroughs</category><category>john carter of mars</category><category>lin carter</category><category>sword &amp; planet</category><category>sword &amp; sorcery</category><guid>https://tkurtbond.github.io/posts/2020/03/13/recent-reading-under-the-green-star/</guid><pubDate>Sat, 14 Mar 2020 00:45:09 GMT</pubDate></item><item><title>Making digest-sized pages with pandoc and ms output</title><link>https://tkurtbond.github.io/posts/2020/03/13/making-digest-sized-pages-with-pandoc-and-ms-output/</link><dc:creator>T. Kurt Bond</dc:creator><description>&lt;div&gt;&lt;div class="admonition note"&gt;
&lt;p class="admonition-title"&gt;Note&lt;/p&gt;
&lt;p&gt;After I wrote this post, I made a last minute check of the options
to &lt;span class="app"&gt;pandoc&lt;/span&gt; and found that the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;--pdf-engine-opt=&lt;/span&gt;&lt;/code&gt; option
does exactly what I want.  How embarrassing.  So I changed this
post, showing both the easy way and the hard way to do it.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;I use &lt;a class="reference external" href="https://pandoc.org/"&gt;pandoc&lt;/a&gt; to produce digest-sized pages (5½×8½ inches) in PDF
documents from &lt;a class="reference external" href="https://en.wikipedia.org/wiki/ReStructuredText"&gt;ReStructuredText&lt;/a&gt;.  I have a &lt;span class="app"&gt;ms&lt;/span&gt; output template,
&lt;span class="file"&gt;digest2.ms&lt;/span&gt; in &lt;span class="file"&gt;~/pandoc/templates&lt;/span&gt; that sets the page
width and page height correctly.  Unfortunately, there is no way to
set the papersize properly in the template. &lt;a class="footnote-reference brackets" href="https://tkurtbond.github.io/posts/2020/03/13/making-digest-sized-pages-with-pandoc-and-ms-output/#heirloomtroff" id="id1"&gt;1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Luckily, &lt;span class="app"&gt;pandoc&lt;/span&gt; has the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;--pdf-engine-opt=&lt;/span&gt;&lt;/code&gt; option to pass
options to the PDF engine that &lt;span class="app"&gt;pandoc&lt;/span&gt; is using, in this case
&lt;span class="app"&gt;pdfroff&lt;/span&gt;.  In the case of &lt;span class="app"&gt;ms&lt;/span&gt; output the thing to do is
pass the argument &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;--pdf-engine-opt=-P-p8.5i,5.5i&lt;/span&gt;&lt;/code&gt; &lt;a class="footnote-reference brackets" href="https://tkurtbond.github.io/posts/2020/03/13/making-digest-sized-pages-with-pandoc-and-ms-output/#recursively" id="id2"&gt;2&lt;/a&gt;,
like below.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://tkurtbond.github.io/listings/GNUmakefile.pandoc-digest-pdf-engine-opt.html"&gt;GNUmakefile.pandoc-digest-pdf-engine-opt&lt;/a&gt;  &lt;a class="reference external" href="https://tkurtbond.github.io/listings/GNUmakefile.pandoc-digest-pdf-engine-opt"&gt;(Source)&lt;/a&gt;&lt;/p&gt;
&lt;pre class="code make"&gt;&lt;a name="rest_code_5a65b95088cf441a969e67aec685c364-1"&gt;&lt;/a&gt;&lt;span class="nf"&gt;%.digest.ms.pdf &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; %.&lt;span class="n"&gt;rst&lt;/span&gt;
&lt;a name="rest_code_5a65b95088cf441a969e67aec685c364-2"&gt;&lt;/a&gt;        pandoc -s -r rst -w ms --template&lt;span class="o"&gt;=&lt;/span&gt;digest2 &lt;span class="k"&gt;$(&lt;/span&gt;VARIABLES&lt;span class="k"&gt;)&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_5a65b95088cf441a969e67aec685c364-3"&gt;&lt;/a&gt;                --output&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt; --pdf-engine-opt&lt;span class="o"&gt;=&lt;/span&gt;-P-p8.5i,5.5i $&amp;lt;
&lt;/pre&gt;&lt;p&gt;Unfortunately when I originally had this need for digest pages I
hadn't realized that the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;--pdf-engine-opt=&lt;/span&gt;&lt;/code&gt; option existed.&lt;/p&gt;
&lt;p&gt;So I used &lt;code class="docutils literal"&gt;pandoc &lt;span class="pre"&gt;--verbose&lt;/span&gt;&lt;/code&gt; and found the &lt;span class="app"&gt;pdfroff&lt;/span&gt; invocation
&lt;span class="app"&gt;pandoc&lt;/span&gt; uses, and made my &lt;span class="app"&gt;pandoc&lt;/span&gt; invocation output
&lt;span class="app"&gt;ms&lt;/span&gt; instead of PDF, then passed it through a &lt;span class="app"&gt;pdfroff&lt;/span&gt;
command with the added &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-P-p8.5i,5.5i&lt;/span&gt;&lt;/code&gt; argument.  Here's what I put
in my &lt;span class="file"&gt;GNUmakefile&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://tkurtbond.github.io/listings/GNUmakefile.pandoc-digest-save-ms.html"&gt;GNUmakefile.pandoc-digest-save-ms&lt;/a&gt;  &lt;a class="reference external" href="https://tkurtbond.github.io/listings/GNUmakefile.pandoc-digest-save-ms"&gt;(Source)&lt;/a&gt;&lt;/p&gt;
&lt;pre class="code make"&gt;&lt;a name="rest_code_d5dd0856f39440da89e5b4d09932f3bc-1"&gt;&lt;/a&gt;&lt;span class="nf"&gt;%.digest.ms.pdf &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; %.&lt;span class="n"&gt;rst&lt;/span&gt;
&lt;a name="rest_code_d5dd0856f39440da89e5b4d09932f3bc-2"&gt;&lt;/a&gt;        pandoc -s -r rst -w ms -s --template&lt;span class="o"&gt;=&lt;/span&gt;digest2 &lt;span class="k"&gt;$(&lt;/span&gt;VARIABLES&lt;span class="k"&gt;)&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d5dd0856f39440da89e5b4d09932f3bc-3"&gt;&lt;/a&gt;               --output&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;.ms $&amp;lt;
&lt;a name="rest_code_d5dd0856f39440da89e5b4d09932f3bc-4"&gt;&lt;/a&gt;        pdfroff -ms -mpdfmark -e -t -k -KUTF-8 --no-toc-relocation &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d5dd0856f39440da89e5b4d09932f3bc-5"&gt;&lt;/a&gt;                -P-p8.5i,5.5i &lt;span class="nv"&gt;$*&lt;/span&gt;.ms &amp;gt; &lt;span class="nv"&gt;$@&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Or, if you don't care about having the &lt;span class="app"&gt;ms&lt;/span&gt; output for debugging,
you could do it as a pipeline:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://tkurtbond.github.io/listings/GNUmakefile.pandoc-digest-pipeline.html"&gt;GNUmakefile.pandoc-digest-pipeline&lt;/a&gt;  &lt;a class="reference external" href="https://tkurtbond.github.io/listings/GNUmakefile.pandoc-digest-pipeline"&gt;(Source)&lt;/a&gt;&lt;/p&gt;
&lt;pre class="code make"&gt;&lt;a name="rest_code_f39314aab2a64179b2106446ce792930-1"&gt;&lt;/a&gt;&lt;span class="nf"&gt;%.digest.ms.pdf &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; %.&lt;span class="n"&gt;rst&lt;/span&gt;
&lt;a name="rest_code_f39314aab2a64179b2106446ce792930-2"&gt;&lt;/a&gt;        pandoc -s -r rst -w ms -s --template&lt;span class="o"&gt;=&lt;/span&gt;digest2 &lt;span class="k"&gt;$(&lt;/span&gt;VARIABLES&lt;span class="k"&gt;)&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_f39314aab2a64179b2106446ce792930-3"&gt;&lt;/a&gt;               --output&lt;span class="o"&gt;=&lt;/span&gt;- $&amp;lt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_f39314aab2a64179b2106446ce792930-4"&gt;&lt;/a&gt;        pdfroff -ms -mpdfmark -e -t -k -KUTF-8 --no-toc-relocation &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_f39314aab2a64179b2106446ce792930-5"&gt;&lt;/a&gt;                -P-p8.5i,5.5i - &amp;gt;&lt;span class="nv"&gt;$@&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;There are still some instances where this technique of having
&lt;span class="app"&gt;pandoc&lt;/span&gt; output the &lt;span class="app"&gt;ms&lt;/span&gt; source directly and pass it through
&lt;span class="app"&gt;pdfroff&lt;/span&gt; yourself.  For instance, if you have to do some
massaging of the &lt;span class="app"&gt;ms&lt;/span&gt; source, like changing &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;.RS/.RE&lt;/span&gt;&lt;/code&gt; to
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;.QS/.QE&lt;/span&gt;&lt;/code&gt; to get around the problem with block quotes in &lt;span class="app"&gt;ms&lt;/span&gt;
output in the current &lt;span class="app"&gt;pandoc&lt;/span&gt; release, discussed &lt;a class="reference external" href="https://tkurtbond.github.io/posts/2020/03/11/pandoc-discuss-post-can-the-rsre-macros-in-ms-output-be-replaced-with-qsqe/"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;dl class="footnote brackets"&gt;
&lt;dt class="label" id="heirloomtroff"&gt;&lt;span class="brackets"&gt;&lt;a class="fn-backref" href="https://tkurtbond.github.io/posts/2020/03/13/making-digest-sized-pages-with-pandoc-and-ms-output/#id1"&gt;1&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;Heirloom Troff (originally at &lt;a class="reference external" href="http://heirloom.sourceforge.net/doctools.html"&gt;H1&lt;/a&gt;, but now &lt;em&gt;I
think&lt;/em&gt; more up to date at &lt;a class="reference external" href="http://n-t-roff.github.io/heirloom/doctools.html"&gt;H2&lt;/a&gt; and &lt;a class="reference external" href="https://github.com/n-t-roff/heirloom-doctools"&gt;H3&lt;/a&gt;) has the &lt;code class="docutils literal"&gt;.mediasize&lt;/code&gt; and
&lt;code class="docutils literal"&gt;.papersize&lt;/code&gt; commands for that.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt class="label" id="recursively"&gt;&lt;span class="brackets"&gt;&lt;a class="fn-backref" href="https://tkurtbond.github.io/posts/2020/03/13/making-digest-sized-pages-with-pandoc-and-ms-output/#id2"&gt;2&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;Amusingly, &lt;span class="app"&gt;pandoc&lt;/span&gt; passes the
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;--pdf-engine-opt=-P-p8.5i,5.5i&lt;/span&gt;&lt;/code&gt; argument to &lt;span class="app"&gt;pdfroff&lt;/span&gt;,
which passes the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-P-p8.5i,5.5i&lt;/span&gt;&lt;/code&gt; part to &lt;span class="app"&gt;groff&lt;/span&gt;, which
passes the &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-p8.5i,5.5i&lt;/span&gt;&lt;/code&gt; part to the (final) post processor — I'm
not sure if &lt;em&gt;that&lt;/em&gt; is &lt;span class="app"&gt;grops&lt;/span&gt; or &lt;span class="app"&gt;gropdf&lt;/span&gt;.&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;&lt;/div&gt;</description><category>computer</category><category>groff</category><category>make</category><category>ms macros</category><category>pandoc</category><category>pdfroff</category><category>text processing</category><guid>https://tkurtbond.github.io/posts/2020/03/13/making-digest-sized-pages-with-pandoc-and-ms-output/</guid><pubDate>Fri, 13 Mar 2020 18:01:10 GMT</pubDate></item></channel></rss>