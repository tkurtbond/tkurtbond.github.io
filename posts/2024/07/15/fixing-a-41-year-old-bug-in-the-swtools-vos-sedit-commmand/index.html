<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fixing a 41 year old bug in the SWTOOLS VOS SEDIT commmand | Lacking Natural Simplicity</title>
<link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">
<link rel="alternate" type="application/atom+xml" title="Atom" href="../../../../../feed.atom">
<link rel="canonical" href="https://tkurtbond.github.io/posts/2024/07/15/fixing-a-41-year-old-bug-in-the-swtools-vos-sedit-commmand/">
<!--[if lt IE 9]><script src="../../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="T. Kurt Bond">
<link rel="prev" href="../../03/how-the-lbl-software-tools-system-organized-its-source-files/" title="How the LBL Software Tools system organized its source files" type="text/html">
<meta property="og:site_name" content="Lacking Natural Simplicity">
<meta property="og:title" content="Fixing a 41 year old bug in the SWTOOLS VOS SEDIT commmand">
<meta property="og:url" content="https://tkurtbond.github.io/posts/2024/07/15/fixing-a-41-year-old-bug-in-the-swtools-vos-sedit-commmand/">
<meta property="og:description" content="Today I fixed a 41 year old bug in the SWTOOLS VOS sedit commmand!
At work part of my job is to maintain an emulated VAX/VMS 5.5-2 system
for one of our clients.  I have been using the SWTOOLS Virtual">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2024-07-15T14:09:45-04:00">
<meta property="article:tag" content="fortran">
<meta property="article:tag" content="lbl tools">
<meta property="article:tag" content="ratfor">
<meta property="article:tag" content="software tools">
<meta property="article:tag" content="software tools virtual operating system">
<meta property="article:tag" content="swtools">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Crimson+Text&amp;family=Lato&amp;family=IBM+Plex+Mono" rel="stylesheet">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<div class="blog-masthead">
    <div class="container">
<!-- This keeps the margins nice -->
        <nav class="blog-nav" role="navigation"><a href="../../../../../index.html" class="blog-nav-item">Home</a>
            <a href="../../../../../archive.html" class="blog-nav-item">Archives</a>
            <a href="../../../../../categories/index.html" class="blog-nav-item">Tags &amp; Categories</a>
            <a href="../../../../../rss.xml" class="blog-nav-item">RSS feed</a>
            <a href="../../../../../feed.atom" class="blog-nav-item">Atom feed</a>

            

    <a href="index.rst" class="blog-nav-item blog-nav-item-aside" id="sourcelink">Source</a>
                
            
        </nav>
</div>
<!-- /.container -->
</div>
<!-- End of Menubar -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <div class="blog-header">
            <h1 class="blog-title">
                <a href="https://tkurtbond.github.io/">

                    <span id="blog-title">Lacking Natural Simplicity</span>
                </a>
            </h1>
            <p class="lead blog-description">Random musings on books, code, and tabletop games.</p>
            
        </div>
        <!--Body content-->
        <div class="row">
            <div class="col-sm-8 blog-main">
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h2 class="p-name entry-title blog-post-title" itemprop="headline name"><a href="." class="u-url">Fixing a 41 year old bug in the SWTOOLS VOS SEDIT commmand</a></h2>

        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">T. Kurt Bond</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2024-07-15T14:09:45-04:00" itemprop="datePublished" title="2024-07-15 14:09">2024-07-15 14:09</time></a></p>
                <p class="commentline">        <a href="#disqus_thread" data-disqus-identifier="cache/posts/2024/07/15/fixing-a-41-year-old-bug-in-the-swtools-vos-sedit-commmand.html">Comments</a>


                    </p>
<p class="sourceline"><a href="index.rst" id="sourcelink">Source</a></p>

        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Today I fixed a 41 year old bug in the SWTOOLS VOS <span class="command">sedit</span> commmand!</p>
<p>At work part of my job is to maintain an emulated VAX/VMS 5.5-2 system
for one of our clients.  I have been using the SWTOOLS Virtual
Operating System <a class="reference external" href="../../03/software-tools/">recently</a> (Unix style
I/O redirection! And pipes!), and whenever I tried to use the sedit
command it would die with an integer overflow:</p>
<pre class="literal-block">%SYSTEM-F-INTOVF, arithmetic trap, integer overflow at PC=0002D6C9, PSL=03C00022

Improperly handled condition, image exit forced.

      Signal arguments              Stack contents

      Number = 00000003                00000000
      Name   = 0000047C                08000020
               0002D6C9                000017C4
               03C00022                7FEF9784
                                       0002D479
                                       00001DC0
                                       00000000
                                       08000020
                                       7FEF97B4
                                       7FEF979C

      Register dump

      R0 = 0000000E  R1 = 0002BAF4  R2 = 0000000F  R3 = 7FF6A489
      R4 = 7FFE5E0C  R5 = 7FFE5EBC  R6 = 00000000  R7 = 00000001
      R8 = 7FFECA4C  R9 = 7FFECC54  R10= 7FFED7D4  R11= 00001E94
      AP = 7FEF9738  FP = 7FEF96F8  SP = 7FEF976C  PC = 0002D6C9
      PSL= 03C00022</pre>
<p>Drats, drats, drats.</p>
<p>I use <span class="command">sed</span> frequently on Unix, and it would be nice to have
the SWTOOLS equivalent on VAX/VMS.  What could I do but set the
<a class="reference external" href="https://en.wikipedia.org/wiki/Wayback_Machine_(Peabody%27s_Improbable_History)">Wayback Machine</a>
for 1986 and dive in!</p>
<p>Those following along may want to read my post about how the <a class="reference external" href="slug://how-the-lbl-software-tools-system-organized-its-source-files">Software Tools VOS organized its source files</a> first.</p>
<p>The SWTOOLS VOS was written in <a class="reference external" href="https://en.wikipedia.org/wiki/Ratfor">Ratfor</a>, which added structured
control structures and other niceties such as macros, include files,
and string constants to pre-1977 Fortran.  I suspect that even as late
as 1986, when the version of the SWTOOLS VOS was released, lots of
installations were on machines that only <strong>*had*</strong> pre-1977 Fortran
compilers.</p>
<p>Here's an example of <span class="app">Ratfor</span> source, from <span class="file">sedit.r</span>:</p>
<div class="code"><pre class="code fortran"><a id="rest_code_b401bc577706466c96a9d86bd14a3a24-1" name="rest_code_b401bc577706466c96a9d86bd14a3a24-1" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-1"></a><span class="cp"># copyf - copy file name to opened file fdo</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-2" name="rest_code_b401bc577706466c96a9d86bd14a3a24-2" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-2"></a><span class="k">subroutine </span><span class="n">copyf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">fdo</span><span class="p">)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-3" name="rest_code_b401bc577706466c96a9d86bd14a3a24-3" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-3"></a><span class="kt">integer </span><span class="n">name</span><span class="p">(</span><span class="n">ARB</span><span class="p">)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-4" name="rest_code_b401bc577706466c96a9d86bd14a3a24-4" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-4"></a><span class="kt">integer </span><span class="n">fdo</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-5" name="rest_code_b401bc577706466c96a9d86bd14a3a24-5" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-5"></a><span class="kt">integer </span><span class="n">fdi</span><span class="p">,</span><span class="w"> </span><span class="n">i</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-6" name="rest_code_b401bc577706466c96a9d86bd14a3a24-6" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-6"></a><span class="kt">integer </span><span class="k">open</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-7" name="rest_code_b401bc577706466c96a9d86bd14a3a24-7" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-7"></a><span class="kt">character </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">namstr</span><span class="p">(</span><span class="n">MAXLINE</span><span class="p">)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-8" name="rest_code_b401bc577706466c96a9d86bd14a3a24-8" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-8"></a><span class="kt">character </span><span class="n">getch</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-9" name="rest_code_b401bc577706466c96a9d86bd14a3a24-9" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-9"></a>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-10" name="rest_code_b401bc577706466c96a9d86bd14a3a24-10" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-10"></a><span class="n">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">name</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="c">!=EOS; i=i+1)               #get name into string</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-11" name="rest_code_b401bc577706466c96a9d86bd14a3a24-11" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-11"></a><span class="w">     </span><span class="n">namstr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-12" name="rest_code_b401bc577706466c96a9d86bd14a3a24-12" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-12"></a><span class="n">namstr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EOS</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-13" name="rest_code_b401bc577706466c96a9d86bd14a3a24-13" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-13"></a><span class="n">fdi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">open</span><span class="p">(</span><span class="n">namstr</span><span class="p">,</span><span class="w"> </span><span class="k">READ</span><span class="p">)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-14" name="rest_code_b401bc577706466c96a9d86bd14a3a24-14" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-14"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fdi</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ERR</span><span class="p">)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-15" name="rest_code_b401bc577706466c96a9d86bd14a3a24-15" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-15"></a><span class="w">   </span><span class="k">call </span><span class="n">cant</span><span class="p">(</span><span class="n">namstr</span><span class="p">)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-16" name="rest_code_b401bc577706466c96a9d86bd14a3a24-16" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-16"></a><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">getch</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">fdi</span><span class="p">)</span><span class="w"> </span><span class="c">!= EOF)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-17" name="rest_code_b401bc577706466c96a9d86bd14a3a24-17" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-17"></a><span class="w">   </span><span class="k">call </span><span class="n">putch</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">fdo</span><span class="p">)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-18" name="rest_code_b401bc577706466c96a9d86bd14a3a24-18" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-18"></a><span class="k">call close</span><span class="p">(</span><span class="n">fdi</span><span class="p">)</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-19" name="rest_code_b401bc577706466c96a9d86bd14a3a24-19" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-19"></a><span class="k">return</span>
<a id="rest_code_b401bc577706466c96a9d86bd14a3a24-20" name="rest_code_b401bc577706466c96a9d86bd14a3a24-20" href="#rest_code_b401bc577706466c96a9d86bd14a3a24-20"></a><span class="k">end</span>
</pre></div>
<p>You can tell it was inspired by Unix.</p>
<p>Here's the corresponding generated Fortran</p>
<div class="code"><pre class="code fortran"><a id="rest_code_b4b6bb99660649c2908323da632aa784-1" name="rest_code_b4b6bb99660649c2908323da632aa784-1" href="#rest_code_b4b6bb99660649c2908323da632aa784-1"></a><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">COPYF</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span><span class="w"> </span><span class="n">FDO</span><span class="p">)</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-2" name="rest_code_b4b6bb99660649c2908323da632aa784-2" href="#rest_code_b4b6bb99660649c2908323da632aa784-2"></a><span class="w">      </span><span class="kt">INTEGER </span><span class="n">NAME</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-3" name="rest_code_b4b6bb99660649c2908323da632aa784-3" href="#rest_code_b4b6bb99660649c2908323da632aa784-3"></a><span class="w">      </span><span class="kt">INTEGER </span><span class="n">FDO</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-4" name="rest_code_b4b6bb99660649c2908323da632aa784-4" href="#rest_code_b4b6bb99660649c2908323da632aa784-4"></a><span class="w">      </span><span class="kt">INTEGER </span><span class="n">FDI</span><span class="p">,</span><span class="w"> </span><span class="n">I</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-5" name="rest_code_b4b6bb99660649c2908323da632aa784-5" href="#rest_code_b4b6bb99660649c2908323da632aa784-5"></a><span class="w">      </span><span class="kt">INTEGER </span><span class="k">OPEN</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-6" name="rest_code_b4b6bb99660649c2908323da632aa784-6" href="#rest_code_b4b6bb99660649c2908323da632aa784-6"></a><span class="k">      </span><span class="kt">LOGICAL</span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">NAMSTR</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-7" name="rest_code_b4b6bb99660649c2908323da632aa784-7" href="#rest_code_b4b6bb99660649c2908323da632aa784-7"></a><span class="w">      </span><span class="kt">LOGICAL</span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="n">GETCH</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-8" name="rest_code_b4b6bb99660649c2908323da632aa784-8" href="#rest_code_b4b6bb99660649c2908323da632aa784-8"></a><span class="w">      </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-9" name="rest_code_b4b6bb99660649c2908323da632aa784-9" href="#rest_code_b4b6bb99660649c2908323da632aa784-9"></a><span class="mi">23190</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">NAME</span><span class="p">(</span><span class="n">I</span><span class="p">).</span><span class="n">NE</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span><span class="k">GOTO</span><span class="w"> </span><span class="mi">23192</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-10" name="rest_code_b4b6bb99660649c2908323da632aa784-10" href="#rest_code_b4b6bb99660649c2908323da632aa784-10"></a><span class="w">      </span><span class="n">NAMSTR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NAME</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-11" name="rest_code_b4b6bb99660649c2908323da632aa784-11" href="#rest_code_b4b6bb99660649c2908323da632aa784-11"></a><span class="mi">23191</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-12" name="rest_code_b4b6bb99660649c2908323da632aa784-12" href="#rest_code_b4b6bb99660649c2908323da632aa784-12"></a><span class="w">      </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">23190</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-13" name="rest_code_b4b6bb99660649c2908323da632aa784-13" href="#rest_code_b4b6bb99660649c2908323da632aa784-13"></a><span class="mi">23192</span><span class="w"> </span><span class="k">CONTINUE</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-14" name="rest_code_b4b6bb99660649c2908323da632aa784-14" href="#rest_code_b4b6bb99660649c2908323da632aa784-14"></a><span class="k">      </span><span class="n">NAMSTR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-15" name="rest_code_b4b6bb99660649c2908323da632aa784-15" href="#rest_code_b4b6bb99660649c2908323da632aa784-15"></a><span class="w">      </span><span class="n">FDI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">OPEN</span><span class="p">(</span><span class="n">NAMSTR</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-16" name="rest_code_b4b6bb99660649c2908323da632aa784-16" href="#rest_code_b4b6bb99660649c2908323da632aa784-16"></a><span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">FDI</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">))</span><span class="k">GOTO</span><span class="w"> </span><span class="mi">23193</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-17" name="rest_code_b4b6bb99660649c2908323da632aa784-17" href="#rest_code_b4b6bb99660649c2908323da632aa784-17"></a><span class="w">      </span><span class="k">CALL </span><span class="n">CANT</span><span class="p">(</span><span class="n">NAMSTR</span><span class="p">)</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-18" name="rest_code_b4b6bb99660649c2908323da632aa784-18" href="#rest_code_b4b6bb99660649c2908323da632aa784-18"></a><span class="mi">23193</span><span class="w"> </span><span class="k">CONTINUE</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-19" name="rest_code_b4b6bb99660649c2908323da632aa784-19" href="#rest_code_b4b6bb99660649c2908323da632aa784-19"></a><span class="mi">23195</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">GETCH</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">FDI</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="k">GOTO</span><span class="w"> </span><span class="mi">23196</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-20" name="rest_code_b4b6bb99660649c2908323da632aa784-20" href="#rest_code_b4b6bb99660649c2908323da632aa784-20"></a><span class="w">      </span><span class="k">CALL </span><span class="n">PUTCH</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">FDO</span><span class="p">)</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-21" name="rest_code_b4b6bb99660649c2908323da632aa784-21" href="#rest_code_b4b6bb99660649c2908323da632aa784-21"></a><span class="w">      </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">23195</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-22" name="rest_code_b4b6bb99660649c2908323da632aa784-22" href="#rest_code_b4b6bb99660649c2908323da632aa784-22"></a><span class="mi">23196</span><span class="w"> </span><span class="k">CONTINUE</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-23" name="rest_code_b4b6bb99660649c2908323da632aa784-23" href="#rest_code_b4b6bb99660649c2908323da632aa784-23"></a><span class="k">      CALL CLOSE</span><span class="p">(</span><span class="n">FDI</span><span class="p">)</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-24" name="rest_code_b4b6bb99660649c2908323da632aa784-24" href="#rest_code_b4b6bb99660649c2908323da632aa784-24"></a><span class="w">      </span><span class="k">RETURN</span>
<a id="rest_code_b4b6bb99660649c2908323da632aa784-25" name="rest_code_b4b6bb99660649c2908323da632aa784-25" href="#rest_code_b4b6bb99660649c2908323da632aa784-25"></a><span class="k">      END</span>
</pre></div>
<p>Notice that the <code class="docutils literal">character</code> variables got changed to <code class="docutils literal">LOGICAL*1</code>?
That turns out to be 1 byte variable...</p>
<p>So, to start, I needed to run sedit in the debugger.  That's easy
enough:</p>
<pre class="literal-block">% cd ~tmp
% mkdir sedit
% cd sedit
/dua1/software/swtools/tmp/sedit/
% get -r1.5 ~src/sedit.tcs &gt;sedit.w
% ar xv sedit.w
patdef
csedit
sedit.r
sedit.fmt
% rc -d -v sedit.r
~bin/ratp1.exe sedit.r | ~bin/ratp2.exe &gt;sedit.f
~bin/fc.exe -v -d sedit.f
for/noop/object=sedit.obj/nolist/check=all/debug=all sedit.f
~bin/ld.exe -v -d sedit.obj
$ link/exe=dua1:[software.swtools.tmp.sedit]sedit.exe/debug/nomap sys$input/opti
ons
dua1:[software.swtools.tmp.sedit]sedit.obj,-
dua1:[software.swtools.bin]rlib.olb/incl=(tools$main),-
dua1:[software.swtools.bin]rlib.olb/libr
% echo Hello | sedit "s/H/J/"
%DEBUG-I-CANTCREATEMAIN, could not create the debugger subprocess
%DEBUG-I-CANTCREATEMAIN, could not create the debugger subprocess
-LIB-F-NOCLI, no CLI present to perform function
-LIB-F-NOCLI, no CLI present to perform function
%DEBUG-I-SHRPRC, debugger will share user process
%DEBUG-I-SHRPRC, debugger will share user process

         VAX DEBUG Version V5.5-023

%DEBUG-I-INITIAL, language is MACRO, module set to TOOLS$MAIN

DBG&gt; go
%DEBUG-I-DYNMODSET, setting module DOCOM
%SYSTEM-F-INTOVF, arithmetic trap, integer overflow at PC=0002E345, PSL=03C00022
break on unhandled exception preceding DOCOM\%LINE 20
    20:       IF (.NOT.(CMD .EQ. 97))GOTO 23162
DBG&gt; go
%DEBUG-I-DYNMODSET, setting module DOCOM
%SYSTEM-F-INTOVF, arithmetic trap, integer overflow at PC=0002E345, PSL=03C00022
break on unhandled exception preceding DOCOM\%LINE 20
    20:       IF (.NOT.(CMD .EQ. 97))GOTO 23162
DBG&gt;</pre>
<p>I guess we'll need a little more context.</p>
<div class="code"><pre class="code text"><a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-1" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-1" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-1"></a>DBG&gt; type docom\1:20
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-2" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-2" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-2"></a>module DOCOM
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-3" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-3" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-3"></a>     1:       SUBROUTINE DOCOM(I, LINBUF, LINENO)
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-4" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-4" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-4"></a>     2:       LOGICAL*1 LINBUF(2048)
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-5" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-5" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-5"></a>     3:       INTEGER I, LINENO
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-6" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-6" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-6"></a>     4:       LOGICAL*1 CMD
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-7" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-7" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-7"></a>     5:       INTEGER K1, K2
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-8" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-8" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-8"></a>     6:       INTEGER AQ
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-9" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-9" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-9"></a>     7:       INTEGER IQ
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-10" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-10" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-10"></a>     8:       INTEGER BUF
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-11" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-11" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-11"></a>     9:       INTEGER LASTBF
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-12" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-12" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-12"></a>    10:       INTEGER NLINES
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-13" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-13" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-13"></a>    11:       INTEGER LINE1
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-14" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-14" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-14"></a>    12:       INTEGER LINE2
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-15" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-15" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-15"></a>    13:       INTEGER PAT
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-16" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-16" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-16"></a>    14:       INTEGER PREVC
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-17" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-17" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-17"></a>    15:       INTEGER NFLAG
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-18" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-18" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-18"></a>    16:       INTEGER QFLAG
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-19" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-19" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-19"></a>    17:       COMMON /CSEDIT/ AQ, IQ, BUF(20000), LASTBF, NLINES, LINE1, LINE2,
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-20" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-20" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-20"></a>    18:      *PAT(132), PREVC, NFLAG, QFLAG
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-21" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-21" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-21"></a>    19:       CMD = BUF(I+5)
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-22" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-22" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-22"></a>    20:       IF (.NOT.(CMD .EQ. 97))GOTO 23162
<a id="rest_code_f1b3b236708b48b2aead8719840c2ec0-23" name="rest_code_f1b3b236708b48b2aead8719840c2ec0-23" href="#rest_code_f1b3b236708b48b2aead8719840c2ec0-23"></a>DBG&gt;
</pre></div>
<p>Ok, line 19 is where the the integer overflow happened.  <code class="docutils literal">BUF</code> is an
array of <code class="docutils literal">INTEGER</code>s, while <code class="docutils literal">CMD</code> is a <code class="docutils literal">LOGICAL*1</code>, which, if I
look at the <span class="file">sedit.r</span> source:</p>
<div class="code"><pre class="code fortran"><a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-1" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-1" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-1"></a><span class="cp"># docom - execute a single command at buf(i) on linbuf and lineno</span>
<a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-2" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-2" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-2"></a><span class="w">   </span><span class="k">subroutine </span><span class="n">docom</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">linbuf</span><span class="p">,</span><span class="w"> </span><span class="n">lineno</span><span class="p">)</span>
<a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-3" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-3" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-3"></a><span class="w">   </span><span class="kt">character </span><span class="n">linbuf</span><span class="p">(</span><span class="n">MAXLINE</span><span class="p">)</span>
<a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-4" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-4" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-4"></a><span class="w">   </span><span class="kt">integer </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">lineno</span>
<a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-5" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-5" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-5"></a><span class="w">   </span><span class="kt">character </span><span class="n">cmd</span>
<a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-6" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-6" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-6"></a><span class="w">   </span><span class="kt">integer </span><span class="n">k1</span><span class="p">,</span><span class="w"> </span><span class="n">k2</span>
<a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-7" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-7" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-7"></a><span class="w">   </span><span class="k">include </span><span class="n">csedit</span>
<a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-8" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-8" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-8"></a>
<a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-9" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-9" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-9"></a><span class="w">   </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buf</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">COMMAND</span><span class="p">)</span>
<a id="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-10" name="rest_code_9884aae6ccf04c4190fe40e3f0c971d7-10" href="#rest_code_9884aae6ccf04c4190fe40e3f0c971d7-10"></a><span class="w">   </span><span class="err">…</span>
</pre></div>
<p>started as a <code class="docutils literal">character</code> and got translated to a <code class="docutils literal">LOGICAL*1</code>, the
one byte logical data type.  Normally that's ok, because we're just working
with ASCII, so any character should fit in in one byte.  Lets take a look:</p>
<div class="code"><pre class="code text"><a id="rest_code_8ccbab59d0b54e999f7cc1d440b4481c-1" name="rest_code_8ccbab59d0b54e999f7cc1d440b4481c-1" href="#rest_code_8ccbab59d0b54e999f7cc1d440b4481c-1"></a>DBG&gt; ex buf[i+5]
<a id="rest_code_8ccbab59d0b54e999f7cc1d440b4481c-2" name="rest_code_8ccbab59d0b54e999f7cc1d440b4481c-2" href="#rest_code_8ccbab59d0b54e999f7cc1d440b4481c-2"></a>DOCOM\BUF[19]:  00000173
<a id="rest_code_8ccbab59d0b54e999f7cc1d440b4481c-3" name="rest_code_8ccbab59d0b54e999f7cc1d440b4481c-3" href="#rest_code_8ccbab59d0b54e999f7cc1d440b4481c-3"></a>DBG&gt;
</pre></div>
<p>Oh dear.  That's hexadecimal 173, which is decimal 371.  No wonder we
got an arithmetic trap, integer overflow.</p>
<p>If I look for occurrences of <code class="docutils literal">buf</code> in <span class="file">sedit.r</span> (using emacs
18.55.105) I see lots of lines like where <code class="docutils literal">buf</code> is passed to
subroutine <code class="docutils literal">addint</code>, which is not documented in the manual pages,
unfortunately, but is in the runtime library <span class="file">RLIB.OLB</span>.  On
VAX/VMS the source for that is in <span class="file">~vms/rlib.w</span>:</p>
<div class="code"><pre class="code fortran"><a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-1" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-1" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-1"></a><span class="cp"># AddInt      Put int into intara if it fits, increment j</span>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-2" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-2" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-2"></a><span class="cp"># works with an array of integers</span>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-3" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-3" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-3"></a>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-4" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-4" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-4"></a><span class="kt">integer </span><span class="k">function </span><span class="n">addint</span><span class="p">(</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="w"> </span><span class="n">intara</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">maxsiz</span><span class="p">)</span>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-5" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-5" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-5"></a>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-6" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-6" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-6"></a><span class="kt">integer         </span><span class="nb">int</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">maxsiz</span><span class="p">,</span><span class="w"> </span><span class="n">intara</span><span class="p">(</span><span class="n">maxsiz</span><span class="p">)</span>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-7" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-7" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-7"></a>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-8" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-8" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-8"></a><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxsiz</span><span class="w"> </span><span class="p">)</span>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-9" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-9" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-9"></a><span class="w">  </span><span class="k">return</span><span class="p">(</span><span class="n">NO</span><span class="p">)</span>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-10" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-10" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-10"></a>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-11" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-11" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-11"></a><span class="n">intara</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-12" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-12" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-12"></a><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-13" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-13" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-13"></a>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-14" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-14" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-14"></a><span class="k">return</span><span class="p">(</span><span class="n">YES</span><span class="p">)</span>
<a id="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-15" name="rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-15" href="#rest_code_7fdcca2fa5524c2d96d23b3b8d99dd93-15"></a><span class="k">end</span>
</pre></div>
<p>Yes, that's just putting an integer in an array and incrementing the
variable that stores where the next one goes.</p>
<p>Ok, lets look at all the
<code class="docutils literal">addint</code> calls.</p>
<div class="code"><pre class="code fortran"><a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-1" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-1" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-1"></a><span class="n">Lines</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="s2">"\\baddint\\b("</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">sedit</span><span class="p">.</span><span class="n">r</span><span class="p">.</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-2" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-2" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-2"></a><span class="mi">176</span><span class="p">:</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">addint</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">maxsiz</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NO</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-3" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-3" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-3"></a><span class="mi">223</span><span class="p">:</span><span class="w">   </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">nlines</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-4" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-4" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-4"></a><span class="mi">224</span><span class="p">:</span><span class="w">   </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-5" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-5" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-5"></a><span class="mi">225</span><span class="p">:</span><span class="w">   </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-6" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-6" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-6"></a><span class="mi">226</span><span class="p">:</span><span class="w">   </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">line2</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-7" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-7" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-7"></a><span class="mi">229</span><span class="p">:</span><span class="w">      </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">NOTSTATE</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-8" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-8" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-8"></a><span class="mi">235</span><span class="p">:</span><span class="w">      </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">OKSTATE</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-9" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-9" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-9"></a><span class="mi">236</span><span class="p">:</span><span class="w">   </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">com</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-10" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-10" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-10"></a><span class="mi">238</span><span class="p">:</span><span class="w">      </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-11" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-11" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-11"></a><span class="mi">242</span><span class="p">:</span><span class="w">      </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-12" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-12" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-12"></a><span class="mi">248</span><span class="p">:</span><span class="w">      </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-13" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-13" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-13"></a><span class="mi">256</span><span class="p">:</span><span class="w">      </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-14" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-14" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-14"></a><span class="mi">260</span><span class="p">:</span><span class="w">         </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">EOS</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-15" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-15" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-15"></a><span class="mi">269</span><span class="p">:</span><span class="w">         </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">gflag</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-16" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-16" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-16"></a><span class="mi">270</span><span class="p">:</span><span class="w">         </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">pflag</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-17" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-17" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-17"></a><span class="mi">271</span><span class="p">:</span><span class="w">         </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">lastbf</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-18" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-18" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-18"></a><span class="mi">273</span><span class="p">:</span><span class="w">         </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">lastbf</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-19" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-19" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-19"></a><span class="mi">276</span><span class="p">:</span><span class="w">         </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">EOS</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-20" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-20" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-20"></a><span class="mi">286</span><span class="p">:</span><span class="w">      </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">fdw</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-21" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-21" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-21"></a><span class="mi">452</span><span class="p">:</span><span class="w">   </span><span class="n">dotext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addint</span><span class="p">(</span><span class="n">EOS</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">lastbf</span><span class="p">,</span><span class="w"> </span><span class="n">MAXBUF</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-22" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-22" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-22"></a><span class="mi">695</span><span class="p">:</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">addint</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">maxsiz</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NO</span><span class="p">)</span>
<a id="rest_code_7ea452909b7d49e096fe22958b0b1cec-23" name="rest_code_7ea452909b7d49e096fe22958b0b1cec-23" href="#rest_code_7ea452909b7d49e096fe22958b0b1cec-23"></a><span class="mi">713</span><span class="p">:</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">addint</span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">maxsiz</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NO</span><span class="p">)</span>
</pre></div>
<p>Some of the things they're adding to <code class="docutils literal">buf</code> are clearly integers
(<code class="docutils literal">nlines</code>, and probably <code class="docutils literal">NOTSTATE</code> and <code class="docutils literal">OKSTATE</code>), but those
<code class="docutils literal">EOS</code> are the SWTOOLS VOS equivalent of the C <code class="docutils literal">'\0'</code> that ends a
string, so those particular ones definitely hold characters.</p>
<p>Well, if I want to debug that I'm going to have to rebuild the SWTOOLS
VOS with debugging turned on.  Investigating it turns out that I need
to add <code class="docutils literal">/DEBUG</code> to the <span class="command">macro</span> and <span class="command">fortran</span>
commands in <span class="file">asmlib.com</span>, <span class="file">asmprm.com</span>, <span class="file">build.com</span>,
and <span class="file">compile.com</span> in <span class="file">~bin</span>, and then execute
<span class="file">~bin:toolgen.com</span>.</p>
<p>Once that is done I start stepping through various routines.
Eventually I figure out that it <code class="docutils literal">buf(19)</code> is the element that ends
up with the 173 hex, and set a watch on it.  And indeed it is getting
passed a 173.  Sigh.</p>
<p>Doing a <code class="docutils literal">SHOW STACK</code> in the <span class="app">VMS Debugger</span> shows that the
<code class="docutils literal">addint()</code> call that dies is in the subroutine <code class="docutils literal">compil()</code>.  Lets
take a look:</p>
<div class="code"><pre class="code text"><a id="rest_code_49478249ca594892b2d2ef5487665c04-1" name="rest_code_49478249ca594892b2d2ef5487665c04-1" href="#rest_code_49478249ca594892b2d2ef5487665c04-1"></a>DBG&gt; type compil\50:65
<a id="rest_code_49478249ca594892b2d2ef5487665c04-2" name="rest_code_49478249ca594892b2d2ef5487665c04-2" href="#rest_code_49478249ca594892b2d2ef5487665c04-2"></a>module COMPIL
<a id="rest_code_49478249ca594892b2d2ef5487665c04-3" name="rest_code_49478249ca594892b2d2ef5487665c04-3" href="#rest_code_49478249ca594892b2d2ef5487665c04-3"></a>    50:       STATUS = ADDINT(LINE2, BUF, LASTBF, 20000)
<a id="rest_code_49478249ca594892b2d2ef5487665c04-4" name="rest_code_49478249ca594892b2d2ef5487665c04-4" href="#rest_code_49478249ca594892b2d2ef5487665c04-4"></a>    51:       COM = CLOWER(LIN(I))
<a id="rest_code_49478249ca594892b2d2ef5487665c04-5" name="rest_code_49478249ca594892b2d2ef5487665c04-5" href="#rest_code_49478249ca594892b2d2ef5487665c04-5"></a>    52:       IF (.NOT.(COM .EQ. 33))GOTO 23068
<a id="rest_code_49478249ca594892b2d2ef5487665c04-6" name="rest_code_49478249ca594892b2d2ef5487665c04-6" href="#rest_code_49478249ca594892b2d2ef5487665c04-6"></a>    53:       STATUS = ADDINT(1, BUF, LASTBF, 20000)
<a id="rest_code_49478249ca594892b2d2ef5487665c04-7" name="rest_code_49478249ca594892b2d2ef5487665c04-7" href="#rest_code_49478249ca594892b2d2ef5487665c04-7"></a>    54:       I = I+1
<a id="rest_code_49478249ca594892b2d2ef5487665c04-8" name="rest_code_49478249ca594892b2d2ef5487665c04-8" href="#rest_code_49478249ca594892b2d2ef5487665c04-8"></a>    55:       CALL SKIPBL(LIN, I)
<a id="rest_code_49478249ca594892b2d2ef5487665c04-9" name="rest_code_49478249ca594892b2d2ef5487665c04-9" href="#rest_code_49478249ca594892b2d2ef5487665c04-9"></a>    56:       COM = CLOWER(LIN(I))
<a id="rest_code_49478249ca594892b2d2ef5487665c04-10" name="rest_code_49478249ca594892b2d2ef5487665c04-10" href="#rest_code_49478249ca594892b2d2ef5487665c04-10"></a>    57:       GOTO 23069
<a id="rest_code_49478249ca594892b2d2ef5487665c04-11" name="rest_code_49478249ca594892b2d2ef5487665c04-11" href="#rest_code_49478249ca594892b2d2ef5487665c04-11"></a>    58: 23068 CONTINUE
<a id="rest_code_49478249ca594892b2d2ef5487665c04-12" name="rest_code_49478249ca594892b2d2ef5487665c04-12" href="#rest_code_49478249ca594892b2d2ef5487665c04-12"></a>    59:       STATUS = ADDINT(0, BUF, LASTBF, 20000)
<a id="rest_code_49478249ca594892b2d2ef5487665c04-13" name="rest_code_49478249ca594892b2d2ef5487665c04-13" href="#rest_code_49478249ca594892b2d2ef5487665c04-13"></a>    60: 23069 CONTINUE
<a id="rest_code_49478249ca594892b2d2ef5487665c04-14" name="rest_code_49478249ca594892b2d2ef5487665c04-14" href="#rest_code_49478249ca594892b2d2ef5487665c04-14"></a>    61:       STATUS = ADDINT(COM, BUF, LASTBF, 20000)
<a id="rest_code_49478249ca594892b2d2ef5487665c04-15" name="rest_code_49478249ca594892b2d2ef5487665c04-15" href="#rest_code_49478249ca594892b2d2ef5487665c04-15"></a>    62:       IF (.NOT.(COM .EQ. 97 .AND. FD .NE. 0))GOTO 23070
<a id="rest_code_49478249ca594892b2d2ef5487665c04-16" name="rest_code_49478249ca594892b2d2ef5487665c04-16" href="#rest_code_49478249ca594892b2d2ef5487665c04-16"></a>    63:       STATUS = ADDINT(0, BUF, LASTBF, 20000)
<a id="rest_code_49478249ca594892b2d2ef5487665c04-17" name="rest_code_49478249ca594892b2d2ef5487665c04-17" href="#rest_code_49478249ca594892b2d2ef5487665c04-17"></a>    64:       STATUS = DOTEXT(FD)
<a id="rest_code_49478249ca594892b2d2ef5487665c04-18" name="rest_code_49478249ca594892b2d2ef5487665c04-18" href="#rest_code_49478249ca594892b2d2ef5487665c04-18"></a>    65:       GOTO 23071
<a id="rest_code_49478249ca594892b2d2ef5487665c04-19" name="rest_code_49478249ca594892b2d2ef5487665c04-19" href="#rest_code_49478249ca594892b2d2ef5487665c04-19"></a>DBG&gt;
</pre></div>
<p>Line 61 is the one that dies.  Here <code class="docutils literal">addint()</code> is being passed the
variable <code class="docutils literal">COM</code>.  Lets take a look at the <span class="app">Ratfor</span> source for
its definition:</p>
<div class="code"><pre class="code fortran"><a id="rest_code_8270926a77c94de08721a016647db2ec-1" name="rest_code_8270926a77c94de08721a016647db2ec-1" href="#rest_code_8270926a77c94de08721a016647db2ec-1"></a><span class="cp"># compil - "compile" command in lin(i) from file fd, increment i</span>
<a id="rest_code_8270926a77c94de08721a016647db2ec-2" name="rest_code_8270926a77c94de08721a016647db2ec-2" href="#rest_code_8270926a77c94de08721a016647db2ec-2"></a><span class="w">   </span><span class="k">subroutine </span><span class="n">compil</span><span class="p">(</span><span class="n">lin</span><span class="p">,</span><span class="w"> </span><span class="n">fd</span><span class="p">)</span>
<a id="rest_code_8270926a77c94de08721a016647db2ec-3" name="rest_code_8270926a77c94de08721a016647db2ec-3" href="#rest_code_8270926a77c94de08721a016647db2ec-3"></a><span class="w">   </span><span class="kt">character </span><span class="n">lin</span><span class="p">(</span><span class="n">MAXLINE</span><span class="p">),</span><span class="w"> </span><span class="n">com</span>
</pre></div>
<p>Oh, look, <code class="docutils literal">com</code> is a character, that gets translated by
<span class="app">Ratfor</span> to a <code class="docutils literal">LOGICAL*1</code>, and it is a byte, while the integers
that get passed in are longwords, which are 32 bytes long…  Uh,
doesn't Fortran pass everything by reference?  So <code class="docutils literal">addint()</code> gets
passed the address of a byte, but interprets it as the address of a
longword, so it picks up 3 extra bytes.  For whatever reason, there is
a 1 in the byte right next to the byte for <code class="docutils literal">com</code>, so we get (hex,
remember) 173 instead of 73, which is the ASCII for <code class="docutils literal">s</code>, which the s
in our <code class="docutils literal">sedit "s/H/J/"</code>!</p>
<p>Ok, that should be easy to fix: introduce an integer temporary
variable, assign <code class="docutils literal">com</code> to it, and pass it instead.</p>
<p>Here's the VMS diff:</p>
<pre class="literal-block">************
File DUA1:[SOFTWARE.SWTOOLS.TMP]SEDIT.R;6
  206      integer comint
  207      integer fd
******
File DUA1:[SOFTWARE.SWTOOLS.TMP]SEDIT.R;1
  206      integer fd
************
************
File DUA1:[SOFTWARE.SWTOOLS.TMP]SEDIT.R;6
  237      comint = com
  238      status = addint(comint, buf, lastbf, MAXBUF)
  239      if (com == APPENDCOM &amp; fd != NO) {
******
File DUA1:[SOFTWARE.SWTOOLS.TMP]SEDIT.R;1
  236      status = addint(com, buf, lastbf, MAXBUF)
  237      if (com == APPENDCOM &amp; fd != NO) {
************

Number of difference sections found: 2
Number of difference records found: 3

DIFFERENCES /IGNORE=()/MERGED=1/OUTPUT=DUA1:[SOFTWARE.SWTOOLS.TMP]SEDIT.DIFF;1-
    DUA1:[SOFTWARE.SWTOOLS.TMP]SEDIT.R;6-
    DUA1:[SOFTWARE.SWTOOLS.TMP]SEDIT.R;1</pre>
<p>Recompile, lets see:</p>
<div class="code"><pre class="code text"><a id="rest_code_2c25d94d9e8b4b908a1b6a68c742894e-1" name="rest_code_2c25d94d9e8b4b908a1b6a68c742894e-1" href="#rest_code_2c25d94d9e8b4b908a1b6a68c742894e-1"></a>% echo Hello | sedit "s/H/J/"
<a id="rest_code_2c25d94d9e8b4b908a1b6a68c742894e-2" name="rest_code_2c25d94d9e8b4b908a1b6a68c742894e-2" href="#rest_code_2c25d94d9e8b4b908a1b6a68c742894e-2"></a>Jello
<a id="rest_code_2c25d94d9e8b4b908a1b6a68c742894e-3" name="rest_code_2c25d94d9e8b4b908a1b6a68c742894e-3" href="#rest_code_2c25d94d9e8b4b908a1b6a68c742894e-3"></a>%
</pre></div>
<p>That did it!</p>
    </div>
    <script>var pfHeaderImgUrl = '';var pfHeaderTagline = '';var pfdisableClickToDel = 0;var pfHideImages = 0;var pfImageDisplayStyle = 'right';var pfDisablePDF = 0;var pfDisableEmail = 0;var pfDisablePrint = 0;var pfCustomCSS = '';var pfBtVersion='2';(function(){var js,pf;pf=document.createElement('script');pf.type='text/javascript';pf.src='//cdn.printfriendly.com/printfriendly.js';document.getElementsByTagName('head')[0].appendChild(pf)})();</script><a href="https://www.printfriendly.com" style="color:#6D9F00;text-decoration:none;" class="printfriendly" onclick="window.print();return false;" title="Printer Friendly and PDF"><img style="border:none;-webkit-box-shadow:none;box-shadow:none;" src="//cdn.printfriendly.com/buttons/printfriendly-pdf-button.png" alt="Print Friendly and PDF"></a>    
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../../categories/fortran/" rel="tag">fortran</a></li>
            <li><a class="tag p-category" href="../../../../../categories/lbl-tools/" rel="tag">lbl tools</a></li>
            <li><a class="tag p-category" href="../../../../../categories/ratfor/" rel="tag">ratfor</a></li>
            <li><a class="tag p-category" href="../../../../../categories/software-tools/" rel="tag">software tools</a></li>
            <li><a class="tag p-category" href="../../../../../categories/software-tools-virtual-operating-system/" rel="tag">software tools virtual operating system</a></li>
            <li><a class="tag p-category" href="../../../../../categories/swtools/" rel="tag">swtools</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../../03/how-the-lbl-software-tools-system-organized-its-source-files/" rel="prev" title="How the LBL Software Tools system organized its source files">Previous post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                    <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="lacking-natural-simplicity",
            disqus_url="https://tkurtbond.github.io/posts/2024/07/15/fixing-a-41-year-old-bug-in-the-swtools-vos-sedit-commmand/",
        disqus_title="Fixing a 41 year old bug in the SWTOOLS VOS SEDIT commmand",
        disqus_identifier="cache/posts/2024/07/15/fixing-a-41-year-old-bug-in-the-swtools-vos-sedit-commmand.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="lacking-natural-simplicity";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
            <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
                    <div class="sidebar-module sidebar-module-inset">
      <h4>About</h4>
      <p>Lacking Natural Simplicity is one, not particularly flattering, 
         definition of sophisticated.  
         This blog chronicles my journey through our at times too complicated 
         and sophisticated world. </p>
    </div>
    <div class="sidebar-module">
      <p>This site uses no cookies directly, but I expect the <a href="https://disqus.com/">Disqus</a> comments use cookies at disqus.com.</p>
      <h4>Links</h4>
      <ol class="list-unstyled">
<li><a href="../../../../../pages/about-the-blog/index.html">About the Blog</a></li>
        <li><a href="../../../../../pages/colophon/index.html">Colophon</a></li>
        <li><a href="../../../../../pages/typographical-conventions/index.html">Typographical Conventions</a></li>
        <li><a href="../../../../../pages/static-pages-index/index.html">Pages</a></li>
        <li>
<a href="http://tkb.tx0.org/">My tx0.org web page</a>
            <br>    Mostly empty
        </li>
        <li>
<a href="http://consp.org/">consp.org</a>
            <br>    Rises from the dead!
            <br>    <a href="http://consp.org/blog/blog.html">microblog</a>
        </li>
      </ol>
</div>
    
            </div>
        <!--End of body content-->
        </div>
    </div>
</div>

<footer class="blog-footer" id="footer">
    Contents © 2024         <a href="mailto:tkurtbond@gmail.com">T. Kurt Bond</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
    
</footer><script src="../../../../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
